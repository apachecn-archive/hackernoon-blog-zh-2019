<html>
<head>
<title>How to Create Cool Interactive Sankey Diagrams Using JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用JavaScript创建酷的交互式桑基图</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/create-javascript-sankey-diagram-b68c0d508a38?source=collection_archive---------3-----------------------#2019-05-15">https://medium.com/hackernoon/create-javascript-sankey-diagram-b68c0d508a38?source=collection_archive---------3-----------------------#2019-05-15</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="3e2d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">桑基图在数据可视化任务中越来越受欢迎。因此，对于前端web开发人员来说，知道如何创建这种类型的图表是至关重要的。实际上，这是一个非常简单明了的过程，尤其是如果您正在使用一个好的JavaScript图表库的话。</p><p id="12dd" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在我的教程中，我将向您展示如何毫不费力地创建漂亮、直观、交互式的JS (HTML5) Sankey图。</p><h1 id="9460" class="jp jq hu bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km dt translated">什么是桑基图</h1><p id="011a" class="pw-post-body-paragraph ir is hu it b iu kn iw ix iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo hn dt translated">让我们先快速弄清楚Sankey是什么，这样您就可以理解它的用途，然后我们再来看JavaScript图表本身。</p><p id="955b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">桑基图或桑基图是一种数据可视化类型，它按比例显示从一组值到另一组值的流量和数量。出于好奇，它是以出生于爱尔兰的船长兼工程师马修·桑基的名字命名的，他在19世纪末制作了一张图表，展示了蒸汽机的能源效率。</p><p id="cf78" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在散点图中，相互链接的事物被称为节点，它们用线或箭头连接。线条或箭头的宽度与从源到目标的流量成比例；即宽度越大，流量越大。</p><p id="0b25" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在流程的每个阶段，线条或箭头可以通过其路径连接或分离。您还可以添加颜色，将图表分成不同的类别，或者演示从流程的一种状态到另一种状态的转换。</p><p id="7c92" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">因此，Sankeys在显示系统中的主要转移或流方面是有用的，它可以帮助将支配性的贡献者指向整个过程。因此，这种类型的图表非常适合可视化两个域之间的多对多关系，或者系统中一组阶段的多条路径。</p><p id="d12e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">例如，Sankey图表可用于说明从源头到目的地的能量流动、货物从一个地点到另一个地点的转移以及其他不同的过程及其状态。</p><h1 id="4b67" class="jp jq hu bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km dt translated">如何构建一个简单的JavaScript桑基图</h1><p id="4f87" class="pw-post-body-paragraph ir is hu it b iu kn iw ix iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo hn dt translated">桑基图看起来很复杂，似乎很难创建。然而，网上有几个<a class="ae ks" href="https://en.wikipedia.org/wiki/Sankey_diagram#Sankey_diagram_drawing_tools" rel="noopener ugc nofollow" target="_blank">桑基图表库</a>可供你用来轻松绘制交互式桑基图表。</p><p id="7842" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">本质上，使用几乎所有支持这种图表类型的JavaScript数据可视化库来绘制Sankey图的步骤基本上是相同的。因此，在掌握了如何使用它们中的任何一个之后，您可以简单地将该过程推广到其他库，并构建其他一些不同寻常的东西。</p><p id="2489" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">对于这个Sankey图教程，我将使用<a class="ae ks" href="https://www.anychart.com/" rel="noopener ugc nofollow" target="_blank"> AnyChart </a> JavaScript图表库。AnyChart是轻量级的，通用的，易于使用的。特别是，我喜欢它广泛的<a class="ae ks" href="https://docs.anychart.com" rel="noopener ugc nofollow" target="_blank">文档</a>，它带有一个用于测试的<a class="ae ks" href="https://playground.anychart.com" rel="noopener ugc nofollow" target="_blank">代码平台</a>，广泛支持的图表类型，以及其他几个迷人的数据可视化特性。</p><p id="2195" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在，让我们动手看看如何使用AnyChart来绘制基于JavaScript的交互式Sankey图表。</p><p id="0f7c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">下面是要遵循的步骤。</p><h2 id="5909" class="kt jq hu bd jr ku kv kw jv kx ky kz jz jc la lb kd jg lc ld kh jk le lf kl lg dt translated">1.创建一个容器</h2><p id="dc22" class="pw-post-body-paragraph ir is hu it b iu kn iw ix iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo hn dt translated">让我们首先在HTML页面上创建一个引用Sankey图的容器。</p><pre class="lh li lj lk fq ll lm ln lo aw lp dt"><span id="9de6" class="kt jq hu lm b fv lq lr l ls lt">&lt;div id="container"&gt;&lt;/div&gt;</span></pre><h2 id="5382" class="kt jq hu bd jr ku kv kw jv kx ky kz jz jc la lb kd jg lc ld kh jk le lf kl lg dt translated">2.连接到JavaScript图表库</h2><p id="086b" class="pw-post-body-paragraph ir is hu it b iu kn iw ix iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo hn dt translated">连接到JS图表库有助于将其特性部署到我们的工作空间。我们可以通过下载相关的包并保存在本地或者使用内容交付网络(CDN)服务来连接到一个库。CDN通常是首选，因为它可以从离用户最近的数据中心部署库文件，从而提高内容的可用性和性能。</p><p id="d8ca" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">AnyChart利用了一种极简的、基于模块的技术，允许您只连接那些您在项目中需要的图表类型和特性，令人印象深刻地降低了您的应用程序中所需的JavaScript代码的大小。</p><p id="8852" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">为了创建桑基图，我们需要在页面的<strong class="it hv"> &lt; head &gt; </strong>部分添加以下核心和桑基图模块。</p><pre class="lh li lj lk fq ll lm ln lo aw lp dt"><span id="402b" class="kt jq hu lm b fv lq lr l ls lt">&lt;script src="https://cdn.anychart.com/releases/v8/js/anychart-core.min.js"&gt;&lt;/script&gt;<br/>&lt;script src="https://cdn.anychart.com/releases/v8/js/anychart-sankey.min.js"&gt;&lt;/script&gt;</span></pre><h2 id="f31b" class="kt jq hu bd jr ku kv kw jv kx ky kz jz jc la lb kd jg lc ld kh jk le lf kl lg dt translated">3.创建数据</h2><p id="7a92" class="pw-post-body-paragraph ir is hu it b iu kn iw ix iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo hn dt translated">现在，让我们创建将在Sankey图上显示的数据数组。AnyChart JS图表库需要定义以下数据字段:</p><ul class=""><li id="700c" class="lu lv hu it b iu iv iy iz jc lw jg lx jk ly jo lz ma mb mc dt translated"><strong class="it hv">来自</strong> —指定数据流的来源</li><li id="923f" class="lu lv hu it b iu md iy me jc mf jg mg jk mh jo lz ma mb mc dt translated"><strong class="it hv">到</strong> —指定数据流的目的地</li><li id="6836" class="lu lv hu it b iu md iy me jc mf jg mg jk mh jo lz ma mb mc dt translated"><strong class="it hv">权重</strong> —指定数据的值</li></ul><p id="adf0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在AnyChart中，数据行标识连接两个节点的数据流，其名称在<strong class="it hv"> from </strong>和<strong class="it hv"> to </strong>字段中定义。<strong class="it hv">权重</strong>值代表每个流的宽度；其中，宽度越大，流量越大。</p><p id="04e6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">自动排列成多列的节点具有与流入或流出流量的总量成比例的变化高度；也就是量越大，高度越高。</p><p id="f67e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">例如，这里是一些网站每天从两个流行的搜索引擎接收的网络流量的任意数据:</p><pre class="lh li lj lk fq ll lm ln lo aw lp dt"><span id="0ac9" class="kt jq hu lm b fv lq lr l ls lt">var data = [<br/> {from: "Google", to: "Facebook", weight: 20000},<br/> {from: "Google", to: "Twitter", weight: 17000},<br/> {from: "Google", to: "YouTube", weight: 8000},<br/> {from: "Google", to: "Wikipedia", weight: 11000},<br/> {from: "Bing", to: "Facebook", weight: 7500},<br/> {from: "Bing", to: "Twitter", weight: 5000},<br/> {from: "Bing", to: "Wikipedia", weight: 4000}<br/> ];</span></pre><h2 id="bdbb" class="kt jq hu bd jr ku kv kw jv kx ky kz jz jc la lb kd jg lc ld kh jk le lf kl lg dt translated">4.调用Sankey函数</h2><p id="4d2e" class="pw-post-body-paragraph ir is hu it b iu kn iw ix iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo hn dt translated">要绘制桑基图，我们需要调用<strong class="it hv"> anychart.sankey() </strong>图表构造函数，并将<strong class="it hv">数据</strong>参数传递给它，如下所示。</p><pre class="lh li lj lk fq ll lm ln lo aw lp dt"><span id="4476" class="kt jq hu lm b fv lq lr l ls lt">var sankey_chart = anychart.sankey(data);</span></pre><h2 id="9f50" class="kt jq hu bd jr ku kv kw jv kx ky kz jz jc la lb kd jg lc ld kh jk le lf kl lg dt translated">5.自定义节点</h2><p id="775f" class="pw-post-body-paragraph ir is hu it b iu kn iw ix iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo hn dt translated">现在让我们调用<strong class="it hv"> nodeWidth() </strong>方法来配置节点的宽度。节点的宽度可以设置为百分比或像素。</p><pre class="lh li lj lk fq ll lm ln lo aw lp dt"><span id="6e57" class="kt jq hu lm b fv lq lr l ls lt">sankey_chart.nodeWidth("20%");</span></pre><p id="3dea" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">此外，我们可以调用<strong class="it hv"> nodePadding() </strong>方法来设置节点之间的垂直填充。在这种情况下，我们为垂直填充提供了值20。</p><pre class="lh li lj lk fq ll lm ln lo aw lp dt"><span id="ad2b" class="kt jq hu lm b fv lq lr l ls lt">sankey_chart.nodePadding(20);</span></pre><h2 id="4e5c" class="kt jq hu bd jr ku kv kw jv kx ky kz jz jc la lb kd jg lc ld kh jk le lf kl lg dt translated">6.设置容器id并开始绘制JS图表</h2><p id="4e6f" class="pw-post-body-paragraph ir is hu it b iu kn iw ix iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo hn dt translated">让我们将Sankey图指向我们在HTML页面上创建的容器id，并开始绘制漂亮的图表。</p><pre class="lh li lj lk fq ll lm ln lo aw lp dt"><span id="a8ad" class="kt jq hu lm b fv lq lr l ls lt">sankey_chart.container("container");</span><span id="15a6" class="kt jq hu lm b fv mi lr l ls lt">sankey_chart.draw();</span></pre><p id="f3da" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">最后，我们将把整个代码包装在AnyChart的<strong class="it hv"> onDocumentReady </strong>()函数中，以确保在网页准备好显示内容时呈现图表。</p><p id="e86e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">以下是使用JavaScript创建简单Sankey图的完整代码:</p><pre class="lh li lj lk fq ll lm ln lo aw lp dt"><span id="df6e" class="kt jq hu lm b fv lq lr l ls lt">&lt;html&gt;<br/>&lt;head&gt;<br/>&lt;script src="https://cdn.anychart.com/releases/v8/js/anychart-core.min.js"&gt;&lt;/script&gt;<br/>&lt;script src="https://cdn.anychart.com/releases/v8/js/anychart-sankey.min.js"&gt;&lt;/script&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;</span><span id="e093" class="kt jq hu lm b fv mi lr l ls lt">&lt;div id="container"&gt;&lt;/div&gt;</span><span id="ba19" class="kt jq hu lm b fv mi lr l ls lt">&lt;script&gt;</span><span id="f0d9" class="kt jq hu lm b fv mi lr l ls lt">anychart.onDocumentReady(function(){<br/> //creating the data<br/> var data = [<br/> {from: "Google", to: "Facebook", weight: 20000},<br/> {from: "Google", to: "Twitter", weight: 17000},<br/> {from: "Google", to: "YouTube", weight: 8000},<br/> {from: "Google", to: "Wikipedia", weight: 11000},<br/> {from: "Bing", to: "Facebook", weight: 7500},<br/> {from: "Bing", to: "Twitter", weight: 5000},<br/> {from: "Bing", to: "Wikipedia", weight: 4000}<br/> ];</span><span id="62e7" class="kt jq hu lm b fv mi lr l ls lt">//calling the Sankey function<br/>var sankey_chart = anychart.sankey(data);</span><span id="d34f" class="kt jq hu lm b fv mi lr l ls lt">//customizing the width of the nodes<br/>sankey_chart.nodeWidth("20%");</span><span id="6323" class="kt jq hu lm b fv mi lr l ls lt">//setting the chart title<br/>sankey_chart.title("Simple Sankey Diagram Example");</span><span id="ee30" class="kt jq hu lm b fv mi lr l ls lt">//customizing the vertical padding of the nodes<br/>sankey_chart.nodePadding(20);</span><span id="9300" class="kt jq hu lm b fv mi lr l ls lt">//setting the container id<br/>sankey_chart.container("container");</span><span id="9168" class="kt jq hu lm b fv mi lr l ls lt">//initiating drawing the Sankey diagram<br/>sankey_chart.draw();</span><span id="3750" class="kt jq hu lm b fv mi lr l ls lt">});</span><span id="dc06" class="kt jq hu lm b fv mi lr l ls lt">&lt;/script&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="0766" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">下面是图表在浏览器上的外观:</p><figure class="lh li lj lk fq mk fe ff paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="fe ff mj"><img src="../Images/9b23b3de40ccad610f78f34d4a97d3c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*iRd1XSamYGZszCA9"/></div></div></figure><p id="9d39" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">正如你在上面的图片中看到的，默认情况下，这个Sankey图表是交互式的。</p><p id="e968" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">它的一些默认交互行为包括显示权重值的工具提示，当鼠标悬停在流上时高亮显示流，以及用不同的颜色显示节点。</p><h1 id="1113" class="jp jq hu bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km dt translated">如何在视觉上增强JS Sankey图表</h1><p id="972b" class="pw-post-body-paragraph ir is hu it b iu kn iw ix iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo hn dt translated">既然我们已经知道如何使用AnyChart JS库来绘制简单的Sankey图，那么我们就来谈谈如何增强它们在表示数据可视化任务方面的能力。</p><p id="ce72" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">例如，您可以通过自定义图表的外观、添加衰减和创建多级图表来改进图表。</p><p id="8545" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">下面就来分别说一下。</p><h2 id="1f51" class="kt jq hu bd jr ku kv kw jv kx ky kz jz jc la lb kd jg lc ld kh jk le lf kl lg dt translated">a.定制外观</h2><p id="9e20" class="pw-post-body-paragraph ir is hu it b iu kn iw ix iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo hn dt translated"><a class="ae ks" href="https://docs.anychart.com/Basic_Charts/Sankey_Diagram" rel="noopener ugc nofollow" target="_blank"> AnyChart三键图</a>可定制以改善其外观。例如，节点和流的可视外观可以配置为根据它们的正常和悬停状态显示不同的颜色。</p><p id="5e6f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">为此，<strong class="it hv">正常()</strong>方法和<strong class="it hv">悬停()</strong>方法可以与<strong class="it hv">填充()</strong>方法(用于设置填充)和<strong class="it hv">描边()</strong>方法(用于设置描边)一起使用。</p><p id="341a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">以下是配置图表视觉外观的代码:</p><pre class="lh li lj lk fq ll lm ln lo aw lp dt"><span id="9c24" class="kt jq hu lm b fv lq lr l ls lt">&lt;html&gt;<br/>&lt;head&gt;<br/>&lt;script src="https://cdn.anychart.com/releases/v8/js/anychart-core.min.js"&gt;&lt;/script&gt;</span><span id="94fa" class="kt jq hu lm b fv mi lr l ls lt">&lt;script src="https://cdn.anychart.com/releases/v8/js/anychart-sankey.min.js"&gt;&lt;/script&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;</span><span id="38b4" class="kt jq hu lm b fv mi lr l ls lt">&lt;div id="container"&gt;&lt;/div&gt;</span><span id="12e9" class="kt jq hu lm b fv mi lr l ls lt">&lt;script&gt;</span><span id="c617" class="kt jq hu lm b fv mi lr l ls lt">anychart.onDocumentReady(function(){<br/> //creating the data<br/> var data = [<br/> {from: "Google", to: "Facebook", weight: 20000},<br/> {from: "Google", to: "Twitter", weight: 17000},<br/> {from: "Google", to: "YouTube", weight: 8000},<br/> {from: "Google", to: "Wikipedia", weight: 11000},<br/> {from: "Bing", to: "Facebook", weight: 7500},<br/> {from: "Bing", to: "Twitter", weight: 5000},<br/> {from: "Bing", to: "Wikipedia", weight: 4000}<br/> ];</span><span id="9f80" class="kt jq hu lm b fv mi lr l ls lt">//calling the Sankey function<br/>var sankey_chart = anychart.sankey(data);</span><span id="a1b0" class="kt jq hu lm b fv mi lr l ls lt">//customizing the width of the nodes<br/>sankey_chart.nodeWidth("20%");</span><span id="1e1e" class="kt jq hu lm b fv mi lr l ls lt">//setting the chart title<br/>sankey_chart.title("Sankey Diagram Customization Example");</span><span id="b469" class="kt jq hu lm b fv mi lr l ls lt">//customizing the vertical padding of the nodes<br/>sankey_chart.nodePadding(20);</span><span id="b5d4" class="kt jq hu lm b fv mi lr l ls lt">//customizing the visual appearance of nodes<br/>sankey_chart.node().normal().fill("#64b5f5 0.6");<br/>sankey_chart.node().hovered().fill(anychart.color.darken("#64b5f7"));<br/>sankey_chart.node().normal().stroke("#455a63", 2);</span><span id="23e2" class="kt jq hu lm b fv mi lr l ls lt">//customizing the visual appearance of flows<br/>sankey_chart.flow().normal().fill("#ffa000 0.5");<br/>sankey_chart.flow().hovered().fill(anychart.color.darken("#ffa000"));<br/>sankey_chart.flow().hovered().stroke("#455a63");</span><span id="11d8" class="kt jq hu lm b fv mi lr l ls lt">//setting the container id<br/>sankey_chart.container("container");</span><span id="f7c2" class="kt jq hu lm b fv mi lr l ls lt">//initiating drawing the Sankey diagram<br/>sankey_chart.draw();</span><span id="8d7c" class="kt jq hu lm b fv mi lr l ls lt">});</span><span id="8794" class="kt jq hu lm b fv mi lr l ls lt">&lt;/script&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="b585" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">以下是配置的图表在浏览器上的外观:</p><figure class="lh li lj lk fq mk fe ff paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="fe ff mr"><img src="../Images/9d19107cd51fa305e62ad3850cfb50a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*BqH3oRJNuclpysvH"/></div></div></figure><h2 id="ffc6" class="kt jq hu bd jr ku kv kw jv kx ky kz jz jc la lb kd jg lc ld kh jk le lf kl lg dt translated">b.添加衰减</h2><p id="4337" class="pw-post-body-paragraph ir is hu it b iu kn iw ix iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo hn dt translated">每当缺少流动的目的地时，就形成了衰减。因为没有提供目标节点，所以dropoff通常显示损失。因此，要设置一个删除，需要在<strong class="it hv">到</strong>字段中包含一个值为<strong class="it hv"> null </strong>的数据行。您还需要在字段的<strong class="it hv">中设置数据流源的名称，并在<strong class="it hv">权重</strong>字段中设置dropoff的值。</strong></p><p id="687b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您还可以自定义衰减以适合您的偏好，例如配置其视觉外观。</p><p id="7655" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">以下是用于添加衰减的代码，这些代码显示了太阳能在到达建筑物内部之前的传输过程:</p><pre class="lh li lj lk fq ll lm ln lo aw lp dt"><span id="a73c" class="kt jq hu lm b fv lq lr l ls lt">&lt;html&gt;<br/>&lt;head&gt;<br/>&lt;script src="https://cdn.anychart.com/releases/v8/js/anychart-core.min.js"&gt;&lt;/script&gt;</span><span id="e738" class="kt jq hu lm b fv mi lr l ls lt">&lt;script src="https://cdn.anychart.com/releases/v8/js/anychart-sankey.min.js"&gt;&lt;/script&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;</span><span id="1344" class="kt jq hu lm b fv mi lr l ls lt">&lt;div id="container"&gt;&lt;/div&gt;</span><span id="8677" class="kt jq hu lm b fv mi lr l ls lt">&lt;script&gt;</span><span id="dac1" class="kt jq hu lm b fv mi lr l ls lt">anychart.onDocumentReady(function(){<br/> //creating the data<br/>var data = [<br/> {from: "Solar Light", to: "Shade", weight: 110},<br/> {from: "Shade", to: null, weight: 60},<br/> {from: "Shade", to: "Facade", weight: 40},<br/> {from: "Facade", to: null, weight: 30},<br/> {from: "Facade", to: "Interior Lighting", weight: 20}<br/>];</span><span id="4925" class="kt jq hu lm b fv mi lr l ls lt">//calling the Sankey function<br/>var sankey_chart = anychart.sankey(data);</span><span id="661d" class="kt jq hu lm b fv mi lr l ls lt">//customizing the width of the nodes<br/>sankey_chart.nodeWidth("50%");</span><span id="0d94" class="kt jq hu lm b fv mi lr l ls lt">//setting the chart title<br/>sankey_chart.title("Sankey Diagram Dropoff Example");</span><span id="c8ea" class="kt jq hu lm b fv mi lr l ls lt">//customizing the vertical padding of the nodes<br/>sankey_chart.nodePadding(20);</span><span id="019f" class="kt jq hu lm b fv mi lr l ls lt">//customizing the visual appearance of dropoff<br/>sankey_chart.dropoff().normal().fill(<br/> {keys: ["#dd2c01 0.5", "#455a62 0.9"], angle: 275}<br/>);<br/>sankey_chart.dropoff().hovered().stroke("#455a61");</span><span id="780f" class="kt jq hu lm b fv mi lr l ls lt">//setting the container id<br/>sankey_chart.container("container");</span><span id="c96d" class="kt jq hu lm b fv mi lr l ls lt">//initiating drawing the Sankey diagram<br/>sankey_chart.draw();</span><span id="db5e" class="kt jq hu lm b fv mi lr l ls lt">});</span><span id="63ce" class="kt jq hu lm b fv mi lr l ls lt">&lt;/script&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="e777" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这是拖放在浏览器上的样子:</p><figure class="lh li lj lk fq mk fe ff paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="fe ff ms"><img src="../Images/79fdccd8beaca4aff329306894190b0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*l6vdVAxG6Wo0G5_F"/></div></div></figure><h2 id="4986" class="kt jq hu bd jr ku kv kw jv kx ky kz jz jc la lb kd jg lc ld kh jk le lf kl lg dt translated">c.创建多级桑基图表</h2><p id="3675" class="pw-post-body-paragraph ir is hu it b iu kn iw ix iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo hn dt translated">此外，您可以使用AnyChart JS库来创建具有多层次链接的Sankey图。</p><p id="c00e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在下面的例子中，我创建了一个桑基图，显示了每年从一个国家迁移到另一个国家的任意数量的人。节点排列在三列中，并根据需要自动添加其他级别。</p><p id="eeac" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">代码如下:</p><pre class="lh li lj lk fq ll lm ln lo aw lp dt"><span id="16fa" class="kt jq hu lm b fv lq lr l ls lt">&lt;html&gt;<br/>&lt;head&gt;<br/>&lt;script src="https://cdn.anychart.com/releases/v8/js/anychart-core.min.js"&gt;&lt;/script&gt;</span><span id="1d31" class="kt jq hu lm b fv mi lr l ls lt">&lt;script src="https://cdn.anychart.com/releases/v8/js/anychart-sankey.min.js"&gt;&lt;/script&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;</span><span id="5f7e" class="kt jq hu lm b fv mi lr l ls lt">&lt;div id="container"&gt;&lt;/div&gt; </span><span id="a373" class="kt jq hu lm b fv mi lr l ls lt">&lt;script&gt;</span><span id="0370" class="kt jq hu lm b fv mi lr l ls lt">anychart.onDocumentReady(function(){<br/> //creating the data<br/>var data = [<br/> {from: "France", to: "Canada", weight: 3000},<br/> {from: "France", to: "Germany", weight: 2000},<br/> {from: "France", to: "South Africa", weight: 1100},<br/> {from: "France", to: "Portugal", weight: 900},<br/> {from: "US", to: "China", weight: 2200},<br/> {from: "US", to: "Canada", weight: 400},<br/> {from: "US", to: "Germany", weight: 700},<br/> {from: "US", to: "Portugal", weight: 200},<br/> {from: "Canada", to: "China", weight: 1500},<br/> {from: "Canada", to: "Japan", weight: 3300},<br/> {from: "Canada", to: "England", weight: 550},<br/> {from: "Germany", to: "China", weight: 1100},<br/> {from: "Germany", to: "Japan", weight: 750},<br/> {from: "Germany", to: "England", weight: 400},<br/> {from: "South Africa", to: "China", weight: 3100},<br/> {from: "Portugal", to: "China", weight: 2100},<br/> {from: "Portugal", to: "Japan", weight: 1600}<br/>];</span><span id="8186" class="kt jq hu lm b fv mi lr l ls lt">//calling the Sankey function<br/>var sankey_chart = anychart.sankey(data);</span><span id="2c83" class="kt jq hu lm b fv mi lr l ls lt">//customizing the width of the nodes<br/>sankey_chart.nodeWidth("50%");</span><span id="0bf6" class="kt jq hu lm b fv mi lr l ls lt">//setting the chart title<br/>sankey_chart.title("Sankey Multilevel Chart Example");</span><span id="aaa1" class="kt jq hu lm b fv mi lr l ls lt">//customizing the vertical padding of the nodes<br/>sankey_chart.nodePadding(20);</span><span id="1af0" class="kt jq hu lm b fv mi lr l ls lt">//setting the container id<br/>sankey_chart.container("container");</span><span id="c2a5" class="kt jq hu lm b fv mi lr l ls lt">//initiating drawing the Sankey diagram<br/>sankey_chart.draw();</span><span id="4522" class="kt jq hu lm b fv mi lr l ls lt">});</span><span id="b20f" class="kt jq hu lm b fv mi lr l ls lt">&lt;/script&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="47b7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">以下是多级桑基图表在浏览器上的外观:</p><figure class="lh li lj lk fq mk fe ff paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="fe ff mj"><img src="../Images/b9dfdd5fd06bf1a5133699e9cc2f6955.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*C--FzIOEHIOQjxuS"/></div></div></figure><h1 id="4d01" class="jp jq hu bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km dt translated">包扎</h1><p id="3def" class="pw-post-body-paragraph ir is hu it b iu kn iw ix iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo hn dt translated">正如您在这篇JS图表教程中所看到的，使用一个好的数据可视化库创建直观的交互式Sankey图并不是什么难事。通过一个开发人员友好的解决方案，您可以创建精彩的图表，并将您的数据可视化工作提升到一个新的水平。</p><p id="060d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当然，我们只是触及了桑基图的表面。您可以访问AnyChart文档，了解如何充分利用Sankey图表，以及其他几种类型的图表。</p><p id="d452" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您还可以尝试一下<a class="ae ks" href="https://en.wikipedia.org/wiki/Comparison_of_JavaScript_charting_libraries" rel="noopener ugc nofollow" target="_blank">其他JavaScript图表库</a>，并评估它们在帮助您将所需的可视化添加到web应用程序中的能力。</p><p id="cc50" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">你有什么意见或问题吗？</p><p id="acdd" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">请把它们贴在下面。</p></div></div>    
</body>
</html>