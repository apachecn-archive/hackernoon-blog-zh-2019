<html>
<head>
<title>EthVM: First Open-Source Block Explorer Powered by Kafka</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">EthVM:由Kafka支持的第一个开源块浏览器</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/ethvm-first-open-source-block-explorer-powered-by-kafka-e1639fc93e8e?source=collection_archive---------3-----------------------#2019-04-20">https://medium.com/hackernoon/ethvm-first-open-source-block-explorer-powered-by-kafka-e1639fc93e8e?source=collection_archive---------3-----------------------#2019-04-20</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="d79c" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">实现Apache Kafka生态系统以处理以太坊区块链数据</h2></div><p id="6862" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">自比特币将加密货币引入世界以来的十年里，该行业的发展方式可能连Satoshi都无法想象。2015年7月出现的以太坊区块链，由于以太坊虚拟机(EVM)——一个开发和执行智能合同的环境，打开了一个新的可能性世界。</p><p id="eca7" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">EVM使得以太坊网络不仅仅是一个货币交易历史的存储库——它是一个邀请探索、互动和合作创新的生态系统。</p><p id="8faf" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">延续了MEW (MyEtherWallet)开源产品的传统，使用户和开发人员能够探索区块链的可能性，我们引入了EthVM:第一个基于Apache Kafka的以太坊开源块浏览器和数据处理引擎。</p><h1 id="3a60" class="kf kg hu bd kh ki kj kk kl km kn ko kp ja kq jb kr jd ks je kt jg ku jh kv kw dt translated">EthVM的起源:一个导航EVM的指南针</h1><p id="4e09" class="pw-post-body-paragraph jj jk hu jl b jm kx iv jo jp ky iy jr js kz ju jv jw la jy jz ka lb kc kd ke hn dt translated">块浏览器是一个不可或缺的工具，区块链审计和决策，使用方便的浏览器格式。探索者帮助用户验证交易和智能合同的执行情况，检查余额，并监控天然气价格。</p><p id="f363" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">对于开发人员来说，块探索者揭示了为dapps和开源钱包检索区块链数据的新可能性，激发了整个不断增长的以太坊生态系统的创新，同时提供了在去中心化网络中至关重要的透明度。</p><p id="2fd9" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">当我们的团队首次开始开发EthVM Alpha时，最初的想法是创建一个易于使用的区块链浏览器，其特点是前端由<a class="ae lc" href="https://vuejs.org/" rel="noopener ugc nofollow" target="_blank"> VueJS </a>构建，后端由<a class="ae lc" href="https://www.rethinkdb.com/" rel="noopener ugc nofollow" target="_blank"> RethinkDB </a>提供实时更新。</p><p id="159b" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">作为一名开发者，你真的只需要三个基本的东西来构建一个浏览器，这就是我们开始做的:</p><ol class=""><li id="61e5" class="ld le hu jl b jm jn jp jq js lf jw lg ka lh ke li lj lk ll dt translated">与网络同步的以太坊节点</li><li id="7bef" class="ld le hu jl b jm lm jp ln js lo jw lp ka lq ke li lj lk ll dt translated">存储信息的数据库</li><li id="2d7a" class="ld le hu jl b jm lm jp ln js lo jw lp ka lq ke li lj lk ll dt translated">一个展示这些信息的网站</li></ol><p id="93fa" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">然而，这些并不是需要考虑的唯一因素。通常，当区块链增长到一定规模时，您需要处理的信息量是巨大的。不仅如此，运行完全同步的节点可能是一个复杂的过程。这可能需要大量的时间和资源，并对CPU和磁盘提出相当高的要求。</p><h1 id="a1d9" class="kf kg hu bd kh ki kj kk kl km kn ko kp ja kq jb kr jd ks je kt jg ku jh kv kw dt translated"><strong class="ak">满足对开源以太坊资源管理器的需求</strong></h1><p id="8a63" class="pw-post-body-paragraph jj jk hu jl b jm kx iv jo jp ky iy jr js kz ju jv jw la jy jz ka lb kc kd ke hn dt translated">在我们努力应对这些挑战时，我们的团队意识到，不仅现有的block explorer选项有限，而且它们大多是闭源的，这意味着只有一小部分开发人员可以为这一重要工具的创新做出贡献。</p><p id="665c" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们发现，该领域的其他人正在通过一项由<a class="ae lc" href="https://giveth.io/" rel="noopener ugc nofollow" target="_blank"> Giveth.io </a>的创始人<a class="ae lc" href="https://twitter.com/thegrifft" rel="noopener ugc nofollow" target="_blank">格里夫·格林</a>发起的精彩倡议来解决这个问题。他2018年4月在<a class="ae lc" href="https://ethresear.ch/" rel="noopener ugc nofollow" target="_blank"> Ethresearch </a>上的帖子——一个允许你参与以太坊研究工作的社区——强调了开源方法对阻止探索者的重要性。它与我们自己的愿景产生了共鸣，并加强了我们的信念，即以太坊生态系统需要一个直观的开源浏览器，可以在世界各地许多人的帮助下发展。</p><h1 id="a90b" class="kf kg hu bd kh ki kj kk kl km kn ko kp ja kq jb kr jd ks je kt jg ku jh kv kw dt translated"><strong class="ak">意外的灵感</strong></h1><p id="5640" class="pw-post-body-paragraph jj jk hu jl b jm kx iv jo jp ky iy jr js kz ju jv jw la jy jz ka lb kc kd ke hn dt translated">在技术进步的协作本质的另一个证明中，EthVM最重要特性的灵感来自一个意想不到的来源。由<a class="ae lc" href="https://twitter.com/bsvingen?lang=en" rel="noopener ugc nofollow" target="_blank"> Boerge Svingen </a>在Confluent博客上写的一篇名为“<a class="ae lc" href="https://www.confluent.io/blog/publishing-apache-kafka-new-york-times/" rel="noopener ugc nofollow" target="_blank"> <em class="lr">与Apache Kafka一起在纽约时报</em> </a>出版”的帖子，描述了标志性的纽约时报如何从一堆API、服务、生产者和消费者过渡到由Apache Kafka驱动的基于日志的架构。</p><p id="9b72" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">要突出显示某个段落:</p><blockquote class="ls lt lu"><p id="3902" class="jj jk lr jl b jm jn iv jo jp jq iy jr lv jt ju jv lw jx jy jz lx kb kc kd ke hn dt translated">传统上，数据库被用作许多系统的真实来源。尽管有很多明显的好处，但从长远来看，数据库可能很难管理。</p><p id="ef06" class="jj jk lr jl b jm jn iv jo jp jq iy jr lv jt ju jv lw jx jy jz lx kb kc kd ke hn dt translated">…基于日志的体系结构通过将日志作为事实的来源来解决这个问题。数据库通常存储某个事件的结果，而日志存储事件本身，因此日志成为系统中发生的所有事件的有序表示。使用此日志，您可以创建任意数量的自定义数据存储。这些存储成为日志的物化视图—它们包含派生的内容，而不是原始的内容。如果您想要更改这种数据存储中的模式，您可以创建一个新的模式，让它从头开始使用日志，直到它跟上，然后丢弃旧的模式。</p></blockquote><p id="d074" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">区块链本质上是一个不断增长的记录列表，合并成使用加密技术链接的块——用程序员的术语来说就是一个<a class="ae lc" href="https://en.wikipedia.org/wiki/Linked_list" rel="noopener ugc nofollow" target="_blank">链表</a>。在Kafka术语中，以太坊客户端将是我们的<a class="ae lc" href="https://docs.confluent.io/current/clients/producer.html" rel="noopener ugc nofollow" target="_blank">生产者</a>——负责创建我们的‘日志’的新条目。</p><p id="f585" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">Boerge以上解释的含义是巨大的:</p><ul class=""><li id="69ac" class="ld le hu jl b jm jn jp jq js lf jw lg ka lh ke ly lj lk ll dt translated">如果架构是基于日志的，您可以使用和处理Kafka日志，并将信息输出到其他地方——例如，数据库或PDF报告。</li><li id="2216" class="ld le hu jl b jm lm jp ln js lo jw lp ka lq ke ly lj lk ll dt translated">另外，根据主题的建模和配置方式，您可以多次重放日志。这意味着您可以随时“回到过去”并重新处理数据。</li></ul><h1 id="4f27" class="kf kg hu bd kh ki kj kk kl km kn ko kp ja kq jb kr jd ks je kt jg ku jh kv kw dt translated"><strong class="ak"> EthVM和卡夫卡生态系统</strong></h1><figure class="ma mb mc md fq me fe ff paragraph-image"><div class="fe ff lz"><img src="../Images/0a5fae6a15689a8f5f06154bd37601ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*8KTD5FXpIiZPx_CVdamg7A.jpeg"/></div></figure><p id="86b9" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">那么，这在EthVM中是如何应用的呢？通过完全拥抱完整的Apache Kafka生态系统，由以下工具组成:<a class="ae lc" href="https://docs.confluent.io/current/connect/index.html" rel="noopener ugc nofollow" target="_blank"><strong class="jl hv">【Kafka Connect】</strong></a><strong class="jl hv"/><a class="ae lc" href="https://kafka.apache.org/documentation/streams/" rel="noopener ugc nofollow" target="_blank"><strong class="jl hv">Kafka Streams</strong></a><strong class="jl hv"/>和<strong class="jl hv"/><a class="ae lc" href="https://docs.confluent.io/current/schema-registry/index.html" rel="noopener ugc nofollow" target="_blank"><strong class="jl hv">Kafka Schema Registry</strong></a><strong class="jl hv">。</strong></p><p id="0b13" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">让我们看看如何在EthVM环境中使用这些工具:</p><h2 id="5d9e" class="mh kg hu bd kh mi mj mk kl ml mm mn kp js mo mp kr jw mq mr kt ka ms mt kv mu dt translated"><strong class="ak">卡夫卡连接</strong></h2><p id="ce30" class="pw-post-body-paragraph jj jk hu jl b jm kx iv jo jp ky iy jr js kz ju jv jw la jy jz ka lb kc kd ke hn dt translated">官方项目将<a class="ae lc" href="https://docs.confluent.io/current/connect/index.html" rel="noopener ugc nofollow" target="_blank"> Kafka Connect </a>描述为:</p><blockquote class="ls lt lu"><p id="9dc0" class="jj jk lr jl b jm jn iv jo jp jq iy jr lv jt ju jv lw jx jy jz lx kb kc kd ke hn dt translated">…一个用于在Apache Kafka和其他系统之间可扩展且可靠地传输数据的工具。它使得快速定义将大量数据移入和移出Kafka的连接器变得简单。Kafka Connect可以接收整个数据库或从所有应用服务器收集指标到Kafka主题中，使数据可用于低延迟的流处理。导出作业可以将Kafka主题中的数据传送到二级存储和查询系统中，或者传送到批处理系统中进行离线分析。</p></blockquote><figure class="ma mb mc md fq me fe ff paragraph-image"><div class="fe ff lz"><img src="../Images/eeec19b8b8f0c07179032edf5010368b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*2wfUVGBYRX3189c5ALbYTw.png"/></div><figcaption class="mv mw fg fe ff mx my bd b be z ek">This is how we capture a block (simplified for the purposes of this article)</figcaption></figure><p id="71e5" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">对于EthVM，我们创建了一个<em class="lr"> ParitySource </em>连接器，它允许我们从一个<em class="lr">RPC</em>/<em class="lr">web socket</em>端点读取所有需要的信息，并将数据转储到特定的主题。</p><p id="dc0f" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">有了Kafka Connect，我们有了一套标准化的API来将数据接收到Kafka。这种方法的美妙之处在于，未来我们将能够创建更多基于相同原理的连接器(以支持Geth和其他客户端)。</p><h2 id="e8bd" class="mh kg hu bd kh mi mj mk kl ml mm mn kp js mo mp kr jw mq mr kt ka ms mt kv mu dt translated"><strong class="ak">卡夫卡溪流</strong></h2><p id="3cf2" class="pw-post-body-paragraph jj jk hu jl b jm kx iv jo jp ky iy jr js kz ju jv jw la jy jz ka lb kc kd ke hn dt translated">一旦重要数据出现在Kafka主题中，第二步是解释数据以获得有意义的信息。这就是<a class="ae lc" href="https://kafka.apache.org/documentation/streams/" rel="noopener ugc nofollow" target="_blank">卡夫卡溪流</a>的用武之地:</p><blockquote class="ls lt lu"><p id="105e" class="jj jk lr jl b jm jn iv jo jp jq iy jr lv jt ju jv lw jx jy jz lx kb kc kd ke hn dt translated">Kafka Streams是一个用于构建应用程序和微服务的客户端库，其中的输入和输出数据存储在Kafka集群中。它结合了在客户端编写和部署标准Java和Scala应用程序的简单性和Kafka服务器端集群技术的优势。</p></blockquote><p id="af47" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在EthVM上，我们创建了专门的“处理器”,利用Kafka Streams实用程序来执行聚合、归约、过滤和其他有用的操作。</p><p id="0867" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">例如，一个专用处理器分析并提取可替换的令牌传输，如ETH或ERC20。另一个专门研究不可替代的，像ERC721上的那些。其他处理器关注有用的区块指标，包括与平均油价、成功或失败交易数量以及交易费用相关的信息。事实上，我们可以根据需要创建任意多的处理器来“挂钩”具体主题，以接收最相关的数据。</p><p id="55a5" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们正在使用Kafka Connect创建一个接收器，用于存储处理器输出的数据。目前，我们正在转向<a class="ae lc" href="https://www.postgresql.org/" rel="noopener ugc nofollow" target="_blank"> Postgres </a> / <a class="ae lc" href="https://www.timescale.com/" rel="noopener ugc nofollow" target="_blank">时标</a>，但我们最初是从<a class="ae lc" href="https://docs.mongodb.com/" rel="noopener ugc nofollow" target="_blank"> MongoDB </a>开始的。</p><h2 id="2362" class="mh kg hu bd kh mi mj mk kl ml mm mn kp js mo mp kr jw mq mr kt ka ms mt kv mu dt translated"><strong class="ak"> Kafka模式注册表</strong></h2><p id="2115" class="pw-post-body-paragraph jj jk hu jl b jm kx iv jo jp ky iy jr js kz ju jv jw la jy jz ka lb kc kd ke hn dt translated">那么<a class="ae lc" href="https://docs.confluent.io/current/schema-registry/index.html" rel="noopener ugc nofollow" target="_blank">模式注册中心</a>呢？</p><blockquote class="ls lt lu"><p id="08df" class="jj jk lr jl b jm jn iv jo jp jq iy jr lv jt ju jv lw jx jy jz lx kb kc kd ke hn dt translated">Schema Registry为您的元数据提供了一个服务层。它为存储和检索Avro模式提供了一个RESTful接口。它存储所有模式的版本化历史，提供多种兼容性设置，并允许根据配置的兼容性设置和扩展的Avro支持来演进模式。</p></blockquote><p id="07cd" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">基本上，它是一个存储Avro模式的地方。但是什么是<a class="ae lc" href="https://avro.apache.org/docs/current/" rel="noopener ugc nofollow" target="_blank"> Avro </a>？</p><blockquote class="ls lt lu"><p id="09ce" class="jj jk lr jl b jm jn iv jo jp jq iy jr lv jt ju jv lw jx jy jz lx kb kc kd ke hn dt translated">Avro是在Apache的Hadoop项目中开发的远程过程调用和数据序列化框架。它使用JSON来定义数据类型和协议，并以紧凑的二进制格式序列化数据。</p></blockquote><p id="550d" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">Avro是阿帕奇卡夫卡生态系统中的一等公民。我们已经在EthVM中使用它来创建自定义实体，这些实体不知道以太坊的任何具体实现。作为一个额外的好处，它的格式非常紧凑，允许我们节省磁盘空间。</p><h1 id="3915" class="kf kg hu bd kh ki kj kk kl km kn ko kp ja kq jb kr jd ks je kt jg ku jh kv kw dt translated"><strong class="ak">帮助我们塑造EthVM的未来</strong></h1><p id="7eda" class="pw-post-body-paragraph jj jk hu jl b jm kx iv jo jp ky iy jr js kz ju jv jw la jy jz ka lb kc kd ke hn dt translated">我们很高兴地分享，生态系统的Alpha版本目前正在<a class="ae lc" href="https://ropsten.ethvm.com/" rel="noopener ugc nofollow" target="_blank">上线</a>——初始处理器设置，使用Mongo作为主存储数据库。展望Beta版，我们希望使EthVM更加稳定，并实现一些功能，包括:</p><ul class=""><li id="8ec2" class="ld le hu jl b jm jn jp jq js lf jw lg ka lh ke ly lj lk ll dt translated">迁移到NestJS API</li><li id="2e85" class="ld le hu jl b jm lm jp ln js lo jw lp ka lq ke ly lj lk ll dt translated">从MongoDB迁移到Postgres /时标</li><li id="00d7" class="ld le hu jl b jm lm jp ln js lo jw lp ka lq ke ly lj lk ll dt translated">改进了Kafka上的处理(挤压bug并提高速度)</li><li id="849e" class="ld le hu jl b jm lm jp ln js lo jw lp ka lq ke ly lj lk ll dt translated">带一个Terraform提供者来正确地在AWS上部署代码</li></ul><p id="f8fe" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我们的首要目标是尽可能快地同时处理以太坊链，最终增加更多的链。有了一个好的Kafka集群，我们将能够同时处理多个链。此外，块浏览器只是查看区块链数据的众多方式之一<a class="ae lc" href="https://github.com/EthVM/ethvm/wiki/Inspecting-Kafka" rel="noopener ugc nofollow" target="_blank">！</a></p><p id="7748" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">EthVM由MyEtherWallet提供支持，这是一家致力于生产开源项目的公司，这些项目将使整个以太坊生态系统受益。我们共同设想了一个全球金融的未来，在这个未来中，加密将在为已经建立的市场带来新的机会方面发挥重要作用。</p><p id="5c21" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">如果你喜欢处理数据，分享我们对以太坊的热情，我们希望你能加入。我们的代码库在<a class="ae lc" href="https://github.com/EthVM/EthVM" rel="noopener ugc nofollow" target="_blank"> Github </a>上。此外，我们还有一个公共的<a class="ae lc" href="https://myetherwallet.slack.com/" rel="noopener ugc nofollow" target="_blank"><em class="lr">et hvm—Devs</em></a>Slack频道，在那里你可以和核心开发者一起玩(<a class="ae lc" href="https://join.slack.com/t/myetherwallet/shared_invite/enQtNTc2MjAxMzUxOTc0LWQwNzMzOWEzOGE0NzU2YjcwMDFhMjdlY2YwOWJhMWQ2YzNjZTU5MmFkMTZmYjllZTU1OWVmMmIxM2RkMTgwN2M" rel="noopener ugc nofollow" target="_blank">邀请链接</a>)。</p><p id="ae77" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">因为我们真的很喜欢进入社区的细节和听到各种各样的反馈，我们期待着发布更多深入这个项目的一些很酷的技术方面的文章。敬请关注，保持联系！</p></div><div class="ab cl nb nc hc nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="hn ho hp hq hr"><p id="b4ba" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><em class="lr">由EthVM技术主管Aldo Borrero撰写。</em></p><p id="d558" class="pw-post-body-paragraph jj jk hu jl b jm jn iv jo jp jq iy jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><em class="lr">有关MEW和EthVM的更多内容，请参见</em><strong class="jl hv"><em class="lr"/></strong><a class="ae lc" href="https://medium.com/myetherwallet" rel="noopener"><strong class="jl hv"><em class="lr">MEW出版物</em> </strong> </a> <strong class="jl hv"> <em class="lr">。</em> </strong> <em class="lr">欲了解更多详情并投稿，请前往</em><a class="ae lc" href="https://github.com/EthVM/EthVM" rel="noopener ugc nofollow" target="_blank"><strong class="jl hv"><em class="lr">Github</em></strong></a><strong class="jl hv"><em class="lr">。</em> </strong></p></div></div>    
</body>
</html>