<html>
<head>
<title>React Chat Basic Tutorial</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React 聊天基础教程</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/react-chat-basic-tutorial-7bd2af16a57e#2019-02-03">https://medium.com/hackernoon/react-chat-basic-tutorial-7bd2af16a57e#2019-02-03</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="fadc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果你是一名软件开发人员、工程师或者只是对编程感兴趣，那么这篇教程是为你准备的。这个演练是开源和免费的；<a class="ae jp" href="https://en.wikipedia.org/wiki/MIT_License" rel="noopener ugc nofollow" target="_blank">麻省理工</a>风格。你可以查看完整的<a class="ae jp" href="https://github.com/nxsyed/ReactChatEngineApp" rel="noopener ugc nofollow" target="_blank"> React Chat GitHub 库</a>。</p><p id="fb81" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><a class="ae jp" href="https://reactjs.org/" rel="noopener ugc nofollow" target="_blank"> React </a>是一个<a class="ae jp" href="https://hackernoon.com/tagged/javascript" rel="noopener ugc nofollow" target="_blank"> JavaScript </a>库，它使您能够开发复杂的前端应用程序，能够以快速高效的方式处理业务逻辑。我们将使用 React 为我们强大的聊天应用程序构建 web 应用程序前端。React 的独特优势除了拥有最大的 JavaScript 社区之一和令人难以置信的灵活性之外，还在于它与 React Native 的兼容性，允许我们轻松地将我们的 web 应用程序转变为 iOS 和 Android 的原生移动应用程序。</p><p id="109a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在本教程中，我们将使用 React 和<a class="ae jp" href="https://pubnub.com/products/chatengine/" rel="noopener ugc nofollow" target="_blank"> PubNub ChatEngine </a>构建一个简单但功能丰富的聊天应用程序。React 与 material-UI 将被用来组织和增强我们的应用程序，而 ChatEngine 将被用作连接我们聊天用户的主干消息基础设施和框架。</p><h1 id="1471" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">React 概述</h1><p id="1949" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">在我们开始编码之前，我们需要对 React 是什么以及它为我们提供了什么有更深的理解。首先，React 是基于 JavaScript 构建的。这意味着我们可以使用我们对 JavaScript 的现有理解，并且仍然能够很好地使用 React。</p><p id="d638" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">React 与其他产品的主要区别在于组件的概念和组件内的生命周期。如果您没有太多使用 React 的经验，请不要担心！我建议在我们继续之前看一下官方的反应文件，但这不是必须的。</p><p id="d692" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">让我们开始编写 react 聊天应用程序吧！为了更简单，继续从 repo:<a class="ae jp" href="https://github.com/nxsyed/ReactChatEngineApp" rel="noopener ugc nofollow" target="_blank">React Chat GitHub Repository</a>。</p><h1 id="fbef" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">步骤 1:环境设置</h1><p id="d8d7" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">在进入代码之前，我们需要做一些事情。第一个是节点包管理器(NPM ),它可以让我们添加我们需要的包，以获得我们需要的所有有趣的功能。要获得 NPM，我们需要获得 Node 的最新版本，有了它，我们就可以在终端中使用 npm/npx 命令。一旦启动并运行，我们将使用终端安装一些必备的包并创建项目层次结构(这将为我们节省一些时间)。</p><pre class="kt ku kv kw fq kx ky kz la aw lb dt"><span id="010a" class="lc jr hu ky b fv ld le l lf lg"><em class="lh">    ## Enter these on your command line.</em><br/>    <em class="lh">## If you have not already, install Node.js (preferably LTS).</em><br/>    npx create-react-app react-chat-engine-app<br/><br/>    <em class="lh">## Change into the new directory</em><br/><br/>    cd react-chat-engine-app<br/><br/>    npm start</span></pre><p id="e512" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">使用 npx 命令设置一个样板 React 项目，其中包含 React 开发团队描述的所需包和首选文件夹结构。一旦我们运行 npm start，我们应该会在 URL“localhost:3000”上看到一个欢迎页面</p><p id="36fa" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">您将看到该实例将在终端中运行。请确保该窗口保持打开，因为它将允许我们在更新时看到热点更新。</p><h1 id="0ee5" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">步骤 2:聊天引擎设置</h1><p id="b77e" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">使用 ChatEngine 的最佳方式是使用 NPM 安装包</p><p id="9d5a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh li lj lk ky b">npm install chat-engine --save</code></p><p id="74ab" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">运行该命令将为我们提供让我们的应用程序能够聊天的先决条件。</p><h1 id="6868" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">步骤 3:创建 ChatEngine 服务</h1><p id="1404" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">现在我们已经创建了一个基本的 React 项目，我们可以开始给它添加一些味道了。我们要做的就是初始化 ChatEngine 对象。我们稍后将更深入地介绍该功能。</p><p id="8958" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">react-chat-engine-app/src/index . js</strong></p><pre class="kt ku kv kw fq kx ky kz la aw lb dt"><span id="802c" class="lc jr hu ky b fv ld le l lf lg"><strong class="ky hv">import</strong> React, { Component } <strong class="ky hv">from</strong> 'react';<br/>    <strong class="ky hv">import</strong> ChatEngineCore <strong class="ky hv">from</strong> 'chat-engine';<br/>    <br/>    <strong class="ky hv">const</strong> now <strong class="ky hv">=</strong> <strong class="ky hv">new</strong> Date().getTime();<br/>    <strong class="ky hv">const</strong> username <strong class="ky hv">=</strong> ['user', now].join('-');<br/>    <br/>    <strong class="ky hv">const</strong> ChatClient <strong class="ky hv">=</strong> ChatEngineCore.create({<br/>        publishKey: 'your-pub-key',<br/>        subscribeKey: 'your-sub-key'<br/>    }, {<br/>        globalChannel: 'chatting'<br/>    });<br/>    <br/>    <strong class="ky hv">class</strong> App <strong class="ky hv">extends</strong> Component {<br/>    <br/>      <strong class="ky hv">constructor</strong>(props) {<br/>        <strong class="ky hv">super</strong>(props);<br/>        <strong class="ky hv">this</strong>.chat <strong class="ky hv">=</strong> <strong class="ky hv">new</strong> ChatClient.Chat(`BasicChatApp`);<br/>      }<br/>      <br/>      render(){<br/>        <strong class="ky hv">&lt;</strong>div<strong class="ky hv">&gt;</strong> <strong class="ky hv">&lt;</strong>/div&gt;<br/>      }<br/>    }<br/>    <br/>    ChatClient.on('$.ready', () <strong class="ky hv">=&gt;</strong> {<br/>        ReactDOM.render(<strong class="ky hv">&lt;</strong>App <strong class="ky hv">/&gt;</strong>, document.getElementById('root'));<br/>    });</span></pre><p id="8625" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">由于 ChatEngine 依赖于 PubNub 的数据流<a class="ae jp" href="https://hackernoon.com/tagged/network" rel="noopener ugc nofollow" target="_blank">网络</a>，<strong class="it hv">我们需要</strong>pub nub 发布/订阅密钥来开始。使用以下表格配置 ChatEngine 并获取您的密钥:。</p><ol class=""><li id="175b" class="ll lm hu it b iu iv iy iz jc ln jg lo jk lp jo lq lr ls lt dt translated">生成的密钥将显示在您的屏幕上。</li><li id="eaa0" class="ll lm hu it b iu lu iy lv jc lw jg lx jk ly jo lq lr ls lt dt translated">用<strong class="it hv"> index.js </strong>中的字符串<strong class="it hv">&lt;YOUR-PUBNUB-Publish-KEY&gt;</strong>和<strong class="it hv">&lt;YOUR-PUBNUB-Subscribe-KEY&gt;</strong>替换新生成的发布密钥和订阅密钥</li></ol><h1 id="3687" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">步骤 4:用 React 构建应用程序 UI</h1><p id="5aaf" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">在上一步中，我们能够添加主要的后端功能，这将使我们的应用程序与其他实例进行通信。现在，下一步是连接</p><p id="472e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">为了显示聊天消息，我们使用<em class="lh"> &lt;离子列表&gt; </em>和<em class="lh"> &lt;离子网格&gt; </em> UI 元素。</p><p id="6db6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">应用程序 UI 的整个 HTML 代码在<strong class="it hv">home.html</strong>中声明。您可以根据此应用程序的新 UI 声明覆盖该文件。</p><p id="ad04" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">react-chat-engine-app/src/index . js</strong>(修改文件)</p><pre class="kt ku kv kw fq kx ky kz la aw lb dt"><span id="eef8" class="lc jr hu ky b fv ld le l lf lg"><strong class="ky hv">    import</strong> React, { Component } <strong class="ky hv">from</strong> 'react';<br/>    <strong class="ky hv">import</strong> ReactDOM <strong class="ky hv">from</strong> 'react-dom';<br/>    <strong class="ky hv">import</strong> './index.css';<br/>    <strong class="ky hv">import</strong> ChatEngineCore <strong class="ky hv">from</strong> 'chat-engine';<br/>    <br/>    <strong class="ky hv">import</strong> { withStyles } <strong class="ky hv">from</strong> '@material-ui/core/styles';<br/>    <strong class="ky hv">import</strong> Card <strong class="ky hv">from</strong> '@material-ui/core/Card';<br/>    <strong class="ky hv">import</strong> CardActions <strong class="ky hv">from</strong> '@material-ui/core/CardActions';<br/>    <strong class="ky hv">import</strong> CardContent <strong class="ky hv">from</strong> '@material-ui/core/CardContent';<br/>    <strong class="ky hv">import</strong> List <strong class="ky hv">from</strong> '@material-ui/core/List';<br/>    <strong class="ky hv">import</strong> ListItem <strong class="ky hv">from</strong> '@material-ui/core/ListItem';<br/>    <strong class="ky hv">import</strong> Button <strong class="ky hv">from</strong> '@material-ui/core/Button';<br/>    <strong class="ky hv">import</strong> Typography <strong class="ky hv">from</strong> '@material-ui/core/Typography';<br/>    <strong class="ky hv">import</strong> Input <strong class="ky hv">from</strong> '@material-ui/core/Input';<br/>    <strong class="ky hv">import</strong> opengraph <strong class="ky hv">from</strong> 'chat-engine-open-graph';<br/>    <br/>    <br/>    <strong class="ky hv">const</strong> now <strong class="ky hv">=</strong> <strong class="ky hv">new</strong> Date().getTime();<br/>    <strong class="ky hv">const</strong> username <strong class="ky hv">=</strong> ['user', now].join('-');<br/>    <br/>    <strong class="ky hv">const</strong> ChatClient <strong class="ky hv">=</strong> ChatEngineCore.create({<br/>        publishKey: 'your-pub-key',<br/>        subscribeKey: 'your-sub-key'<br/>    }, {<br/>        globalChannel: 'chatting'<br/>    });<br/>    <br/>    ChatClient.connect(username, {<br/>      signedOnTime: now<br/>    }, 'auth-key');<br/>    <br/>    <strong class="ky hv">const</strong> styles <strong class="ky hv">=</strong> {<br/>      card: {<br/>        maxWidth: 345,<br/>        margin: '0 auto', <br/>        float: 'none', <br/>        marginbottom: '10px' <br/>      },<br/>      openCard:{<br/>        maxWidth: 200<br/>      },<br/>      openMedia: {<br/>        height: 80,<br/>      },<br/>      media: {<br/>        objectFit: 'cover',<br/>      },<br/>      container: {<br/>        display: 'flex',<br/>        flexWrap: 'wrap',<br/>      },<br/>    };<br/>    <br/>    <strong class="ky hv">class</strong> Message <strong class="ky hv">extends</strong> Component{<br/>    <br/>      render () {<br/>          <strong class="ky hv">return</strong> ( <br/>            <strong class="ky hv">&lt;</strong>div <strong class="ky hv">&gt;</strong> <br/>              { <strong class="ky hv">this</strong>.props.uuid }: { <strong class="ky hv">this</strong>.props.text } <br/>            <strong class="ky hv">&lt;</strong>/div&gt;<br/>          );<br/>      }<br/>    };<br/>    <br/>    <strong class="ky hv">class</strong> App <strong class="ky hv">extends</strong> Component {<br/>    <br/>      <strong class="ky hv">constructor</strong>(props) {<br/>        <strong class="ky hv">super</strong>(props);<br/>        <strong class="ky hv">this</strong>.chat <strong class="ky hv">=</strong> <strong class="ky hv">new</strong> ChatClient.Chat(`BasicChatApp`);<br/>      }<br/>    <br/>      sendChat <strong class="ky hv">=</strong> () <strong class="ky hv">=&gt;</strong> {<br/>        console.log("Sending Chat");<br/>      }<br/>    <br/>      setChatInput <strong class="ky hv">=</strong> (event) <strong class="ky hv">=&gt;</strong> {<br/>        <strong class="ky hv">this</strong>.setState({ chatInput: event.target.value })<br/>      }<br/>    <br/>      componentDidMount() {<br/>        <br/>      }<br/>    <br/>      handleKeyPress <strong class="ky hv">=</strong> (e) <strong class="ky hv">=&gt;</strong> {<br/>        <strong class="ky hv">if</strong> (e.key <strong class="ky hv">===</strong> 'Enter') {<br/>            <strong class="ky hv">this</strong>.sendChat();<br/>        }<br/>      }<br/>    <br/>      render(){<br/>        <strong class="ky hv">const</strong> { classes } <strong class="ky hv">=</strong> <strong class="ky hv">this</strong>.props;<br/>        <strong class="ky hv">return</strong>(<br/>          <strong class="ky hv">&lt;</strong>Card className<strong class="ky hv">=</strong>{classes.card}<strong class="ky hv">&gt;</strong><br/>              <strong class="ky hv">&lt;</strong>CardContent<strong class="ky hv">&gt;</strong><br/>                <strong class="ky hv">&lt;</strong>Typography gutterBottom variant<strong class="ky hv">=</strong>"headline" component<strong class="ky hv">=</strong>"h2"<strong class="ky hv">&gt;</strong><br/>                  Messages<br/>                <strong class="ky hv">&lt;</strong>/Typography&gt;<br/>                  <strong class="ky hv">&lt;</strong>div className<strong class="ky hv">=</strong>{classes.root}<strong class="ky hv">&gt;</strong><br/>                    <strong class="ky hv">&lt;</strong>List component<strong class="ky hv">=</strong>"nav"<strong class="ky hv">&gt;</strong><br/>                      <strong class="ky hv">&lt;</strong>ListItem<strong class="ky hv">&gt;</strong><br/>                      <strong class="ky hv">&lt;</strong>Typography component<strong class="ky hv">=</strong>"div"<strong class="ky hv">&gt;</strong><br/>                        { <strong class="ky hv">this</strong>.state.messages }<br/>                      <strong class="ky hv">&lt;</strong>/Typography&gt;<br/>                      <strong class="ky hv">&lt;</strong>/ListItem&gt;<br/>                    <strong class="ky hv">&lt;</strong>/List&gt;<br/>                  <strong class="ky hv">&lt;</strong>/div&gt;<br/>              <strong class="ky hv">&lt;</strong>/CardContent&gt;<br/>              <strong class="ky hv">&lt;</strong>CardActions<strong class="ky hv">&gt;</strong><br/>                <strong class="ky hv">&lt;</strong>Input<br/>                  placeholder<strong class="ky hv">=</strong>"Enter a message"<br/>                  value<strong class="ky hv">=</strong>{<strong class="ky hv">this</strong>.state.chatInput}<br/>                  className<strong class="ky hv">=</strong>{classes.input}<br/>                  onKeyDown<strong class="ky hv">=</strong>{<strong class="ky hv">this</strong>.handleKeyPress}<br/>                  onChange<strong class="ky hv">=</strong>{<strong class="ky hv">this</strong>.setChatInput}<br/>                  inputProps<strong class="ky hv">=</strong>aria<strong class="ky hv">-</strong>label<br/>                <strong class="ky hv">/&gt;</strong><br/>                <strong class="ky hv">&lt;</strong>Button size<strong class="ky hv">=</strong>"small" color<strong class="ky hv">=</strong>"primary"<strong class="ky hv">&gt;</strong><br/>                  Github<br/>                <strong class="ky hv">&lt;</strong>/Button&gt;<br/>                <strong class="ky hv">&lt;</strong>Button size<strong class="ky hv">=</strong>"small" color<strong class="ky hv">=</strong>"primary"<strong class="ky hv">&gt;</strong><br/>                  Exit<br/>                <strong class="ky hv">&lt;</strong>/Button&gt;<br/>              <strong class="ky hv">&lt;</strong>/CardActions&gt;<br/>            <strong class="ky hv">&lt;</strong>/Card&gt;<br/>          );<br/>        }<br/>      }<br/>    <br/>    <strong class="ky hv">const</strong> ChatComponent <strong class="ky hv">=</strong> withStyles(styles)(App);<br/>    <br/>    ChatClient.on('$.ready', () <strong class="ky hv">=&gt;</strong> {<br/>        ReactDOM.render(<strong class="ky hv">&lt;</strong>ChatComponent <strong class="ky hv">/&gt;</strong>, document.getElementById('root'));<br/>    });</span></pre><p id="bcb0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">看起来我们在这里添加了很多代码。但是请放心，我们所做的只是使用 Material-UI 库创建了一个简单的 UI。但是，请注意我们正在改变的组件和状态。我们创建了一个名为 Message 的组件，它将作为一个虚拟组件来处理我们的聊天消息。另一件事是我们在应用程序组件中创建的状态，它允许我们在用户点击 enter 时清除聊天输入。我们存储在 state 中的另一个变量是消息数组。这是为了预测将进入我们的应用程序的消息，并重新呈现我们添加到数组中的每个新消息。</p><figure class="kt ku kv kw fq ma fe ff paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="fe ff lz"><img src="../Images/3f4e96abe44039f948a7e571264b7662.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*FJ51Xi2ffKkxYZXs"/></div></div></figure><h1 id="74c3" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">步骤 5:为应用程序 UI 编写业务逻辑代码</h1><p id="84da" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">这部分相当简单。我们在这里只看两个函数 componentDidMount 和 sendChat。我们发送和接收消息的所有逻辑都将存储在这里。</p><p id="4649" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">react-chat-engine-app/src/index . js/src/index . js</strong>(修改文件)</p><pre class="kt ku kv kw fq kx ky kz la aw lb dt"><span id="b59d" class="lc jr hu ky b fv ld le l lf lg"><strong class="ky hv">    import</strong> React, { Component } <strong class="ky hv">from</strong> 'react';<br/>    <strong class="ky hv">import</strong> ReactDOM <strong class="ky hv">from</strong> 'react-dom';<br/>    <strong class="ky hv">import</strong> './index.css';<br/>    <strong class="ky hv">import</strong> ChatEngineCore <strong class="ky hv">from</strong> 'chat-engine';<br/>    <br/>    <strong class="ky hv">import</strong> { withStyles } <strong class="ky hv">from</strong> '@material-ui/core/styles';<br/>    <strong class="ky hv">import</strong> Card <strong class="ky hv">from</strong> '@material-ui/core/Card';<br/>    <strong class="ky hv">import</strong> CardActions <strong class="ky hv">from</strong> '@material-ui/core/CardActions';<br/>    <strong class="ky hv">import</strong> CardContent <strong class="ky hv">from</strong> '@material-ui/core/CardContent';<br/>    <strong class="ky hv">import</strong> List <strong class="ky hv">from</strong> '@material-ui/core/List';<br/>    <strong class="ky hv">import</strong> ListItem <strong class="ky hv">from</strong> '@material-ui/core/ListItem';<br/>    <strong class="ky hv">import</strong> Button <strong class="ky hv">from</strong> '@material-ui/core/Button';<br/>    <strong class="ky hv">import</strong> Typography <strong class="ky hv">from</strong> '@material-ui/core/Typography';<br/>    <strong class="ky hv">import</strong> Input <strong class="ky hv">from</strong> '@material-ui/core/Input';<br/>    <strong class="ky hv">import</strong> opengraph <strong class="ky hv">from</strong> 'chat-engine-open-graph';<br/>    <br/>    <br/>    <strong class="ky hv">const</strong> now <strong class="ky hv">=</strong> <strong class="ky hv">new</strong> Date().getTime();<br/>    <strong class="ky hv">const</strong> username <strong class="ky hv">=</strong> ['user', now].join('-');<br/>    <br/>    <strong class="ky hv">const</strong> ChatClient <strong class="ky hv">=</strong> ChatEngineCore.create({<br/>        publishKey: 'your-pub-key',<br/>        subscribeKey: 'your-sub-key'<br/>    }, {<br/>        globalChannel: 'chatting'<br/>    });<br/>    <br/>    ChatClient.connect(username, {<br/>      signedOnTime: now<br/>    }, 'auth-key');<br/>    <br/>    <strong class="ky hv">const</strong> styles <strong class="ky hv">=</strong> {<br/>      card: {<br/>        maxWidth: 345,<br/>        margin: '0 auto', <br/>        float: 'none', <br/>        marginbottom: '10px' <br/>      },<br/>      openCard:{<br/>        maxWidth: 200<br/>      },<br/>      openMedia: {<br/>        height: 80,<br/>      },<br/>      media: {<br/>        objectFit: 'cover',<br/>      },<br/>      container: {<br/>        display: 'flex',<br/>        flexWrap: 'wrap',<br/>      },<br/>    };<br/>    <br/>    <strong class="ky hv">class</strong> Message <strong class="ky hv">extends</strong> Component{<br/>    <br/>      render () {<br/>          <strong class="ky hv">return</strong> ( <br/>            <strong class="ky hv">&lt;</strong>div <strong class="ky hv">&gt;</strong> <br/>              { <strong class="ky hv">this</strong>.props.uuid }: { <strong class="ky hv">this</strong>.props.text } <br/>            <strong class="ky hv">&lt;</strong>/div&gt;<br/>          );<br/>      }<br/>    };<br/>    <br/>    <strong class="ky hv">class</strong> App <strong class="ky hv">extends</strong> Component {<br/>    <br/>      <strong class="ky hv">constructor</strong>(props) {<br/>        <strong class="ky hv">super</strong>(props);<br/>        <strong class="ky hv">this</strong>.chat <strong class="ky hv">=</strong> <strong class="ky hv">new</strong> ChatClient.Chat(`BasicChatApp`);<br/>      }<br/>    <br/>      sendChat <strong class="ky hv">=</strong> () <strong class="ky hv">=&gt;</strong> {<br/>        console.log("Sending Chat");<br/>      }<br/>    <br/>      setChatInput <strong class="ky hv">=</strong> (event) <strong class="ky hv">=&gt;</strong> {<br/>        <strong class="ky hv">this</strong>.setState({ chatInput: event.target.value })<br/>      }<br/>    <br/>      componentDidMount() {<br/>        <br/>      }<br/>    <br/>      handleKeyPress <strong class="ky hv">=</strong> (e) <strong class="ky hv">=&gt;</strong> {<br/>        <strong class="ky hv">if</strong> (e.key <strong class="ky hv">===</strong> 'Enter') {<br/>            <strong class="ky hv">this</strong>.sendChat();<br/>        }<br/>      }<br/>    <br/>      render(){<br/>        <strong class="ky hv">const</strong> { classes } <strong class="ky hv">=</strong> <strong class="ky hv">this</strong>.props;<br/>        <strong class="ky hv">return</strong>(<br/>          <strong class="ky hv">&lt;</strong>Card className<strong class="ky hv">=</strong>{classes.card}<strong class="ky hv">&gt;</strong><br/>              <strong class="ky hv">&lt;</strong>CardContent<strong class="ky hv">&gt;</strong><br/>                <strong class="ky hv">&lt;</strong>Typography gutterBottom variant<strong class="ky hv">=</strong>"headline" component<strong class="ky hv">=</strong>"h2"<strong class="ky hv">&gt;</strong><br/>                  Messages<br/>                <strong class="ky hv">&lt;</strong>/Typography&gt;<br/>                  <strong class="ky hv">&lt;</strong>div className<strong class="ky hv">=</strong>{classes.root}<strong class="ky hv">&gt;</strong><br/>                    <strong class="ky hv">&lt;</strong>List component<strong class="ky hv">=</strong>"nav"<strong class="ky hv">&gt;</strong><br/>                      <strong class="ky hv">&lt;</strong>ListItem<strong class="ky hv">&gt;</strong><br/>                      <strong class="ky hv">&lt;</strong>Typography component<strong class="ky hv">=</strong>"div"<strong class="ky hv">&gt;</strong><br/>                        { <strong class="ky hv">this</strong>.state.messages }<br/>                      <strong class="ky hv">&lt;</strong>/Typography&gt;<br/>                      <strong class="ky hv">&lt;</strong>/ListItem&gt;<br/>                    <strong class="ky hv">&lt;</strong>/List&gt;<br/>                  <strong class="ky hv">&lt;</strong>/div&gt;<br/>              <strong class="ky hv">&lt;</strong>/CardContent&gt;<br/>              <strong class="ky hv">&lt;</strong>CardActions<strong class="ky hv">&gt;</strong><br/>                <strong class="ky hv">&lt;</strong>Input<br/>                  placeholder<strong class="ky hv">=</strong>"Enter a message"<br/>                  value<strong class="ky hv">=</strong>{<strong class="ky hv">this</strong>.state.chatInput}<br/>                  className<strong class="ky hv">=</strong>{classes.input}<br/>                  onKeyDown<strong class="ky hv">=</strong>{<strong class="ky hv">this</strong>.handleKeyPress}<br/>                  onChange<strong class="ky hv">=</strong>{<strong class="ky hv">this</strong>.setChatInput}<br/>                  inputProps<strong class="ky hv">=</strong>aria<strong class="ky hv">-</strong>label<br/>                <strong class="ky hv">/&gt;</strong><br/>                <strong class="ky hv">&lt;</strong>Button size<strong class="ky hv">=</strong>"small" color<strong class="ky hv">=</strong>"primary"<strong class="ky hv">&gt;</strong><br/>                  Github<br/>                <strong class="ky hv">&lt;</strong>/Button&gt;<br/>                <strong class="ky hv">&lt;</strong>Button size<strong class="ky hv">=</strong>"small" color<strong class="ky hv">=</strong>"primary"<strong class="ky hv">&gt;</strong><br/>                  Exit<br/>                <strong class="ky hv">&lt;</strong>/Button&gt;<br/>              <strong class="ky hv">&lt;</strong>/CardActions&gt;<br/>            <strong class="ky hv">&lt;</strong>/Card&gt;<br/>          );<br/>        }<br/>      }<br/>    <br/>    <strong class="ky hv">const</strong> ChatComponent <strong class="ky hv">=</strong> withStyles(styles)(App);<br/>    <br/>    ChatClient.on('$.ready', () <strong class="ky hv">=&gt;</strong> {<br/>        ReactDOM.render(<strong class="ky hv">&lt;</strong>ChatComponent <strong class="ky hv">/&gt;</strong>, document.getElementById('root'));<br/>    });</span></pre><p id="a614" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">让我们一个功能一个功能地分析这段代码。</p><h2 id="4819" class="lc jr hu bd js mh mi mj jw mk ml mm ka jc mn mo ke jg mp mq ki jk mr ms km mt dt translated">A.构造函数()</h2><p id="1c8a" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">这里发生了两件事。首先是用频道名初始化我们的 ChatEngine 对象。第二个是创建几个变量来跟踪应用程序中的变化，包括已经输入的消息和进入应用程序的新消息。</p><h2 id="ee13" class="lc jr hu bd js mh mi mj jw mk ml mm ka jc mn mo ke jg mp mq ki jk mr ms km mt dt translated">B.sendChat()</h2><p id="d417" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">该函数检查用户是否输入了消息的状态。如果他们按下了 enter 键，该函数将向我们定义的通道发送一条发布消息。</p><h2 id="886b" class="lc jr hu bd js mh mi mj jw mk ml mm ka jc mn mo ke jg mp mq ki jk mr ms km mt dt translated">C.setChatInput(事件)</h2><p id="e6b7" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">这个方法用于检索所有加入聊天室的用户。这用于填充 UI 的标题部分，以显示当前在聊天室中的所有用户。</p><h2 id="d00c" class="lc jr hu bd js mh mi mj jw mk ml mm ka jc mn mo ke jg mp mq ki jk mr ms km mt dt translated">D.componentDidMount()</h2><p id="146d" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">此方法用于从 app 客户端发送聊天消息。它被绑定到 UI 的<em class="lh"> &lt;输入框&gt; </em>以及<em class="lh"> &lt;按钮&gt; </em>元素。</p><h1 id="29c4" class="jq jr hu bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dt translated">后续步骤</h1><p id="18eb" class="pw-post-body-paragraph ir is hu it b iu ko iw ix iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo hn dt translated">我们现在有了一个用 React 库构建的基本功能聊天应用。你可以查看<a class="ae jp" href="https://github.com/nxsyed/ReactChatEngineApp" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>获取这个应用的完整代码。现在你可以在你的机器上运行这个项目了！</p></div><div class="ab cl mu mv hc mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="hn ho hp hq hr"><p id="003c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="lh">最初发表于</em><a class="ae jp" href="https://reactjs.chat/tutorials/react-basic-chat-module/" rel="noopener ugc nofollow" target="_blank"><em class="lh">reactjs . chat</em></a><em class="lh">。</em></p><figure class="kt ku kv kw fq ma"><div class="bz el l di"><div class="nb nc l"/></div></figure></div></div>    
</body>
</html>