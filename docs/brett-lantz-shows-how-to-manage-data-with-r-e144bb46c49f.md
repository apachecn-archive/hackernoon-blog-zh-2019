# Brett Lantz 展示了如何用 R

> 原文：<https://medium.com/hackernoon/brett-lantz-shows-how-to-manage-data-with-r-e144bb46c49f>

处理海量数据集面临的挑战之一是收集、准备和管理来自各种来源的数据。本文重点介绍了将数据导入和导出 r 的基本功能。

基本的 R 数据结构是 vector，它被扩展并组合成更复杂的数据类型，比如列表和数据帧。数据框是一种 R 数据结构，对应于既有要素又有示例的数据集的概念。r 提供了向类似电子表格的表格数据文件读写数据框的函数。

*本文节选自 Brett Lantz 著的《机器学习与 R》第三版* *一书。这本书提供了将机器学习应用于现实世界问题的实际操作的可读指南。无论你是一个经验丰富的 R 用户还是语言新手，这本书都会教你发现关键见解、做出新的预测和可视化你的发现所需的一切。*

# 保存、加载和删除 R 数据结构

当您花费大量时间将数据框转换成所需的格式时，您不需要在每次重新启动 R 会话时重新创建您的工作。要将数据结构保存到一个文件中，以便以后重新加载或传输到另一个系统，使用`save()`功能。`save()`函数将一个或多个 R 数据结构写入 file 参数指定的位置。r 数据文件有一个。RData 扩展。

假设您有三个名为 x、y 和 z 的对象，您希望将它们保存到一个永久文件中。无论它们是向量、因子、列表还是数据框，都可以保存到名为 mydata 的文件中。RData 使用以下命令:

```
> save(x, y, z, file = “mydata.RData”)
```

`load()`命令可以重新创建任何保存到`.RData`文件的数据结构。要加载前面代码中创建的`mydata.RData`文件，只需键入:

```
> load(“mydata.RData”)
```

这将在您的 R 环境中重新创建 x、y 和 z 数据结构。

***注意*** *:小心你正在装载的东西！使用* `*load()*` *命令导入的文件中存储的所有数据结构将被添加到您的工作空间，即使它们覆盖了您正在处理的其他内容。*

如果您需要快速结束您的 R 会话，`save.image()`命令会将您的整个会话写入一个名为`.RData`的文件。默认情况下，R 将在您下次启动 R 时查找这个文件，并且您的会话将像您离开时一样被重新创建。

在 R 会话中工作一段时间后，您可能已经积累了许多数据结构。列表函数`ls()`返回当前内存中所有数据结构的向量。例如，如果您一直遵循本章中的代码，`ls()`函数将返回以下内容:

```
> ls()[1] “blood” “flu_status” “gender” “m”[5] “subject_name” “subject1” “symptoms”[9] “temperature”
```

r 在退出会话时会自动清除内存中的所有数据结构，但是对于大型对象，您可能希望尽快释放内存。移除功能`rm()`可用于此目的。例如，要消除`m`和`subject1`对象，只需键入:

```
> rm(m, subject1)
```

`rm()`函数也可以提供一个要删除的对象名的字符向量。这与`ls()`功能一起清除整个 R 会话。

```
> rm(list=ls())
```

执行前面的代码时要非常小心，因为在移除对象之前不会提示您！

# 从 CSV 文件导入和保存数据

公共数据集存储在文本文件中是非常常见的。文本文件几乎可以在任何计算机或操作系统上阅读，这使得这种格式几乎是通用的。它们还可以从 Microsoft Excel 等程序中导出和导入，从而提供了一种快速而简单的处理电子表格数据的方法。

**表格**(如“表格”)数据文件以矩阵形式构成，这样每行文本反映一个例子，每个例子具有相同数量的特征。每行上的特征值由一个预定义的符号分隔，称为**分隔符**。通常，表格数据文件的第一行列出数据列的名称。这被称为**标题**行。

也许最常见的表格文本文件格式是**逗号分隔值** ( **CSV** )文件，顾名思义，它使用逗号作为分隔符。CSV 文件可以导入和导出许多常见的应用程序。表示先前构建的医疗数据集的 CSV 文件可以存储为:

```
subject_name,temperature,flu_status,gender,blood_typeJohn Doe,98.1,FALSE,MALE,OJane Doe,98.6,FALSE,FEMALE,ABSteve Graves,101.4,TRUE, MALE,A
```

给定位于 R 工作目录中的名为`pt_data.csv`的患者数据文件，可以使用`read.csv()`函数将文件加载到 R:

```
> pt_data <- read.csv(“pt_data.csv”, stringsAsFactors = FALSE)
```

这将把 CSV 文件读入名为 pt_data 的数据帧。正如我们之前在构建数据框时所做的一样，我们需要使用`stringsAsFactors = FALSE`参数来防止 R 将所有文本变量转换为因子。除非您确定 CSV 文件中的每一列都是真正的因素，否则这一步最好留给您来执行，而不是 R。

***注意*** *:如果你的数据集驻留在 R 工作目录之外，那么调用 read.csv()函数时可以使用 CSV 文件的完整路径(例如，“* `*/path/to/mydata.csv*` *”)。*

默认情况下，R 假设 CSV 文件包含一个标题行，其中列出了数据集中的要素名称。如果一个 CSV 文件没有文件头，指定如下命令所示的`option header = FALSE`, R 将分配默认的特征名称，编号为 V1、V2 等等:

```
> mydata <- read.csv(“mydata.csv”, stringsAsFactors = FALSE,header = FALSE)
```

`read.csv()`函数是`read.table()`函数的特例，它可以读取许多不同形式的表格数据，包括其他分隔格式，如制表符分隔值(TSV)。关于`read.table()`系列功能的更多详细信息，请参考使用`?read.table`命令的 R 帮助页面。

使用`write.csv()`功能将数据框保存为 CSV 文件。如果您的数据框名为`pt_data`，只需输入:

```
> write.csv(pt_data, file = “pt_data.csv”, row.names = FALSE)
```

这将把一个名为`pt_data.csv`的 CSV 文件写入 R 工作文件夹。row.names 参数覆盖 R 的默认设置，即在 CSV 文件中输出行名。

# 结论

在本文中，我们学习了在 R 中管理数据的基础知识。我们从学习用于在 R 中存储各种类型的数据的结构以及如何保存它们开始。然后，我们继续以常用的 CSV 格式读写数据。

现在，我们已经花了一些时间来理解 R 的数据管理基础，您已经准备好开始使用机器学习来解决现实世界的问题。要进一步研究，可以参考 Brett Lantz 的最新著作 [*带 R 的机器学习，第三版*](https://prod.packtpub.com/big-data-and-business-intelligence/machine-learning-r-third-edition) 。

# 关于作者

*Brett Lantz 是 DataCamp 讲师，也是世界各地机器学习会议和研讨会的常客。作为一名训练有素的社会学家，Brett 第一次被机器学习迷住是在对一个大型社交网络档案数据库进行研究的过程中。*