<html>
<head>
<title>Closures in Javascript learn the easy way</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Javascript中的闭包学习简单的方法</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/closures-in-javascript-learn-the-easy-way-7a7317ce2a07?source=collection_archive---------6-----------------------#2019-01-30">https://medium.com/hackernoon/closures-in-javascript-learn-the-easy-way-7a7317ce2a07?source=collection_archive---------6-----------------------#2019-01-30</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><figure class="ht hu fm fo hv hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff hs"><img src="../Images/1ca51a2a14047848b50c932df74fbe92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wB2IWBDUUQpLiex4hcdvEQ.jpeg"/></div></div></figure><div class=""/><h1 id="c7d3" class="jc jd if bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz dt translated">什么是闭包？</h1><blockquote class="ka kb kc"><p id="16ab" class="kd ke kf kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb hn dt translated">一个<strong class="kg ig">闭包</strong>是一个内部函数，它可以访问外部(封闭)函数的变量——作用域链。<strong class="kg ig">闭包</strong>有三个作用域链:它可以访问自己的作用域(花括号中定义的变量)，可以访问外部函数的变量，还可以访问全局变量</p></blockquote><p id="13a7" class="pw-post-body-paragraph kd ke if kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb hn dt translated">简单地说，这就是它的字面意思，函数内部的函数，依赖于外部函数中的变量来工作。</p><p id="1e0e" class="pw-post-body-paragraph kd ke if kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb hn dt translated">理解一个概念的最好方法是去做。</p><p id="a686" class="pw-post-body-paragraph kd ke if kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb hn dt translated">让我们来看一些闭包的例子。</p><pre class="lf lg lh li fq lj lk ll lm aw ln dt"><span id="ee9b" class="lo jd if lk b fv lp lq l lr ls">function doSomeMath(){<br/>var a=5;<br/>var b=4;<br/>var sum=a+b;</span><span id="58dc" class="lo jd if lk b fv lt lq l lr ls">return sum;<br/>}</span><span id="8bef" class="lo jd if lk b fv lt lq l lr ls">var theResult = doSomeMath();</span><span id="6e24" class="lo jd if lk b fv lt lq l lr ls">console.log("The result:", theResult);</span></pre><p id="add9" class="pw-post-body-paragraph kd ke if kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb hn dt translated">我们在这里做一些数学计算，设置三个变量，将一个变量加到另一个变量上，然后返回总和。现在让我们仔细看看浏览器到底是如何处理这些代码的。当我们在浏览器中运行脚本时。它首先发现这个函数doSomeMath，但是没有对它做任何事情。然后在这里找到变量Result，看到doSomeMath被赋给了这个变量。</p><p id="2d33" class="pw-post-body-paragraph kd ke if kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb hn dt translated">这意味着它需要运行doSomeMath，所以它跳到函数，设置三个变量，执行数学运算，然后将结果放在sum变量中，并返回sum变量。然后，sum变量的内容被放入结果中，doSomeMath函数被有效地关闭，其中的所有内容都被丢弃。结果中唯一剩下的是值9，这意味着如果我去控制台，尝试调用A，B，或sum，我什么也没得到。</p><figure class="lf lg lh li fq hw fe ff paragraph-image"><div class="fe ff lu"><img src="../Images/7941299037dc01a168ffe34ba2a64b5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*OZ7oc44fKLV7GfXjPPF_NA.png"/></div></figure><p id="6edf" class="pw-post-body-paragraph kd ke if kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb hn dt translated">这是因为它们位于函数doSomeMath的范围内。我们现在在范围之外，这些变量不存在。到目前为止，这里没有什么新的东西。现在让我们稍微改变一下这个例子。</p><pre class="lf lg lh li fq lj lk ll lm aw ln dt"><span id="2c00" class="lo jd if lk b fv lp lq l lr ls">function doSomeMath(){<br/>var a=5;<br/>var b=4;</span><span id="5230" class="lo jd if lk b fv lt lq l lr ls">function multiply(){<br/>    var result = a*b;<br/>    return result;<br/>}</span><span id="baa7" class="lo jd if lk b fv lt lq l lr ls">return multiply;<br/>}</span><span id="f2ab" class="lo jd if lk b fv lt lq l lr ls">var theResult = doSomeMath();</span><span id="0669" class="lo jd if lk b fv lt lq l lr ls">console.log("The result:", theResult);</span></pre><p id="4f7e" class="pw-post-body-paragraph kd ke if kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb hn dt translated">如果我现在保存它，你会在控制台这里看到，变量Result现在保存了total函数及其所有内容。</p><figure class="lf lg lh li fq hw fe ff paragraph-image"><div class="fe ff lv"><img src="../Images/adf97152a1eec0e6b7ca0c4e5f5be833.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/1*Y9Apm2GDIBrNkkg33jMZAQ.png"/></div></figure><p id="2e8d" class="pw-post-body-paragraph kd ke if kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb hn dt translated">如果我现在保存它，你会在控制台这里看到，变量Result现在保存了total函数及其所有内容。</p><figure class="lf lg lh li fq hw fe ff paragraph-image"><div class="fe ff lw"><img src="../Images/4caf3f9327d13b01a79ea017eabe66d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1238/format:webp/1*tEKeZKI1GncAtl4sr9YC4w.png"/></div></figure><p id="2c26" class="pw-post-body-paragraph kd ke if kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb hn dt translated">这很奇怪，基于我们已经知道的函数是如何工作的，这是不应该的。我为什么要说这个？好吧，考虑一下这个问题。浏览器从右上方读取？所以它首先找到函数doSomeMath，但不对它做任何事情。然后它跳到变量Result，看到doSomeMath已经被赋值给它，所以它跳到最上面，运行整个函数。它设置了两个变量，注册了乘法函数，然后在底部看到，哦，我想返回乘法函数，但我不想运行它，我只是把它当作一个变量来返回，所以我把这个乘法函数放在结果中，其他的都关闭。</p><p id="7257" class="pw-post-body-paragraph kd ke if kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb hn dt translated">所以从技术上来说，这意味着A和B应该停止存在，但如果我们在控制台中查看，它显然不存在，它显然还在那里。这就是所谓的终结。实际情况是，这个内部函数乘法，依赖于已经在外部函数中定义的变量。而且浏览器足够聪明，可以理解哦，这些东西是相关的，所以即使我们已经关闭了doSomeMath函数，我还是要让这两个变量保持活动状态，这样乘法函数仍然可以使用它们。</p><p id="acf8" class="pw-post-body-paragraph kd ke if kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb hn dt translated"><strong class="kg ig">那么我们为什么会有这种特性呢？</strong></p><p id="f212" class="pw-post-body-paragraph kd ke if kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb hn dt translated">嗯，它有一些有趣的实际应用。让我给你看一个非常简单的例子。我会清除我所有的代码，然后我们重新开始。如果你曾经在CSS中使用过Em，你就会知道计算它们可能有点麻烦，特别是如果你知道你要寻找的像素值是多少，然后你必须计算出类似的Em值是多少。</p><p id="1204" class="pw-post-body-paragraph kd ke if kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb hn dt translated">Ems的诀窍是，如果你知道当前上下文的像素值，你可以只取你正在寻找的像素值，比如说32个像素，然后用它除以当前上下文像素值，如果你只是在整个浏览器中工作，通常是16。所需像素值32除以根像素值16的结果就是Em值。使用闭包，我们可以创建一个函数来帮助我们生成这些数字。</p><p id="3572" class="pw-post-body-paragraph kd ke if kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb hn dt translated">首先我要建立一个新的函数，我把它命名为giveMeEms。此函数有一个参数(像素)。这是我们要转换成Ems的像素值。在函数内部，我们有一个名为baseValue的变量。我将把它设置为16，因为16是大多数浏览器的基本字体大小。然后我们设置了一个内部函数doTheMath。在doTheMath内部，我们将简单地返回pixels/baseValue。</p><p id="09ab" class="pw-post-body-paragraph kd ke if kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb hn dt translated">看这里，我们获取像素参数，并在内部函数中使用它，然后获取变量基值，并在内部函数中使用它。最后，为了结束，我们返回doTheMath。现在，我们可以设置一系列调用giveMeEms的变量和不同的像素大小，并获得相应的值。所以我将设置var smallSize = giveMeEms。</p><p id="7e8b" class="pw-post-body-paragraph kd ke if kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb hn dt translated">这里我将传递(12)，所以我在寻找相当于12个像素的Em值。那么var mediumSize = giveMeEms(18)，var largeSize = giveMeEms(24)。最后是var xlargeSize = giveMeEms(32)。</p><p id="a315" class="pw-post-body-paragraph kd ke if kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb hn dt translated">然后，为了实际获得这里的结果，我将console.log("Small size:"和Small size ")。我就抄这些。中，大，超大，最后，我需要运行小尺寸，中尺寸，大尺寸，超大尺寸变量作为函数。</p><pre class="lf lg lh li fq lj lk ll lm aw ln dt"><span id="d6e7" class="lo jd if lk b fv lp lq l lr ls">function giveMeEms(pixels){<br/>var baseValue = 16;</span><span id="e0bd" class="lo jd if lk b fv lt lq l lr ls">function doTheMath(){<br/>return pixels/baseValue;<br/>}</span><span id="47ec" class="lo jd if lk b fv lt lq l lr ls">return doTheMath;<br/>}</span><span id="3d16" class="lo jd if lk b fv lt lq l lr ls">var smallSize = giveMeEms(12);<br/>var mediumSize = giveMeEms(18);<br/>var largeSize = giveMeEms(24);<br/>var xlargeSize = giveMeEms(32);</span><span id="512c" class="lo jd if lk b fv lt lq l lr ls">console.log("Small Size", smallSize())<br/>console.log("Medium Size", mediumSize())<br/>console.log("Large Size", largeSize())<br/>console.log("Extra Large Size", xlargeSize())</span></pre><p id="1480" class="pw-post-body-paragraph kd ke if kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb hn dt translated">当我保存它，并在浏览器中运行时，</p><figure class="lf lg lh li fq hw fe ff paragraph-image"><div class="fe ff lx"><img src="../Images/fdf0be27d94131b09631c957aee3bb4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1244/format:webp/1*NRfKfBH1NlGBbLgBUS1phw.png"/></div></figure><p id="8bfb" class="pw-post-body-paragraph kd ke if kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb hn dt translated">我得到了这些尺寸的Em尺寸，0.75、1.125、1.5和2。同样，这仅仅是因为闭包才成为可能。在这种情况下，这里的闭包既包含了这个变量的基值，也包含了像素的值，尽管从技术上来说，giveMeEms函数已经运行了，当我们在这里调用它时，我们应该不能得到这些值。</p><blockquote class="ka kb kc"><p id="b60d" class="kd ke kf kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb hn dt translated">JavaScript 中的闭包是一个有趣的话题，这个特殊的兔子洞比我在这里展示的要深得多。为了更好地理解闭包有多强大，在哪里可以使用它们，以及它们什么时候可能导致问题，您应该查看MDN上关于闭包的文章。它给了你很多例子，更多的细节，告诉你如何在日常代码中使用它们。</p></blockquote><p id="d2d0" class="pw-post-body-paragraph kd ke if kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb hn dt translated"><em class="kf">你好，我叫</em> <a class="ae ly" href="https://www.linkedin.com/in/officialrahulmandal/" rel="noopener ugc nofollow" target="_blank"> <strong class="kg ig"> <em class="kf">胡尔·库马尔·曼达尔</em> </strong> </a> <em class="kf">。我是一个全栈开发者。我写的是JavaScript、NodeJS和reactjs。和大家分享我的世界观，在</em><a class="ae ly" href="https://twitter.com/official__rahul" rel="noopener ugc nofollow" target="_blank"><strong class="kg ig"><em class="kf">Twitter</em></strong></a><em class="kf">或</em><a class="ae ly" rel="noopener" href="/@officialrahulmandal"><strong class="kg ig"><em class="kf">Medium</em></strong></a><em class="kf">关注我，加入我的探索。</em></p><p id="b7c7" class="pw-post-body-paragraph kd ke if kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb hn dt translated">我希望您喜欢这篇关于JavaScript闭包的文章。</p><p id="26f2" class="pw-post-body-paragraph kd ke if kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb hn dt translated">请随意评论并喜欢这篇文章，以便其他人可以在Medium上轻松找到它！</p><p id="9151" class="pw-post-body-paragraph kd ke if kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb hn dt translated">感谢你阅读这篇文章，如果你喜欢，就和你的朋友和敌人分享吧。我会写更多关于JavaScript的文章，请与我保持联系。</p><figure class="lf lg lh li fq hw"><div class="bz el l di"><div class="lz ma l"/></div></figure></div></div>    
</body>
</html>