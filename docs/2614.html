<html>
<head>
<title>Presidential Debate Sentiment Analysis with LSTM, OneVsRest, LinearSVC: NLP Step-By-Step Guide</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">总统辩论情绪分析与LSTM，OneVsRest，LinearSVC: NLP分步指南</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/presidential-debate-sentiment-analysis-with-lstm-onevsrest-linearsvc-nlp-step-by-step-guide-b9683e2c8ed9?source=collection_archive---------11-----------------------#2019-04-24">https://medium.com/hackernoon/presidential-debate-sentiment-analysis-with-lstm-onevsrest-linearsvc-nlp-step-by-step-guide-b9683e2c8ed9?source=collection_archive---------11-----------------------#2019-04-24</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div class="fe ff ir"><img src="../Images/163a0aa777f53d26523267a56df5eb5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1286/format:webp/1*BDfeAUMC2A1c5v6MC-2YVg.png"/></div><figcaption class="iy iz fg fe ff ja jb bd b be z ek">Cartooned by Alina Z</figcaption></figure><p id="5544" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je hv"> <em class="ka">“民情决定一切。”——亚伯拉罕·林肯</em>T3】</strong></p><p id="ac41" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">数据来源是俄亥俄州第一场2016年共和党总统辩论的数万条推文。给定推文的情绪是什么？是正面的，中性的，还是负面的？正面/负面推文中使用频率最高的词是什么？</p><p id="4826" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">您将学习基本的自然语言处理技能，包括:</p><ul class=""><li id="f0d4" class="kb kc hu je b jf jg jj jk jn kd jr ke jv kf jz kg kh ki kj dt translated">文本预处理</li><li id="80b6" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated">标记化</li><li id="c384" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated">使用TF-IDF嵌入单词</li><li id="7822" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated">用LSTM、逻辑回归、OneVsRest、LinearSVC等建模。</li><li id="76f0" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated">使用F1分数、精确度、召回率、准确度进行评估</li></ul><p id="b60f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">本文末尾将提供NLP项目的端到端路线图。</p></div><div class="ab cl kp kq hc kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="hn ho hp hq hr"><h1 id="bab8" class="kw kx hu bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt dt translated">加载数据并快速查看数据</h1><pre class="lu lv lw lx fq ly lz ma mb aw mc dt"><span id="9701" class="md kx hu lz b fv me mf l mg mh"><strong class="lz hv">import</strong> <strong class="lz hv">numpy</strong> <strong class="lz hv">as</strong> <strong class="lz hv">np</strong> <br/><strong class="lz hv">import</strong> <strong class="lz hv">pandas</strong> <strong class="lz hv">as</strong> <strong class="lz hv">pd</strong> </span><span id="5812" class="md kx hu lz b fv mi mf l mg mh"><strong class="lz hv">import</strong> <strong class="lz hv">nltk</strong><br/>nltk.download('stopwords')<br/><strong class="lz hv">from</strong> <strong class="lz hv">nltk.corpus</strong> <strong class="lz hv">import</strong> stopwords</span><span id="8a09" class="md kx hu lz b fv mi mf l mg mh"><strong class="lz hv">from</strong> <strong class="lz hv">sklearn.feature_extraction.text</strong> <strong class="lz hv">import</strong> CountVectorizer<br/><strong class="lz hv">from</strong> <strong class="lz hv">keras.preprocessing.text</strong> <strong class="lz hv">import</strong> Tokenizer<br/><strong class="lz hv">from</strong> <strong class="lz hv">keras.preprocessing.sequence</strong> <strong class="lz hv">import</strong> pad_sequences<br/><strong class="lz hv">from</strong> <strong class="lz hv">keras.models</strong> <strong class="lz hv">import</strong> Sequential<br/><strong class="lz hv">from</strong> <strong class="lz hv">keras.layers</strong> <strong class="lz hv">import</strong> Dense, Embedding, LSTM, SpatialDropout1D<br/><strong class="lz hv">from</strong> <strong class="lz hv">keras.utils.np_utils</strong> <strong class="lz hv">import</strong> to_categorical<br/><strong class="lz hv">import</strong> <strong class="lz hv">re</strong><br/><br/><strong class="lz hv">from</strong> <strong class="lz hv">sklearn.model_selection</strong> <strong class="lz hv">import</strong> train_test_split, cross_val_score<br/><strong class="lz hv">from</strong> <strong class="lz hv">sklearn.linear_model</strong> <strong class="lz hv">import</strong> LogisticRegression<br/><strong class="lz hv">from</strong> <strong class="lz hv">sklearn.svm</strong> <strong class="lz hv">import</strong> LinearSVC<br/><strong class="lz hv">from</strong> <strong class="lz hv">sklearn.multiclass</strong> <strong class="lz hv">import</strong> OneVsRestClassifier<br/><strong class="lz hv">from</strong> <strong class="lz hv">sklearn.linear_model</strong> <strong class="lz hv">import</strong> RidgeClassifier</span></pre><figure class="lu lv lw lx fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="fe ff mj"><img src="../Images/03cb2f28602a10650cb8ef18b67a999d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MoICEhuacqcVUDVaDfG1iQ.png"/></div></div></figure><p id="f4bc" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">数据集中有21列。我们这里只保留“文本”和“感悟”这两个栏目。</p><figure class="lu lv lw lx fq iv fe ff paragraph-image"><div class="fe ff mo"><img src="../Images/8270fc82f6461ca7da7377168684c506.png" data-original-src="https://miro.medium.com/v2/resize:fit:1250/format:webp/1*9sIN6sF0n3jgIKmybPRgyw.png"/></div></figure><p id="54d8" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">数据集的形状。我们有13871行记录。</p><figure class="lu lv lw lx fq iv fe ff paragraph-image"><div class="fe ff mp"><img src="../Images/1dd311d8a8ca58da735405a329c4d605.png" data-original-src="https://miro.medium.com/v2/resize:fit:322/format:webp/1*kI1k4mBfSDp8Icoa3z_pOw.png"/></div></figure><p id="02af" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">“情绪”列中有3个唯一值。请注意，数据集是不平衡的，这意味着每个类别的记录数量不相等。</p><figure class="lu lv lw lx fq iv fe ff paragraph-image"><div class="fe ff mq"><img src="../Images/ccf214dca49a0fa5131c98a3c342d576.png" data-original-src="https://miro.medium.com/v2/resize:fit:730/format:webp/1*dCN_H-W5sOoy-_XInD8P-Q.png"/></div></figure><p id="8f68" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">从数据集中随机检查一条推文。</p><figure class="lu lv lw lx fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="fe ff mr"><img src="../Images/3288b2996c860370e644de709e0bb0df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3QpbT1anG1ryL6j8uGkWZA.png"/></div></div></figure></div><div class="ab cl kp kq hc kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="hn ho hp hq hr"><h1 id="02c4" class="kw kx hu bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt dt translated">将数据集分成随机的训练、验证和测试子集</h1><p id="fd4e" class="pw-post-body-paragraph jc jd hu je b jf ms jh ji jj mt jl jm jn mu jp jq jr mv jt ju jv mw jx jy jz hn dt translated">"<a class="ae mx" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html" rel="noopener ugc nofollow" target="_blank"> train_test_split </a>"是scikit-learn中一种方法，将数组或矩阵拆分成随机的训练和测试子集。</p><pre class="lu lv lw lx fq ly lz ma mb aw mc dt"><span id="0763" class="md kx hu lz b fv me mf l mg mh">X_train, X_test, y_train, y_test = train_test_split(df['text'], df['sentiment'], test_size=0.33, random_state=42)</span><span id="681d" class="md kx hu lz b fv mi mf l mg mh">X_train, X_val, y_train, y_val = train_test_split(X_train, y_train, test_size=0.2, random_state=42)</span></pre><p id="8480" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在我们有3个子集:训练、验证和测试。X_train包括推文，y_train包括相应的情绪。</p><figure class="lu lv lw lx fq iv fe ff paragraph-image"><div class="fe ff my"><img src="../Images/cebb26af4442ecb5ba91458e4945fc3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1328/format:webp/1*l7Y_Fxx8V1ZirDjJZWn2gA.png"/></div></figure></div><div class="ab cl kp kq hc kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="hn ho hp hq hr"><h1 id="daa3" class="kw kx hu bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt dt translated">文本预处理</h1><p id="5f72" class="pw-post-body-paragraph jc jd hu je b jf ms jh ji jj mt jl jm jn mu jp jq jr mv jt ju jv mw jx jy jz hn dt translated">为文本预处理定义一个函数text_prepare，该函数处理以下任务:</p><ul class=""><li id="4c21" class="kb kc hu je b jf jg jj jk jn kd jr ke jv kf jz kg kh ki kj dt translated">用输入文本中的空格替换“REPLACE_BY_SPACE_RE”中的符号</li><li id="9dae" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated">从输入文本中删除“错误符号”中的符号</li><li id="9f89" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated">用“rt”和“http”扩展停用词列表</li><li id="52dd" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated">从文本中删除停用词</li></ul><figure class="lu lv lw lx fq iv"><div class="bz el l di"><div class="mz na l"/></div></figure><p id="4bcd" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">按如下方式处理训练数据集中的文本。</p><figure class="lu lv lw lx fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="fe ff nb"><img src="../Images/f1b062e8b237aa5b895c680e2bc11d99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C8nOHqTtvBg5CxDcR_o-FQ.png"/></div></div></figure><p id="4d81" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">应用于验证和测试数据集。</p><figure class="lu lv lw lx fq iv fe ff paragraph-image"><div class="fe ff nc"><img src="../Images/f56263bc82e637835951723c35398460.png" data-original-src="https://miro.medium.com/v2/resize:fit:944/format:webp/1*_V5BOdEsIt9-wmuhNVMCeA.png"/></div></figure><h2 id="44d5" class="md kx hu bd ky nd ne nf lc ng nh ni lg jn nj nk lk jr nl nm lo jv nn no ls np dt translated">最常见的词是什么？</h2><p id="408f" class="pw-post-body-paragraph jc jd hu je b jf ms jh ji jj mt jl jm jn mu jp jq jr mv jt ju jv mw jx jy jz hn dt translated">对于每个单词，计算它们在训练数据集中出现的次数。对词典进行分类，找出前10个常用词。</p><figure class="lu lv lw lx fq iv"><div class="bz el l di"><div class="mz na l"/></div></figure><figure class="lu lv lw lx fq iv fe ff paragraph-image"><div class="fe ff nq"><img src="../Images/ced38072ac6c3b8347db17fe5af2d41b.png" data-original-src="https://miro.medium.com/v2/resize:fit:618/format:webp/1*2CP2si9ImEQKG-QiQtkMaw.png"/></div></figure></div><div class="ab cl kp kq hc kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="hn ho hp hq hr"><h1 id="bbae" class="kw kx hu bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt dt translated">使用TF-IDF嵌入单词</h1><p id="1aad" class="pw-post-body-paragraph jc jd hu je b jf ms jh ji jj mt jl jm jn mu jp jq jr mv jt ju jv mw jx jy jz hn dt translated">机器学习算法处理数字数据，我们不能使用提供的文本数据，如“@JebBush说他削减了190亿美元的FL税”。在将文本数据输入模型之前，我们需要将它们转换成数字向量，这被称为“单词嵌入”。</p><figure class="lu lv lw lx fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="fe ff nr"><img src="../Images/28c48776eb66668604ba745243ae3be9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b-ihDk62niCeS2EKNNZSQg.png"/></div></div><figcaption class="iy iz fg fe ff ja jb bd b be z ek">vectorization</figcaption></figure><h2 id="19eb" class="md kx hu bd ky nd ne nf lc ng nh ni lg jn nj nk lk jr nl nm lo jv nn no ls np dt translated">TF-IDF</h2><p id="32e8" class="pw-post-body-paragraph jc jd hu je b jf ms jh ji jj mt jl jm jn mu jp jq jr mv jt ju jv mw jx jy jz hn dt translated">TF-IDF方法(词频逆文档频率)通过考虑收集的整个tweets数据集中的总词频来扩展词袋框架。与词袋相比，TF-IDF惩罚了过于频繁出现的词，并提供了更好的特征空间。</p><ul class=""><li id="9e34" class="kb kc hu je b jf jg jj jk jn kd jr ke jv kf jz kg kh ki kj dt translated">使用scikit-learn中的类<a class="ae mx" href="https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.TfidfVectorizer.html" rel="noopener ugc nofollow" target="_blank">tfidf矢量器</a></li><li id="c1c9" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated">过滤掉过于罕见的单词(出现次数少于5个标题)</li><li id="c918" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated">过滤掉过于频繁的词(出现在90%以上的推文中)。</li><li id="3aa9" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated">使用2克和1克</li></ul><figure class="lu lv lw lx fq iv"><div class="bz el l di"><div class="mz na l"/></div></figure><p id="64c0" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">文本-&gt;矢量</p><figure class="lu lv lw lx fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="fe ff ns"><img src="../Images/6b3796ce7fc5ccf33cb571858d93a0d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JbyCGlShvzrpoPVYeEbBEg.png"/></div></div></figure></div><div class="ab cl kp kq hc kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="hn ho hp hq hr"><p id="b095" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">最后，我们准备尝试不同的模型。</p><h1 id="a518" class="kw kx hu bd ky kz nt lb lc ld nu lf lg lh nv lj lk ll nw ln lo lp nx lr ls lt dt translated">第一个模型:逻辑回归</h1><p id="60f5" class="pw-post-body-paragraph jc jd hu je b jf ms jh ji jj mt jl jm jn mu jp jq jr mv jt ju jv mw jx jy jz hn dt translated">使用sklearn.linear_model中的LogisticRegression</p><figure class="lu lv lw lx fq iv"><div class="bz el l di"><div class="mz na l"/></div></figure><pre class="lu lv lw lx fq ly lz ma mb aw mc dt"><span id="a80b" class="md kx hu lz b fv me mf l mg mh">LogisticRegression(C=1.0, class_weight=None, dual=False, fit_intercept=True, intercept_scaling=1, max_iter=100, multi_class=’warn’, n_jobs=None, penalty=’l2', random_state=None, solver=’warn’, tol=0.0001, verbose=0, warm_start=False)</span></pre><p id="b1d8" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">交叉验证平均准确率67.86%，标准差0.38。</p><h1 id="a555" class="kw kx hu bd ky kz nt lb lc ld nu lf lg lh nv lj lk ll nw ln lo lp nx lr ls lt dt translated">第二种模式:LinearSVC</h1><p id="5e70" class="pw-post-body-paragraph jc jd hu je b jf ms jh ji jj mt jl jm jn mu jp jq jr mv jt ju jv mw jx jy jz hn dt translated">从sklearn.svm调用LinearSVC</p><figure class="lu lv lw lx fq iv"><div class="bz el l di"><div class="mz na l"/></div></figure><p id="15f3" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">交叉验证平均准确率63.76%，标准差0.45。</p><h1 id="9ca9" class="kw kx hu bd ky kz nt lb lc ld nu lf lg lh nv lj lk ll nw ln lo lp nx lr ls lt dt translated">第三款:OneVsRest</h1><p id="df17" class="pw-post-body-paragraph jc jd hu je b jf ms jh ji jj mt jl jm jn mu jp jq jr mv jt ju jv mw jx jy jz hn dt translated">从sklearn.multiclass调用OneVsRestClassifier</p><figure class="lu lv lw lx fq iv"><div class="bz el l di"><div class="mz na l"/></div></figure><p id="fab5" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">OneVsRestClassifier的评估</p><figure class="lu lv lw lx fq iv"><div class="bz el l di"><div class="mz na l"/></div></figure><figure class="lu lv lw lx fq iv fe ff paragraph-image"><div class="fe ff ny"><img src="../Images/58b5edfff249038f28a36b497052cf6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1214/format:webp/1*mfdwbX35NkVIVB_mYI_BGg.png"/></div></figure><p id="026c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">评估标准的解释可在本<a class="ae mx" href="https://scikit-learn.org/stable/modules/model_evaluation.html" rel="noopener ugc nofollow" target="_blank">文件</a>中找到。F1-micro是首选是首选，因为我们班不平衡。微观和宏观平均值之间的差异可以在这个<a class="ae mx" href="https://datascience.stackexchange.com/questions/15989/micro-average-vs-macro-average-performance-in-a-multiclass-classification-settin" rel="noopener ugc nofollow" target="_blank">环节</a>找到。</p><h1 id="4c54" class="kw kx hu bd ky kz nt lb lc ld nu lf lg lh nv lj lk ll nw ln lo lp nx lr ls lt dt translated">第四款:LSTM与Keras</h1><p id="cd5c" class="pw-post-body-paragraph jc jd hu je b jf ms jh ji jj mt jl jm jn mu jp jq jr mv jt ju jv mw jx jy jz hn dt translated">回想一下，我们之前已经导入了keras库。</p><pre class="lu lv lw lx fq ly lz ma mb aw mc dt"><span id="9ecb" class="md kx hu lz b fv me mf l mg mh"><strong class="lz hv">from</strong> <strong class="lz hv">sklearn.feature_extraction.text</strong> <strong class="lz hv">import</strong> CountVectorizer<br/><strong class="lz hv">from</strong> <strong class="lz hv">keras.preprocessing.text</strong> <strong class="lz hv">import</strong> Tokenizer<br/><strong class="lz hv">from</strong> <strong class="lz hv">keras.preprocessing.sequence</strong> <strong class="lz hv">import</strong> pad_sequences<br/><strong class="lz hv">from</strong> <strong class="lz hv">keras.models</strong> <strong class="lz hv">import</strong> Sequential<br/><strong class="lz hv">from</strong> <strong class="lz hv">keras.layers</strong> <strong class="lz hv">import</strong> Dense, Embedding, LSTM, SpatialDropout1D<br/><strong class="lz hv">from</strong> <strong class="lz hv">keras.utils.np_utils</strong> <strong class="lz hv">import</strong> to_categorical</span></pre><p id="f615" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">将文本预处理的输出保存在另一个pandas数据框“X”中。</p><figure class="lu lv lw lx fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="fe ff nz"><img src="../Images/3464b3f54ac112f0b7756ee0ce0682a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aTUyD2oL66msndg6nOr9NA.png"/></div></div></figure><figure class="lu lv lw lx fq iv"><div class="bz el l di"><div class="mz na l"/></div></figure><p id="3b71" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">使用keras的Tokenizer</p><figure class="lu lv lw lx fq iv"><div class="bz el l di"><div class="mz na l"/></div></figure><figure class="lu lv lw lx fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="fe ff oa"><img src="../Images/bc29de4b16f92d0fe77eee8679b763d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*__812GlukQSS5QDonz_72A.png"/></div></div></figure><p id="046b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">创建LSTM模型</p><p id="24a1" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">注意激活函数和优化器adam。</p><figure class="lu lv lw lx fq iv"><div class="bz el l di"><div class="mz na l"/></div></figure><figure class="lu lv lw lx fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="fe ff ob"><img src="../Images/fb3027351520ed183a15bfaad2403de7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*khQMYDyiqX5mGAVaCYAeNA.png"/></div></div></figure><p id="818b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">对预测列“情绪”进行编码(正面、中性、负面)</p><figure class="lu lv lw lx fq iv fe ff paragraph-image"><div class="fe ff oc"><img src="../Images/76a7f7b065bafec022e64503686368cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:958/format:webp/1*OwUgkl6VzoIsCtqFEb-bDA.png"/></div></figure><p id="7a67" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">为20个时代训练LSTM模型</p><figure class="lu lv lw lx fq iv"><div class="bz el l di"><div class="mz na l"/></div></figure><figure class="lu lv lw lx fq iv fe ff paragraph-image"><div class="fe ff od"><img src="../Images/358251dad1774a2aa4802bdfd1367cad.png" data-original-src="https://miro.medium.com/v2/resize:fit:694/format:webp/1*Vr6JuHGGLy-gOLMWBFIaBA.png"/></div></figure></div><div class="ab cl kp kq hc kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="hn ho hp hq hr"><p id="5147" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">恭喜你。您刚刚学习了自然语言处理的基本技术，包括:</p><ul class=""><li id="c13b" class="kb kc hu je b jf jg jj jk jn kd jr ke jv kf jz kg kh ki kj dt translated">文本预处理</li><li id="e51f" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated">标记化</li><li id="5ac5" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated">使用TF-IDF嵌入单词</li><li id="9cdd" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated">用LSTM、逻辑回归、OneVsRest、LinearSVC等建模。</li><li id="bd86" class="kb kc hu je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated">使用F1分数、精确度、召回率、准确度进行评估</li></ul><p id="0530" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">本项目使用的数据来源可以在这个<a class="ae mx" href="https://www.kaggle.com/crowdflower/first-gop-debate-twitter-sentiment#Sentiment.csv" rel="noopener ugc nofollow" target="_blank">链接</a>找到。</p><p id="8c43" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">NLP项目的<strong class="je hv">路线图可以在这个<a class="ae mx" href="https://drive.google.com/file/d/17-3G1W-Ag1Ql-CI_VGDIk9YxiXzAZm8Z/view?usp=sharing" rel="noopener ugc nofollow" target="_blank">链接</a>下载。</strong></p><p id="947d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">下一步就是和猫玩，弄脏你的手。不，我是说编码。祝你好运。</p><figure class="lu lv lw lx fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="fe ff oe"><img src="../Images/8490dea8b7431e8178afd655d81da685.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0oz7bsYEIQXyL3qXE3iFfQ@2x.jpeg"/></div></div><figcaption class="iy iz fg fe ff ja jb bd b be z ek">Sentiment Analysis on Lourdes (my cat)</figcaption></figure></div></div>    
</body>
</html>