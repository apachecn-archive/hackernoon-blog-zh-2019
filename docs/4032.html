<html>
<head>
<title>Hooking up an AI pipeline to a Word document in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python将人工智能管道连接到Word文档</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/hooking-up-an-ai-pipeline-to-a-word-document-in-python-162d1fe7d5ef?source=collection_archive---------6-----------------------#2019-07-07">https://medium.com/hackernoon/hooking-up-an-ai-pipeline-to-a-word-document-in-python-162d1fe7d5ef?source=collection_archive---------6-----------------------#2019-07-07</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/f448a43815a62c5c2e190737892ecf5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xbf5Yod_P7MQD-ygzuQ2zg.png"/></div></div></figure><p id="88ff" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在这里，我将向您展示如何在web浏览器中可视化Word文档中的合同信息。</p><p id="9949" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">对于上下文，假设您有一个处理Word或PDF文档的AI管道。也许它们是法律文件；或许是合同。</p><blockquote class="ka kb kc"><p id="3dcb" class="jc jd kd je b jf jg jh ji jj jk jl jm ke jo jp jq kf js jt ju kg jw jx jy jz hn dt translated">如何将结果呈现给人类用户？</p></blockquote><p id="28bd" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这是一个关键的面向客户的UI设计选择，当然:-你的客户如何与你的产品互动？用起来是一种享受吗？文档看起来像在Word中一样吗？</p><p id="e263" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">但是文档可视化在任何初始人工智能训练阶段和在线学习中同样重要。</p><p id="4594" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在初始训练阶段，您需要准备训练数据集。你能让这个变得多简单？然后，当你评估结果时，同样的问题:QA能容易地看出人工智能得到的是对的还是错的吗？</p><p id="5399" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在<a class="ae kh" href="https://nativedocuments.com/" rel="noopener ugc nofollow" target="_blank"> Native Documents </a>中，我们已经构建了一个API，使您可以轻松地在web应用程序中显示Word文档的结果。在本文中，我们将演示与<a class="ae kh" href="https://github.com/LexPredict/lexpredict-lexnlp" rel="noopener ugc nofollow" target="_blank"> LexNLP </a>的交互，这是我们所知的唯一一个为处理法律文本而设计的开源NLP库。</p><p id="3c4b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">一般模式如下:</p><ul class=""><li id="59b1" class="ki kj hu je b jf jg jj jk jn kk jr kl jv km jz kn ko kp kq dt translated">获取文本或富文本形式的文档</li><li id="3836" class="ki kj hu je b jf kr jj ks jn kt jr ku jv kv jz kn ko kp kq dt translated">让它通过你的NLP管道</li><li id="eb1e" class="ki kj hu je b jf kr jj ks jn kt jr ku jv kv jz kn ko kp kq dt translated">使用我们的ranges API用NLP结果注释文档。结果将显示为文字注释</li></ul><figure class="kx ky kz la fq iv fe ff paragraph-image"><div class="fe ff kw"><img src="../Images/2cd03b11dd943b1acf9e0527397d2ec1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1378/format:webp/1*N-6qCSWcidFb4YDInomolw.png"/></div></figure><ul class=""><li id="aa3c" class="ki kj hu je b jf jg jj jk jn kk jr kl jv km jz kn ko kp kq dt translated">或者，将任何自定义用户操作附加到注释中(如接受、拒绝、标记/争议)</li><li id="7fbd" class="ki kj hu je b jf kr jj ks jn kt jr ku jv kv jz kn ko kp kq dt translated">或者，导出为Word注释</li></ul><blockquote class="ka kb kc"><p id="b272" class="jc jd kd je b jf jg jh ji jj jk jl jm ke jo jp jq kf js jt ju kg jw jx jy jz hn dt translated">我们能用它做什么？</p></blockquote><p id="98fd" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在法律领域有很多人工智能的应用。这些包括人工智能辅助的合同起草、审查和谈判。在合同签署之前，您通常需要能够编辑它，这意味着您需要一个Word格式的文档，而不是PDF。</p><p id="6817" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在这里，我们将通过一个“实体提取”的例子。</p><p id="f49c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">实体是文档中感兴趣的项目。例如，交易方名称或日期:如果您要将合同纳入合同管理系统，或者清除敏感信息，您需要查找这些内容。</p><blockquote class="ka kb kc"><p id="a6e1" class="jc jd kd je b jf jg jh ji jj jk jl jm ke jo jp jq kf js jt ju kg jw jx jy jz hn dt translated">输入LexNLP</p></blockquote><p id="8c52" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在这里，我们将使用<a class="ae kh" href="https://lexpredict-lexnlp.readthedocs.io/en/latest/modules/extract/en/definitions.html#extract-en-definitions" rel="noopener ugc nofollow" target="_blank"> LexNLP的定义提取</a>功能:如果您想要实现合同起草助手功能以及知识管理/先例搜索应用程序，定义是有用的。</p><h1 id="94d7" class="lb lc hu bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly dt translated">准备</h1><p id="42b4" class="pw-post-body-paragraph jc jd hu je b jf lz jh ji jj ma jl jm jn mb jp jq jr mc jt ju jv md jx jy jz hn dt translated">我假设您已经安装了一个功能性的Python。</p><p id="887d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">要跟进，您需要一个本地文档dev id和secret。在<a class="ae kh" href="https://developers.nativedocuments.com/" rel="noopener ugc nofollow" target="_blank">https://developers.nativedocuments.com/</a>买票</p><p id="3494" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">然后访问https://canary.nativedocuments.com的T2，输入你的开发者id和密码。(有几种方法可以处理您的dev id和secret，但就本演练而言，这是最简单的。在生产中，你可以把它编译成你的Javascript。)</p><p id="cc1a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">接下来，获取/安装我们的python工具:</p><pre class="kx ky kz la fq me mf mg mh aw mi dt"><span id="ef24" class="mj lc hu mf b fv mk ml l mm mn">pip install — upgrade <a class="ae kh" href="http://downloads.nativedocuments.com/python/ndapi.tar.gz" rel="noopener ugc nofollow" target="_blank">http://downloads.nativedocuments.com/python/ndapi.tar.gz</a></span></pre><p id="a773" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在Windows上，创建C:\Users\name\。ndapi\config.default-config并在Linux/Mac上创建~/。ndapi/config.default-config</p><p id="92f3" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">config.default-config文件应该具有以下形式:</p><pre class="kx ky kz la fq me mf mg mh aw mi dt"><span id="d426" class="mj lc hu mf b fv mk ml l mm mn">{<br/> “dev_id”: “YOUR DEV ID GOES HERE”,<br/> “dev_secret”: “YOUR DEV SECRET GOES HERE”,<br/> “service_url”: “<a class="ae kh" href="https://canary.nativedocuments.com" rel="noopener ugc nofollow" target="_blank">https://canary.nativedocuments.com</a>",<br/> “api_ver”: “DEV” <br/>}</span></pre><p id="9a0a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这就是原生文档配置完成。</p><p id="7a43" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">接下来，安装LexNLP，类似于:</p><pre class="kx ky kz la fq me mf mg mh aw mi dt"><span id="931a" class="mj lc hu mf b fv mk ml l mm mn">git clone <a class="ae kh" href="https://github.com/LexPredict/lexpredict-lexnlp.git" rel="noopener ugc nofollow" target="_blank">https://github.com/LexPredict/lexpredict-lexnlp.git</a><br/>cd lexpredict-lexnlp<br/>python setup.py install</span></pre><p id="7cd0" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在，您可以检查一切是否正常:</p><pre class="kx ky kz la fq me mf mg mh aw mi dt"><span id="9371" class="mj lc hu mf b fv mk ml l mm mn">wget <a class="ae kh" href="http://downloads.nativedocuments.com/python/extractDefinitions.py" rel="noopener ugc nofollow" target="_blank">http://downloads.nativedocuments.com/python/extractDefinitions.py</a><br/>python<br/>exec(open(“extractDefinitions.py”).read())<br/>extractDefs(“default-config”, “<a class="ae kh" href="https://www.ycombinator.com/docs/YC_Form_SaaS_Agreement.doc" rel="noopener ugc nofollow" target="_blank">https://www.ycombinator.com/docs/YC_Form_SaaS_Agreement.doc</a>")</span></pre><p id="61e5" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果你在Chrome中加载结果URL，你应该在那个文档中标识出其中的定义。如果您没有看到文档或定义，请在下面或在https://helpdesk.nativedocuments.com/<a class="ae kh" href="https://helpdesk.nativedocuments.com/" rel="noopener ugc nofollow" target="_blank">发表评论</a></p><p id="e75e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">接下来，我们将回顾刚刚发生的事情。</p><p id="6d5f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">为此，首先您需要一个示例文档(Word。多克还是。docx格式)。我们将假设您使用了YC _表单_ SaaS _协议. doc</p><h1 id="92b9" class="lb lc hu bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly dt translated">概观</h1><p id="fe2d" class="pw-post-body-paragraph jc jd hu je b jf lz jh ji jj ma jl jm jn mb jp jq jr mc jt ju jv md jx jy jz hn dt translated">概括一下，我们需要做的是:</p><ul class=""><li id="f2aa" class="ki kj hu je b jf jg jj jk jn kk jr kl jv km jz kn ko kp kq dt translated">将文档加载到本机文档中并导出为文本</li><li id="4d00" class="ki kj hu je b jf kr jj ks jn kt jr ku jv kv jz kn ko kp kq dt translated">获取感兴趣的项目(使用NLP)</li><li id="f93e" class="ki kj hu je b jf kr jj ks jn kt jr ku jv kv jz kn ko kp kq dt translated">创建注释说明</li></ul><p id="891c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">然后，您可以可视化结果，和/或以docx的形式获得结果。</p><h1 id="8d3f" class="lb lc hu bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly dt translated">步骤1:加载文档</h1><pre class="kx ky kz la fq me mf mg mh aw mi dt"><span id="1893" class="mj lc hu mf b fv mk ml l mm mn">$ python<br/>Python 3.6.8 (default, Jun 1 2019, 16:00:10) <br/>&gt;&gt;&gt; import ndapi<br/>&gt;&gt;&gt; ndapi.init(user=”default-config”)<br/>True<br/>&gt;&gt;&gt; mydocx=open(“./YC_Form_SaaS_Agreement.doc”,”rb”)<br/>&gt;&gt;&gt; sessionInfo = ndapi.upload_document_to_service(mydocx)<br/>&gt;&gt;&gt; print(sessionInfo)<br/>{‘nid’: ‘DEV7BDVM9BGGAIMAUI487AB49QUQS000000000000000000000000002I0THD1D829MQUI4EVGNMFDM860000’, ‘author’: ‘eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJuYW1lIjoiTmF0aXZlIERvY3VtZW50cyIsIm5pY2tuYW1lIjoibmQifQ.tN0R0W3YjpwjnFBUmAj8dxfEMRtcNsXA677QcDtHb2s’, ‘rid’: ‘I2522’}</span></pre><p id="a1ad" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">注意<strong class="je hv"> nid </strong>。这就是我们与文档交互所需要的。</p><pre class="kx ky kz la fq me mf mg mh aw mi dt"><span id="e173" class="mj lc hu mf b fv mk ml l mm mn">&gt;&gt;&gt; nid=sessionInfo[‘nid’]</span></pre><p id="0b1c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">旁白:此时你可以在我们的编辑器中查看你的文档。</p><p id="e831" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这里有一个小函数来计算打开文档的URL。</p><pre class="kx ky kz la fq me mf mg mh aw mi dt"><span id="3b4c" class="mj lc hu mf b fv mk ml l mm mn">def printEditUrl(nid, author):<br/> print( “<a class="ae kh" href="https://canary.nativedocuments.com/edit/" rel="noopener ugc nofollow" target="_blank">https://canary.nativedocuments.com/edit/</a>" + nid + “?author=” + author)</span></pre><p id="6c39" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">要获取URL:</p><pre class="kx ky kz la fq me mf mg mh aw mi dt"><span id="95fb" class="mj lc hu mf b fv mk ml l mm mn">printEditUrl(sessionInfo[‘nid’],sessionInfo[‘author’])</span></pre><p id="b10e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果您想查看文档，请打开该URL。</p><p id="6d1e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">没起作用？你访问过https://canary.nativedocuments.com并输入了你的开发者id和秘密吗？</p><h1 id="6c8c" class="lb lc hu bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly dt translated">步骤2:导出为纯文本</h1><p id="7984" class="pw-post-body-paragraph jc jd hu je b jf lz jh ji jj ma jl jm jn mb jp jq jr mc jt ju jv md jx jy jz hn dt translated">像大多数NLP/AI一样，LexNLP消耗纯文本。所以让我们开始吧。</p><pre class="kx ky kz la fq me mf mg mh aw mi dt"><span id="24fd" class="mj lc hu mf b fv mk ml l mm mn">&gt;&gt;&gt; ndRawText = ndapi.download_document_from_service(nid, mime_type=”application/vnd.nativedocuments.raw.text+text”) <br/> <br/>&gt;&gt;&gt; print(ndRawText.data)<br/>b”urn:nd:stream:5591RH3HVNOMMJM0LOH9DIDRTENGG00000…Jf0seo4p6vv-sf\nSAAS SERVICES ORDER FORM\nCustomer:\t\t\nContact: \nAddress:\nPhone: \n \nE-Mail: \n\nServices: [Name and briefly describe services here]</span></pre><p id="c41f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">您可以看到结果由流头和文档文本组成，由换行符分隔。</p><p id="6bf1" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">让我们暂时把标题放在一边。</p><pre class="kx ky kz la fq me mf mg mh aw mi dt"><span id="78bd" class="mj lc hu mf b fv mk ml l mm mn">splits = ndRawText.data.decode().split(‘\n’,1)</span></pre><h1 id="a172" class="lb lc hu bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly dt translated">第三步:与NLP交谈</h1><p id="5f9c" class="pw-post-body-paragraph jc jd hu je b jf lz jh ji jj ma jl jm jn mb jp jq jr mc jt ju jv md jx jy jz hn dt translated">在这里，我们与LexNLP对话以获得定义:</p><pre class="kx ky kz la fq me mf mg mh aw mi dt"><span id="5dcc" class="mj lc hu mf b fv mk ml l mm mn">import lexnlp.extract.en.definitions</span><span id="6f6c" class="mj lc hu mf b fv mo ml l mm mn">print(list(lexnlp.extract.en.definitions.get_definitions_explicit(splits[1])))</span><span id="eb8b" class="mj lc hu mf b fv mo ml l mm mn">[(‘Service(s)’, ‘Services: [Name and briefly describe services here] ___________ (the “Service(s)”).’, (140, 158)),<br/>:<br/>(‘Support Hours’, ‘EXHIBIT C\nSupport Terms\n[OPTIONAL]\nCompany will provide Technical Support to Customer via both telephone and electronic mail on weekdays during the hours of 9:00 am through 5:00 pm Pacific time, with the exclusion of Federal Holidays (“Support Hours”).’, (22449, 22466))]</span></pre><p id="437d" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">对于LexNLP找到的每个定义，您可以看到它返回定义的术语、含义以及找到定义的术语的字符范围。</p><p id="446f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们只是重复使用字符范围来告诉本机文档在哪里附加注释。</p><h1 id="bedb" class="lb lc hu bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly dt translated">步骤4:将NLP响应转换为注释指令</h1><p id="60a5" class="pw-post-body-paragraph jc jd hu je b jf lz jh ji jj ma jl jm jn mb jp jq jr mc jt ju jv md jx jy jz hn dt translated">为了让原生文档显示注释，我们需要向它发送以下形式的JSON:</p><pre class="kx ky kz la fq me mf mg mh aw mi dt"><span id="f9a4" class="mj lc hu mf b fv mk ml l mm mn">urn:nd:stream:5591RH3HVNOMMJM0LOH9DIDRTENGG00000…Jf0seo4p6vv-sf <br/>“[140..157):0.MEANING”: { “meaning”: “Services: [Name and briefly describe services here].. (the Service(s))”}<br/>:<br/>“[22449..22465):17.MEANING”: { “meaning”: “EXHIBIT C Support Terms [OPTIONAL] Company will provide.. Holidays (Support Hours)”}</span></pre><p id="9606" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">为此，让我们使用几个辅助函数:</p><pre class="kx ky kz la fq me mf mg mh aw mi dt"><span id="7175" class="mj lc hu mf b fv mk ml l mm mn">class ndComment:<br/> def __init__(self, start, end, slot, mng, content):<br/>   self.start = start<br/>   self.end = end<br/>   self.slot = slot<br/>   self.mng = mng<br/>   self.content = content.replace(‘\n’, ‘ ‘)<br/>   self.content = self.content.replace(‘\t’, ‘ ‘)<br/>   self.content = self.content.replace(‘\”’, ‘’)<br/> def toString(self):<br/>   return “\”[“ + str(self.start) + “..” + str(self.end) + “):” + str(self.slot) + “.” + self.mng + “\”: { \”meaning\”: \”” + str(self.content) + “\”} \n”</span><span id="1b88" class="mj lc hu mf b fv mo ml l mm mn">def constructPayload():<br/> definitions=lexnlp.extract.en.definitions.get_definitions_explicit(splits[1])<br/> results = [ndComment(d[2][0], d[2][1]-1,ind, “MEANING”, d[1]).toString() for ind, d in enumerate(definitions)] <br/> payload=splits[0]+”\n”+’’.join([‘’.join(result) for result in results]) <br/> return payload</span></pre><p id="70ed" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在，我们可以使用它将注释附加到文档:</p><pre class="kx ky kz la fq me mf mg mh aw mi dt"><span id="15a4" class="mj lc hu mf b fv mk ml l mm mn">annotations = constructPayload()<br/>ndapi.upload_document_to_service(annotations, “ranges”, nid=nid, mime_type=”application/vnd.nativedocuments.raw.text+text”)</span></pre><h1 id="6f9d" class="lb lc hu bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly dt translated">可视化注释文档</h1><p id="2e99" class="pw-post-body-paragraph jc jd hu je b jf lz jh ji jj ma jl jm jn mb jp jq jr mc jt ju jv md jx jy jz hn dt translated">现在让我们看看编辑器中的文档。</p><p id="d82f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">首先，请访问<a class="ae kh" href="https://canary.nativedocuments.com" rel="noopener ugc nofollow" target="_blank">https://canary.nativedocuments.com</a>如果你还没有，然后输入你的开发密钥和秘密。</p><p id="3382" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这样做之后，你就可以打开网址了。要获取要加载的URL:</p><pre class="kx ky kz la fq me mf mg mh aw mi dt"><span id="9b62" class="mj lc hu mf b fv mk ml l mm mn">printEditUrl(sessionInfo[‘nid’],sessionInfo[‘author’])</span></pre><p id="5fa1" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果你在Chrome中查看它，你可能会注意到注释中的一点调试；在后续文章中，我将向您展示如何定制注释批注的外观。</p><h1 id="3905" class="lb lc hu bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly dt translated">把所有的放在一起</h1><p id="4347" class="pw-post-body-paragraph jc jd hu je b jf lz jh ji jj ma jl jm jn mb jp jq jr mc jt ju jv md jx jy jz hn dt translated">你可以在<a class="ae kh" href="http://downloads.nativedocuments.com/python/extractDefinitions.py" rel="noopener ugc nofollow" target="_blank">http://downloads . native documents . com/python/extract definitions . py</a>找到代码</p><p id="372a" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">它包含一个函数extractDefs，该函数接受两个参数。ndapi/config(如“config-default”)，以及Word文档的路径或URL(doc或docx)。例如:</p><pre class="kx ky kz la fq me mf mg mh aw mi dt"><span id="23f4" class="mj lc hu mf b fv mk ml l mm mn">python<br/>exec(open(“extractDefinitions.py”).read())<br/>extractDefs(“default-config”, “<a class="ae kh" href="https://www.ycombinator.com/docs/YC_Form_SaaS_Agreement.doc" rel="noopener ugc nofollow" target="_blank">https://www.ycombinator.com/docs/YC_Form_SaaS_Agreement.doc</a>")</span></pre><p id="3362" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">它返回一个您可以在web浏览器中打开的URL。使与同事共享工作URL变得容易(但不是为了生产！)，URL包含devid作为参数。</p><p id="671b" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">您可以修改它来提取LexNLP支持的其他信息，或者完全替换其他NLP引擎。</p><p id="1291" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">欢迎反馈和评论。</p></div></div>    
</body>
</html>