# 所以你现在想用 Next.js 和 ZEIT 构建一个无服务器的 React 应用

> 原文：<https://medium.com/hackernoon/so-you-want-to-build-a-serverless-react-app-with-next-js-and-zeit-now-eedb01dfef28>

![](img/efcb5e5d235307202e8247cc49599bd8.png)

Photo by [imgix](https://unsplash.com/photos/klWUhr-wPJ8?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) on [Unsplash](https://unsplash.com/search/photos/data-center?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)

假设你正在开始你的下一个项目，这经常被忽视，但是部署是你应该尽早考虑的事情。在今天这个时代，无服务器是一个很好的选择，你应该考虑。在本文中，我们将讨论无服务器的利弊，然后我们将使用 Next.js 快速构建一个 React 应用程序，并使用 ZEIT Now 部署它。

# 概观

1.简介
2。Setup Next.js
3。现在设置 ZEIT
4。结论
5。从哪里了解更多信息？

# 1 —简介

如果你听说过“专注于你的业务逻辑”这句话，你就已经理解了无服务器的好处。**大多数尝试无服务器的开发者都有一个相对无压力的体验，但有些人没有，他们感到沮丧(继续阅读简介**👇 **)** 。事实上，构建 web 或移动应用程序比以往任何时候都更容易，无服务器使它变得更容易，但它并不适用于每个人。

![](img/1a5d4f015bb2f10d8a0471e3482d2e6e.png)

Serverless — focus on your business logic!

首先，让我们意识到并同意“无服务器”是一个糟糕的定义。无服务器仍然涉及服务器，你只是不管理它们。我们过去称之为前端驱动的应用程序被贴上了“无服务器”的标签。当我们谈论“堆栈”时，我们不再谈论操作系统、特定的 web 服务器、后端编程语言或数据库，因为前端变得越来越强大。我们现在可以构建前端应用程序，而不会有拥有基础架构的痛苦——这是无服务器的主要目的。如果你有兴趣，可以在这里阅读更多关于大意[的内容。](https://jamstack.org/)

## 利弊

那么，为什么或者为什么不选择无服务器？好吧，你很幸运，因为我使用无服务器构建了我的辅助项目([reactanywhere.co](https://reactanywhere.co/))来发现利弊。事实上，副业项目是试验无服务器技术的完美用例，我强烈推荐这种技术。

**认识到这一点很重要，我不是建议你为你构建的每个应用程序都使用无服务器。**为什么？像大多数东西一样，无服务器也有一些缺点和限制，在你使用它之前，你需要了解这些。

让我们来谈谈为什么您会想要使用无服务器基础架构:

*   你是一个**前端开发者**(和我一样！[👋](https://emojipedia.org/waving-hand-sign/))谁想关注前端
*   你是一个企业家(像我一样！)谁想关注客户价值、业务逻辑并快速检验你的想法
*   你不想处理服务器基础设施(像我一样！)并将你的时间和金钱投入到服务器“东西”上
*   你正在建立**一个** **副业**(像我一样！)或者是一家初创公司，你正在学习很多东西，需要尝试一些新东西
*   你在构建**一个** **简单的应用**(像我一样！)这不涉及长时间运行的线程
*   你正在**快速成型**某事(像我一样！)这是实验性的，代码可能会被重写
*   你是**小团队**(和我一样！)雇不起很多人的人
*   你喜欢免费拿东西**(像我！)例如全球部署、维护和扩展**
*   **而且一般你要把重点放在**前端**(像我！)**

**现在，我们来谈谈为什么您不想使用无服务器基础架构:**

*   **你正在用长时间运行的线程(如人工智能、图像处理等)构建一个复杂的应用程序。)或者将来可能需要它**
*   **你不能在尖端技术上冒任何风险**
*   **您的组织中已经有一个后端和/或服务器团队可以提供帮助**
*   **贵公司的大多数成员从未尝试过无服务器**
*   **你不喜欢被锁在像供应商这样的东西里**
*   **你不会幻想所有的后端和服务器工程师都给你让路**
*   **你不喜欢新技术**
*   **你不喜欢对你不完全了解的事情进行故障排除**
*   **你喜欢完全控制一切，想要了解一切是如何运作的**

**因此，在您开始使用无服务器基础架构之前，有很多事情需要考虑！我强烈建议你认真考虑这些事情。总的来说，我认为无服务器非常适合定义明确的用例、有活力的初创公司、前端工程师和/或副业项目。如果其中一个或多个描述了你，那么无服务器**可能**有意义，你可以扔掉你的服务器基础设施(见下面的 GIF)。然而，如果无服务器不适合您的用例，那将会非常令人沮丧。**

**![](img/09cf5c76fd66a75f5f86c50b7fc45d12.png)**

**Serverless-throw away your server infrastructure!**

## **收益和成本**

**不幸的是，直到你掉进兔子洞，才知道无服务器是否适合你的用例。[肯特·c·多兹](https://twitter.com/kentcdodds)T20 说得好:**

> **注意你的抽象。普遍的事实是，你越了解你的抽象，你就越能有效地使用它。每一个抽象都有成本。**

**所以，你必须问自己两个非常重要的问题:这个抽象的好处是什么？这种抽象的代价是什么？在您理解这些问题之前，无服务器对您的使用案例可能有益，也可能无益。然而，这有点自相矛盾，因为你需要使用无服务器才能理解它的成本和好处(但希望我能帮上忙)。**

**让我们试着理解无服务器的好处:**

*   **从无到有的服务器基础设施**
*   **没有维护**
*   **没有服务器或开发运营团队**
*   **免费的全球部署和扩展**
*   **您很少使用您的服务器基础设施**

**现在，让我们了解一下无服务器的成本:**

*   **依赖于供应商**
*   **当服务器不工作时，很难理解它为什么不工作**
*   **受限于它的能力**
*   **你很少使用你的服务器基础设施，所以你没有时间去完全理解它**

**啊哈！我们再次面临不明确的选择。因此，对于无服务器是否适合您的使用情形，没有一个通用的答案。这将是基于个案的基础上。尽管如此，我的一般建议是像我一样在一个副业项目上尝试一下，以便更好地理解“无服务器抽象”！**

# **2-Setup next . js**

**如果你已经读到这里，你已经阅读了介绍，并准备尝试构建一个无服务器的 [React](https://reactjs.org/) 应用程序。您了解无服务器的利弊以及它的好处和成本。如果没有，你应该回去看看引言，因为这是这篇博文的主要价值。另外，如果你迷路了，我已经用我的代码建立了一个 Github [库](https://github.com/watadarkstar/article-serverless-zeit)。**

**好了，说够了，让我们来设置你的无服务器 React 应用程序。这样做的先决条件是您已经安装了 [npm](https://www.npmjs.com/get-npm) 。**

## **第一步**

**首先，在终端中为所有代码创建一个目录。对于这个例子，我们称之为`article-serverless-zeit`:**

```
mkdir article-serverless-zeit
cd article-serverless-zeit
```

## **第二步**

**接下来(双关语),我们像这样初始化一个 npm 项目:**

```
npm init -y
```

## **第三步**

**并安装 React 和 [Next.js](https://nextjs.org) :**

```
npm install --save next react react-dom
```

## **第四步**

**向 package.json 添加一个脚本，如下所示:**

```
{
  **"scripts"**: {
    **"dev"**: "next",
    **"build"**: "next build",
    **"start"**: "next start"
  }
}
```

## **第五步**

**之后，文件系统是主要的 API。每一个`.js`文件都变成了自动处理和渲染的路径。**

**因此，在您的项目中创建一个名为`./pages/index.js`的文件，并用以下内容填充它:**

```
**function** Home() {
  **return** <div>Welcome to Next.js!</div>;
}

**export** **default** Home;
```

**然后简单地运行`npm run dev`，进入`[http://localhost:3000](http://localhost:3000.)` [。哇，这太简单了！](http://localhost:3000.)**

# **3 —立即设置 ZEIT**

**接下来，让我们使用 [ZEIT Now](https://zeit.co/now) 部署 React 应用程序，这使得部署无服务器应用程序变得容易。**

## **第一步**

**首先，使用 npm 安装 now CLI:**

```
npm i -g now
```

## **第二步**

**像这样完成登录后(如果你没有账户，在这里创建一个[):](https://zeit.co/signup)**

```
now login
```

## **第三步**

**创建一个名为`./next.config.js`的文件作为构建的入口点，并配置构建应该是一个无服务器的集合:**

```
module.exports = {
  target: 'serverless'
}
```

## **第四步**

**然后在一个`./now.json`配置文件中定义一个构建步骤:**

```
{
  **"version"**: 2,
  **"builds"**: [{ **"src"**: "next.config.js", **"use"**: "@now/next" }]
}
```

## **第五步**

**建议添加一个`.nowignore`以避免问题并加快上传速度:**

```
.next
node_modules
```

## **第六步**

**我们终于可以部署了！像这样:**

```
now
```

**一旦完成，你会在你的终端中得到一个链接(就像[这个](https://article-serverless-zeit.adriancaarolli.now.sh/))，就这样。哇，这是有史以来最简单的部署！**

**![](img/c879f769c60410544d56901ebae73e65.png)**

# **4 —结论**

**我希望这个指南能帮助你决定无服务器是否适合你，并帮助你设置你的无服务器 React 应用。如果你想更进一步，我鼓励你阅读 [Next.js](https://nextjs.org/docs) 和 ZEIT [Now](https://zeit.co/docs) 文档。**

# **5 —向谁寻求帮助**

*   **如果您对 ZEIT Now 和 Next.js 有任何疑问，请在 ZEIT [chat](https://zeit.co/chat) 社区发表您的问题。**
*   **最后，在 [Twitter](https://twitter.com/icookandcode) 上关注我，如果有任何问题，发微博或发短信给我。我倾向于在 Twitter 上非常活跃。**

**期待更多关于无服务器的文章？在 Twitter 上关注我们的客座博主 Adrian Carolli，了解最新动态。他在 [G2i](https://www.g2i.co/) 担任 React 开发人员，这是一个由工程师运营的招聘平台，为你匹配预先审查过的 React、React Native、GraphQL 和原生 iOS/Android 工程师，你可以信任他们。**