<html>
<head>
<title>Composing Contracts without Special Provisions — using Blockchain History</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在没有特殊条款的情况下制定合同——使用区块链历史</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/composing-contracts-without-special-provisions-using-blockchain-history-66b588e25891?source=collection_archive---------23-----------------------#2019-04-26">https://medium.com/hackernoon/composing-contracts-without-special-provisions-using-blockchain-history-66b588e25891?source=collection_archive---------23-----------------------#2019-04-26</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div class="fe ff ir"><img src="../Images/7bbe79e61dab0b9fa263ac89e64ec418.png" data-original-src="https://miro.medium.com/v2/resize:fit:948/format:webp/1*SsG6YYKiJQVLixfsYWlVZA.jpeg"/></div></figure><p id="ae0d" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">在大多数现存的区块链中，我非常怀念的一个功能是从其合同语言中验证区块链的历史的能力。为什么这样因为这一特性在出现时使得合同的组合变得容易，而不需要被组合的合同必须提供专用的API来促进这种组合，例如ERC20合同的笨拙的“津贴”。</p><p id="60d8" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">事实上，得益于对区块链历史的了解，我们不仅可以签订原本不应该签订的合同，甚至还可以签订与更大范围的合同没有直接关系的其他方的合同——无论你是不想让他们参与进来，还是他们拒绝让你的生活变得轻松。甚至有可能以一种私有的方式组成契约，除了它的直接参与者之外，没有人需要知道组成的契约的细节。</p><p id="031f" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">让我们假设有人写了一些很酷的合同来管理有趣的资产，比如说可爱的蜥蜴、<a class="ae jx" rel="noopener" href="/alacris/cryptoscalies-cute-lizards-at-scale-5ac34e6cc2af">密码员</a>，还有人写了另一个很酷的合同，这样你的密码员就可以穿t恤了。现在让我们假设我想和你签署一份赞助合同，我将支付你，这样你著名的蜥蜴鳞片卡达西人将在下个月穿上一件“为博格投票”的t恤。不过，有一个问题:无论是密码合约还是t恤合约，都没有任何条款可以促进这种安排。一些其他的义务甚至可能阻止你放弃对你的密码系统的控制，即使是暂时的，到一个合同，否则我们可能已经写了实现安排。我们怎样才能执行这份赞助合同呢？</p><p id="24a6" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">有了历史记录，我们可以用以下条款写一份合同:“如果在你的蜥蜴穿上t恤的那个月开始之前发布了一个事件，而在那之后直到月底都没有发布任何事件，这导致t恤被移除或覆盖——那么我将向你支付召集赞助奖励，在此之前该奖励在这份合同中托管。”我可以想象赞助合同中的其他条件，但让我们专注于我们将如何解决任何关于你是否履行我们交易的这一部分的潜在争议。</p><p id="b708" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">只要我们双方都同意结果，我们可以简单地签署一份共同协议，将托管资金分配给应得的一方。但是如果我们不同意呢？尽管你尽了自己的一份力，但如果我拒绝付给你钱怎么办？或者，如果你要求付款，即使你没有？这件事将如何解决？一个由区块链共识的“智能合约”自动执行的公正法官，如何裁决我们相互冲突的主张？有没有一种方法可以解决这个问题，而不必信任、支付和等待第三方充当仲裁者？</p><p id="5c0b" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">你所要做的就是向大家证明，你在月初之前发布了穿t恤事件，直到月底才发布任何相反的事件。让我们假设区块链以Merkle trie的形式从每个块访问整个事件历史，并从其契约脚本语言直接访问几个小时前的块。然后，为了证明你的蜥蜴确实穿了t恤，你可以告诉法官查看给定的最近街区，并作为证据展示Merkle证明，一些交易确实代表了穿t恤的蜥蜴——有了这个证据，你就有了一个案子，没有它，你就被赶出法庭。现在，证明你确实做了一些事情是容易的，但是你不能这么容易地说服法官你确实<em class="jw">没有</em>发布一个相反的交易，让蜥蜴脱掉t恤:为此，法官将不得不回顾从穿上t恤到合同到期日之间的每一笔交易——这肯定不会扩大规模。不过，你能做的是挑战<em class="jw"> me </em>展示任何这样的交易，如果它像我声称的那样存在的话。如果我能证明确实是你的蜥蜴拿走了t恤，通过类似地展示一个最近的区块和一个包含它的Merkle证明，那么你的合同失败了，法官会判我胜诉。然而，如果我不能在最后期限内提供这样的反驳，那么法官会判你胜诉。</p><p id="2bc8" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">使用被称为<em class="jw">游戏语义学</em>的数学领域，任何在区块链历史上被量化的公式都可以被转换成这样的“验证游戏”，从而被用于合同中。这使得原本没有设计的任意活动能够被组合。</p><p id="e6f1" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">此外，这类合同可以保密:在最初签署合同和在区块链上保管抵押资金时，只需公布这些条款的咸杂凑，就可以对公众隐藏这些条款。只有在有争议的情况下，合同条款才会被披露。实际上，即使合同可能非常大，包含许多条款，也只需披露合同中的一个条款。索赔者可以选择最简单的条款来争辩，例如合同要求的碗里有棕色M &amp; Ms巧克力豆。或者他们可以选择任何一个条款来最大化他们将被判给的损害赔偿，如果损害赔偿可能随条款而变化的话。</p><p id="9680" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">为了更进一步保护隐私，使用递归zkSNARKs甚至可以隐藏论点本身:旁观者看到的将是你和我发送的O(1)个证据，这些证据仍然无法被任何不了解我们协议的人解码。然而，所有这些旁观者，以及由“智能合同”和区块链共识组成的“法官”，将能够检查我们中的哪一个公平地赢得了这场审判，并被裁定为托管资金。实际上，使用ZCash或MimbleWimble首创的技术，甚至试验的结果本身也可以保密。所有的公众将会看到一些争议发生了，并根据客观公正得到了解决，尽管除了当事人没有人知道争议的主题或其结论。</p><p id="de77" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">为了实现契约的这种组合，我们从区块链需要的只是验证历史事件的能力——当然，还需要发出我们可以推理的合适事件。为此，我们需要区块链的契约脚本语言来给我们访问最近块的散列<em class="jw">和</em>我们需要每个散列来提交一个所有过去事件的trie。有趣的是，以太坊只做前者。我们仍然可以实现后者，但为此，<a class="ae jx" href="https://github.com/amiller/ethereum-blockhashes" rel="noopener ugc nofollow" target="_blank">一些契约</a>必须维护这个trie，并被定期调用来更新它，这是一个大麻烦。相反，如果块挖掘器维护trie，那么它们在每个块上的成本将只是trie深度的对数——只需要携带几十个散列——因为节点不需要记住整个历史来更新这些散列，只需要记住trie的主干。至于记住历史，用户将各自负责记住他们关心的历史片段。</p><p id="c141" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">当然，这项技术的应用不仅限于给可爱的蜥蜴穿t恤。它们可以用来组成任意的契约和创建复杂的分散式应用程序。</p><p id="10c5" class="pw-post-body-paragraph iy iz hu ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">在<a class="ae jx" href="https://alacris.io/" rel="noopener ugc nofollow" target="_blank"> Alacris.io </a>，我们正在使用上述技术以及其他许多技术来构建一个用于分散应用的操作系统。我们将实现的应用将包括任意金融产品之间的原子互换、复杂的金融合约、基于侧链的扩展解决方案等等。我们希望说服区块链实现者积极支持这一历史验证特性，这将使我们能够以比以太坊目前允许的更容易而不是更困难的方式来构建分散的应用程序。</p></div></div>    
</body>
</html>