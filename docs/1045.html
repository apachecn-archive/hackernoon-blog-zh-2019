<html>
<head>
<title>🚀 fnm: Fast and Simple Node.js Version Manager</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">🚀fnm:快速简单的 Node.js 版本管理器</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/fnm-fast-and-simple-node-js-version-manager-df82c37d4e87#2019-02-12">https://medium.com/hackernoon/fnm-fast-and-simple-node-js-version-manager-df82c37d4e87#2019-02-12</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><figure class="ht hu fm fo hv hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff hs"><img src="../Images/ae88ac27dc8c4b6e3b4e264231048fdf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7N18Q7qba8IToCAKlThtIg.png"/></div></div></figure><div class=""/><div class=""><h2 id="a28b" class="pw-subtitle-paragraph jc ie if bd b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ek translated">GitHub 上现在有一个超快速的 NVM 替代方案开源了</h2></div><p id="2dfa" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">TL；dr: <a class="ae kq" href="https://github.com/Schniz/fnm" rel="noopener ugc nofollow" target="_blank"> fnm </a>是一个非常快的<a class="ae kq" href="https://hackernoon.com/tagged/node.js" rel="noopener ugc nofollow" target="_blank"> Node.js </a>版本管理器，比 NVM 快~ 40 倍。支持<code class="eh kr ks kt ku b">.nvmrc</code>文件和<a class="ae kq" href="https://fishshell.com/" rel="noopener ugc nofollow" target="_blank">鱼壳</a>开箱。它可以在 Linux 和 Mac 上运行，并作为一个单独的可执行文件发布——而且它在 GitHub 上是开源的！</p><h1 id="202b" class="kv kw if bd kx ky kz la lb lc ld le lf jl lg jm lh jo li jp lj jr lk js ll lm dt translated">所以，</h1><p id="9d94" class="pw-post-body-paragraph ju jv if jw b jx ln jg jz ka lo jj kc kd lp kf kg kh lq kj kk kl lr kn ko kp hn dt translated">两周前，我在终端上打开了一个新标签，痛苦地抱怨道:“天哪！每次我打开一个新的终端都需要一秒钟！”。队友看我的眼神很搞笑。“这显然是次优的，有损我的专注，我认为这是 NVM 的错。”</p><p id="a143" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">在我对我的<code class="eh kr ks kt ku b">.zshrc</code>文件进行搜索，检查哪一行花费的时间最多之后，我发现是 NVM 出了问题。这是 NVM 的初始化。我使用 NVM 已经很多年了，我一直想写一个简单的替代品，因为我的用例非常简单:</p><ul class=""><li id="9823" class="lt lu if jw b jx jy ka kb kd lv kh lw kl lx kp ly lz ma mb dt translated">我希望能够下载任何节点版本(如<code class="eh kr ks kt ku b">nvm install</code>)</li><li id="aa26" class="lt lu if jw b jx mc ka md kd me kh mf kl mg kp ly lz ma mb dt translated">我希望能够在它们之间轻松切换(就像<code class="eh kr ks kt ku b">nvm use</code>)</li></ul><p id="a52b" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">这些任务不难解决。Node.js 二进制文件以 tarballs 的形式发布在他们的网站上，切换版本不应该仅仅是改变一个符号链接。那么，NVM 为什么这么慢？</p><p id="3bd6" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">我想把它写成一个简单的 Bash 脚本，就像 NVM 一样，但是我希望它有趣。此外，并不是所有的机器都安装了 Bash，否则在与 Bash 集成时可能会出现问题。我已经使用<a class="ae kq" href="https://fishshell.com/" rel="noopener ugc nofollow" target="_blank">鱼壳</a>很多年了，为了使用 NVM，我不得不使用一个修复东西的包装器。这并不容易。另一方面，使用真正的可执行文件可以在任何 shell 上工作！</p><h1 id="0685" class="kv kw if bd kx ky kz la lb lc ld le lf jl lg jm lh jo li jp lj jr lk js ll lm dt translated">第一个原型</h1><p id="6750" class="pw-post-body-paragraph ju jv if jw b jx ln jg jz ka lo jj kc kd lp kf kg kh lq kj kk kl lr kn ko kp hn dt translated">我的第一个原型是一个打字脚本应用程序。我用<a class="ae kq" href="https://github.com/zeit/pkg" rel="noopener ugc nofollow" target="_blank"> Zeit 的 pkg </a>把它打包，使它成为一个自包含的可执行文件，因为我不想对 Node 有依赖性。我想让它在没有安装 Node 的系统上工作(所以 Node 的第一个版本将使用 fnm 安装！)</p><p id="d53e" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">Node 的启动时间对我来说不够好。仅仅生成一个“hello world”就需要大约 200 毫秒，这对于服务器来说是好的，对于不经常使用的命令行实用程序来说也是好的，但是有些人在每个<code class="eh kr ks kt ku b">cd</code>上都使用<code class="eh kr ks kt ku b">nvm</code>，所以他们的节点版本总是同步的。每个<code class="eh kr ks kt ku b">cd</code>200 毫秒的惩罚是疯狂的，会使工具无法使用。</p><p id="7bff" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">所以看起来我需要用一种编译过的语言来写它(所以不依赖于主机系统)，并且有一个快速的启动时间。想到了四种语言:Go、Rust、Crystal 和 Reason/OCaml。</p><h1 id="c5a2" class="kv kw if bd kx ky kz la lb lc ld le lf jl lg jm lh jo li jp lj jr lk js ll lm dt translated">一款原生推理 App</h1><p id="740a" class="pw-post-body-paragraph ju jv if jw b jx ln jg jz ka lo jj kc kd lp kf kg kh lq kj kk kl lr kn ko kp hn dt translated">我选择理智是有很多原因的(呵呵)，<a class="ae kq" href="https://hackernoon.com/the-programming-language-im-looking-for-948d93f7a396" rel="noopener ugc nofollow" target="_blank">有些写在另一个帖子</a>。我使用了<code class="eh kr ks kt ku b"><a class="ae kq" href="https://esy.sh/" rel="noopener ugc nofollow" target="_blank">esy</a></code>和<code class="eh kr ks kt ku b"><a class="ae kq" href="https://github.com/jordwalke/pesy" rel="noopener ugc nofollow" target="_blank">pesy</a></code>，这两个很棒的软件包让 Node.js 开发人员可以轻松开发 native Reason/OCaml 应用程序的工作流程。</p><p id="3f03" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated"><code class="eh kr ks kt ku b">esy</code>工作起来像一个超级的<code class="eh kr ks kt ku b"><a class="ae kq" href="https://yarnpkg.com/" rel="noopener ugc nofollow" target="_blank">yarn</a></code>:它从 npm 或者 OPAM (OCaml 包管理器)安装包，然后<a class="ae kq" href="https://esy.sh/docs/en/how-it-works.html" rel="noopener ugc nofollow" target="_blank">把它存储在一个全局缓存</a>。它还为您管理 OCaml 运行时/依赖项的沙箱，因此不同的 OCaml 安装不会相互中断。<code class="eh kr ks kt ku b">pesy</code>直接从<code class="eh kr ks kt ku b">package.json</code>文件中为 OCaml 的构建工具<a class="ae kq" href="https://dune.build/" rel="noopener ugc nofollow" target="_blank"> Dune </a>生成构建配置。</p><p id="b0a8" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">当使用这两个包时，感觉就像节点开发一样——所有东西都用一个<code class="eh kr ks kt ku b">package.json</code>文件工作，只需要最少的配置。它也可以帮助其他节点开发人员，就像它帮助我一样，为项目做出贡献，因为 Reason 语法非常接近 JS '，工具链感觉非常类似于 JavaScript。</p><p id="3bae" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">我制作了第一个原型，并测试了它的性能。我有两个测试文件，一个使用 NVM，一个使用 fnm。两个测试都产生了一个普通的 Bash，称为目标的“初始化”(NVM/fnm)，然后使用目标切换到目录中的<code class="eh kr ks kt ku b">.nvmrc</code>文件中指定的节点版本。我对每个二进制文件运行了 10 次，结果令人惊讶:</p><ul class=""><li id="db8c" class="lt lu if jw b jx jy ka kb kd lv kh lw kl lx kp ly lz ma mb dt translated">NVM 的测试用例在我的机器上运行了大约 600 毫秒</li><li id="8477" class="lt lu if jw b jx mc ka md kd me kh mf kl mg kp ly lz ma mb dt translated">fnm 的测试用例在我的机器上运行了大约 15 毫秒</li></ul><p id="2738" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">所以在那次测试中，在我的 MacBook Pro 上，<strong class="jw ig"> fnm 比 NVM </strong>快 40 倍。尽管不太科学，但这是相当大的数字。</p><figure class="mi mj mk ml fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff mh"><img src="../Images/2e16820f51c2bd243755819217c18301.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BHV5xSl1O7k9b-rhLI0YLQ.png"/></div></div><figcaption class="mm mn fg fe ff mo mp bd b be z ek"><a class="ae kq" href="https://github.com/Schniz/fnm" rel="noopener ugc nofollow" target="_blank">A real-time animated video is on the repo’s README</a></figcaption></figure><h1 id="756c" class="kv kw if bd kx ky kz la lb lc ld le lf jl lg jm lh jo li jp lj jr lk js ll lm dt translated">向公众发布</h1><p id="2db9" class="pw-post-body-paragraph ju jv if jw b jx ln jg jz ka lo jj kc kd lp kf kg kh lq kj kk kl lr kn ko kp hn dt translated">当我开始从事 fnm 的工作时，我加入了 Reason Discord 服务器，并向人们寻求帮助。发现那个社区<em class="ls">这么好看</em>。当我决定发布时，我在<code class="eh kr ks kt ku b">#native-development</code>频道上写了一条短信，立即得到了很好的反馈，告诉我这是一个很棒的想法。</p><p id="1451" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">社区方面是 JavaScript 的如此重要的一部分，Reason 的社区感觉比 JS 的还要好——可能因为社区仍然很小，但是它非常受欢迎。</p><p id="3ebd" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">我把 fnm 作为开源发布到 GitHub，发了关于它的推特，然后睡觉了。当我醒来的时候，</p><ul class=""><li id="27ba" class="lt lu if jw b jx jy ka kb kd lv kh lw kl lx kp ly lz ma mb dt translated">我的推特通知着火了🔥</li><li id="cc97" class="lt lu if jw b jx mc ka md kd me kh mf kl mg kp ly lz ma mb dt translated">回购有 500 多颗星💯💯💯💯💯</li><li id="8158" class="lt lu if jw b jx mc ka md kd me kh mf kl mg kp ly lz ma mb dt translated">fnm 在黑客新闻上排名第一🏆</li><li id="2c5d" class="lt lu if jw b jx mc ka md kd me kh mf kl mg kp ly lz ma mb dt translated">Reddit/HackerNews 上没人骂我傻逼！🤡(罕见的景象)</li></ul><p id="eefd" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">这是一件大事。</p><figure class="mi mj mk ml fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff mq"><img src="../Images/80624e9c63a75db7bda01c7035bcf575.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*fA8IFjVxanv10-RM.png"/></div></div></figure><h1 id="9cf4" class="kv kw if bd kx ky kz la lb lc ld le lf jl lg jm lh jo li jp lj jr lk js ll lm dt translated">现在怎么办？</h1><p id="c22c" class="pw-post-body-paragraph ju jv if jw b jx ln jg jz ka lo jj kc kd lp kf kg kh lq kj kk kl lr kn ko kp hn dt translated">fnm 仍然缺少一些功能。以下是我们想补充的几件事:</p><ul class=""><li id="c2f5" class="lt lu if jw b jx jy ka kb kd lv kh lw kl lx kp ly lz ma mb dt translated">Windows 支持</li><li id="acc0" class="lt lu if jw b jx mc ka md kd me kh mf kl mg kp ly lz ma mb dt translated">版本别名</li><li id="85a6" class="lt lu if jw b jx mc ka md kd me kh mf kl mg kp ly lz ma mb dt translated">支持下载最新的 LTS</li><li id="d6b6" class="lt lu if jw b jx mc ka md kd me kh mf kl mg kp ly lz ma mb dt translated">每外壳使用</li><li id="9daa" class="lt lu if jw b jx mc ka md kd me kh mf kl mg kp ly lz ma mb dt translated">放弃对<code class="eh kr ks kt ku b">tar</code>和<code class="eh kr ks kt ku b">curl</code>的依赖</li><li id="d035" class="lt lu if jw b jx mc ka md kd me kh mf kl mg kp ly lz ma mb dt translated">…以及更多！</li></ul><p id="a509" class="pw-post-body-paragraph ju jv if jw b jx jy jg jz ka kb jj kc kd ke kf kg kh ki kj kk kl km kn ko kp hn dt translated">因此，如果您觉得您已经准备好使用它并开始更快地工作，或者您是一名愿意为开源项目做出贡献的 JS/Reason 开发人员，<a class="ae kq" href="https://github.com/Schniz/fnm" rel="noopener ugc nofollow" target="_blank">下载 fnm 并加入我们的 GitHub </a>！</p><figure class="mi mj mk ml fq hw"><div class="bz el l di"><div class="mr ms l"/></div></figure></div></div>    
</body>
</html>