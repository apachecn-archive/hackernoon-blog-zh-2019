<html>
<head>
<title>How to deployment Knative on Azure Kubernetes Service (AKS)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在 Azure Kubernetes 服务(AKS)上部署 Knative</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/how-to-deployment-knative-on-azure-kubernetes-service-aks-537ffa6cc490#2019-04-02">https://medium.com/hackernoon/how-to-deployment-knative-on-azure-kubernetes-service-aks-537ffa6cc490#2019-04-02</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/4a19fc9b26df251957b7df1a76b09736.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*w9yyboeLnq-kzfIi.jpg"/></div></div></figure><h1 id="e4aa" class="jc jd hu bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz dt translated"><strong class="ak">简介</strong></h1><p id="5943" class="pw-post-body-paragraph ka kb hu kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx hn dt translated">为了使 knative 工作与 AKS，除了官方文件，这需要一些时间，所以我会解释如何做。<br/>整个流程与启动 AKS、安装 isto 和安装 knative 的文档相同，但它需要文档中没有的设置。<br/>现在我来解释一下。</p><p id="bace" class="pw-post-body-paragraph ka kb hu kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hn dt translated">我将省略 knative 本身的解释。<br/>此外，由于有可能存在对已验证版本的依赖性等。，不能保证它完全有效。<br/>假设 Azure CLI 和 kubectl 已经可用。</p><p id="8fde" class="pw-post-body-paragraph ka kb hu kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hn dt translated">文件<br/><a class="ae ld" href="https://www.knative.dev/docs/install/knative-with-aks/" rel="noopener ugc nofollow" target="_blank">https://www.knative.dev/docs/install/knative-with-aks/</a></p><h1 id="9b61" class="jc jd hu bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz dt translated"><strong class="ak">AKS 的开始</strong></h1><p id="4907" class="pw-post-body-paragraph ka kb hu kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx hn dt translated">基本和文件一样。</p><p id="9a2e" class="pw-post-body-paragraph ka kb hu kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hn dt translated">指定环境的名称。</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="7964" class="ln jd hu lj b fv lo lp l lq lr">export LOCATION=eastus<br/>export RESOURCE_GROUP=knative-group<br/>export CLUSTER_NAME=knative-cluster</span></pre><p id="e6d3" class="pw-post-body-paragraph ka kb hu kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hn dt translated">创建资源组</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="6d37" class="ln jd hu lj b fv lo lp l lq lr">az group create --name $RESOURCE_GROUP --location $LOCATION</span></pre><p id="67fc" class="pw-post-body-paragraph ka kb hu kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hn dt translated">启动 AKS。<br/>版本为 1.11.8。也许即使 1.12 系统也可以…</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="0c26" class="ln jd hu lj b fv lo lp l lq lr">az aks create --resource-group $RESOURCE_GROUP \<br/>   --name $CLUSTER_NAME \<br/>   --generate-ssh-keys \<br/>   --kubernetes-version 1.11.8 \<br/>   --enable-rbac \<br/>   --node-vm-size Standard_DS3_v2</span></pre><p id="010a" class="pw-post-body-paragraph ka kb hu kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hn dt translated">设置为能够与 kubectl 一起操作。(- overwrite-existing 覆盖现有设置)</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="fb88" class="ln jd hu lj b fv lo lp l lq lr">az aks get-credentials --resource-group $RESOURCE_GROUP --name $CLUSTER_NAME --admin --overwrite-existing</span></pre><p id="0be2" class="pw-post-body-paragraph ka kb hu kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hn dt translated">确保启动时没有问题。</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="9177" class="ln jd hu lj b fv lo lp l lq lr">kubectl get node<br/>NAME                       STATUS    ROLES     AGE       VERSION<br/>aks-nodepool1-24002009-0   Ready     agent     3m        v1.11.8<br/>aks-nodepool1-24002009-1   Ready     agent     3m        v1.11.8<br/>aks-nodepool1-24002009-2   Ready     agent     4m        v1.11.8</span></pre><h1 id="b7da" class="jc jd hu bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz dt translated">istio 安装</h1><p id="8d16" class="pw-post-body-paragraph ka kb hu kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx hn dt translated">按照文件进行。</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="bb2a" class="ln jd hu lj b fv lo lp l lq lr">kubectl apply --filename <a class="ae ld" href="https://github.com/knative/serving/releases/download/v0.4.0/istio-crds.yaml" rel="noopener ugc nofollow" target="_blank">https://github.com/knative/serving/releases/download/v0.4.0/istio-crds.yaml</a><br/>kubectl apply --filename <a class="ae ld" href="https://github.com/knative/serving/releases/download/v0.4.0/istio.yaml" rel="noopener ugc nofollow" target="_blank">https://github.com/knative/serving/releases/download/v0.4.0/istio.yaml</a></span></pre><p id="f835" class="pw-post-body-paragraph ka kb hu kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hn dt translated">贴上标签。</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="c7bd" class="ln jd hu lj b fv lo lp l lq lr">kubectl label namespace default istio-injection=enabled</span></pre><p id="346a" class="pw-post-body-paragraph ka kb hu kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hn dt translated">检查哪个 pod 已启动。</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="5825" class="ln jd hu lj b fv lo lp l lq lr">kubectl get pods --namespace istio-system</span></pre><p id="fd5f" class="pw-post-body-paragraph ka kb hu kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hn dt translated">等待它运行或完成。</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="16dc" class="ln jd hu lj b fv lo lp l lq lr">NAME                                        READY     STATUS      RESTARTS   AGE<br/>cluster-local-gateway-76db55c785-wkjvh      1/1       Running     0          5m<br/>istio-citadel-746c765786-d758c              1/1       Running     0          6m<br/>istio-cleanup-secrets-cj8cf                 0/1       Completed   0          6m<br/>istio-egressgateway-7b46794587-jbk2s        1/1       Running     0          6m<br/>istio-galley-75c6976d79-z5hp4               1/1       Running     0          6m<br/>istio-ingressgateway-57f76dc4db-xqx8l       1/1       Running     0          6m<br/>istio-pilot-6495978c49-4wl8w                2/2       Running     0          5m<br/>istio-pilot-6495978c49-csfxn                2/2       Running     0          5m<br/>istio-pilot-6495978c49-llw97                2/2       Running     0          6m<br/>istio-policy-6677c87b9f-7ff2g               2/2       Running     0          6m<br/>istio-sidecar-injector-879fd9dfc-2dfkt      1/1       Running     0          5m<br/>istio-statsd-prom-bridge-549d687fd9-8rbfw   1/1       Running     0          6m<br/>istio-telemetry-7d46d668db-khglq            2/2       Running     0          6m</span></pre><h1 id="2c93" class="jc jd hu bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz dt translated">knative 安装</h1><p id="b3d2" class="pw-post-body-paragraph ka kb hu kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx hn dt translated">应用以下程序，但继续检查每个 pod 的启动。<br/>然后，在单独应用服务之后，工作将发生。</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="d1d9" class="ln jd hu lj b fv lo lp l lq lr">kubectl apply --filename <a class="ae ld" href="https://github.com/knative/serving/releases/download/v0.4.0/serving.yaml" rel="noopener ugc nofollow" target="_blank">https://github.com/knative/serving/releases/download/v0.4.0/serving.yaml</a><br/>kubectl apply --filename <a class="ae ld" href="https://github.com/knative/build/releases/download/v0.4.0/build.yaml" rel="noopener ugc nofollow" target="_blank">https://github.com/knative/build/releases/download/v0.4.0/build.yaml</a><br/>kubectl apply --filename <a class="ae ld" href="https://github.com/knative/eventing/releases/download/v0.4.0/release.yaml" rel="noopener ugc nofollow" target="_blank">https://github.com/knative/eventing/releases/download/v0.4.0/release.yaml</a><br/>kubectl apply --filename <a class="ae ld" href="https://github.com/knative/eventing-sources/releases/download/v0.4.0/release.yaml" rel="noopener ugc nofollow" target="_blank">https://github.com/knative/eventing-sources/releases/download/v0.4.0/release.yaml</a><br/>kubectl apply --filename <a class="ae ld" href="https://github.com/knative/serving/releases/download/v0.4.0/monitoring.yaml" rel="noopener ugc nofollow" target="_blank">https://github.com/knative/serving/releases/download/v0.4.0/monitoring.yaml</a><br/>kubectl apply --filename <a class="ae ld" href="https://raw.githubusercontent.com/knative/serving/v0.4.0/third_party/config/build/clusterrole.yaml" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/knative/serving/v0.4.0/third_party/config/build/clusterrole.yaml</a></span></pre><p id="26ff" class="pw-post-body-paragraph ka kb hu kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hn dt translated">如果在应用过程中出现错误，请再次运行。</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="baf5" class="ln jd hu lj b fv lo lp l lq lr">error: unable to recognize "<a class="ae ld" href="https://github.com/knative/serving/releases/download/v0.4.0/serving.yaml" rel="noopener ugc nofollow" target="_blank">https://github.com/knative/serving/releases/download/v0.4.0/serving.yaml</a>": no matches for kind "Image" in version "caching.internal.knative.dev/v1alpha1"</span></pre><p id="0443" class="pw-post-body-paragraph ka kb hu kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hn dt translated">应用服务。</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="f5d9" class="ln jd hu lj b fv lo lp l lq lr">kubectl apply --filename <a class="ae ld" href="https://github.com/knative/serving/releases/download/v0.4.0/serving.yaml" rel="noopener ugc nofollow" target="_blank">https://github.com/knative/serving/releases/download/v0.4.0/serving.yaml</a></span></pre><p id="4d20" class="pw-post-body-paragraph ka kb hu kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hn dt translated">检查吊舱的发射情况。</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="a8d2" class="ln jd hu lj b fv lo lp l lq lr">kubectl get pods --namespace knative-serving</span></pre><p id="4aff" class="pw-post-body-paragraph ka kb hu kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hn dt translated">激活器和自动缩放器将导致错误。我们需要消除这种情况。</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="b364" class="ln jd hu lj b fv lo lp l lq lr">NAME                          READY     STATUS             RESTARTS   AGE<br/>activator-6f7d494f55-sdhcw    1/2       CrashLoopBackOff   3          1m<br/>autoscaler-5cb4d56d69-xng46   1/2       CrashLoopBackOff   3          1m<br/>controller-6d65444c78-wrnnc   1/1       Running            0          1m<br/>webhook-55f88654fb-tndgw      1/1       Running            0          1m</span></pre><p id="6d49" class="pw-post-body-paragraph ka kb hu kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hn dt translated">问题报告如下。还描述了解决方案。<br/>虽然没有详细描述，但似乎 istio 有问题。</p><p id="b3e6" class="pw-post-body-paragraph ka kb hu kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hn dt translated">无法安装 Knative serving<br/><a class="ae ld" href="https://github.com/knative/serving/issues/2878" rel="noopener ugc nofollow" target="_blank">https://github.com/knative/serving/issues/2878</a><br/>请求不要通过 AKS 上的激活器<br/><a class="ae ld" href="https://github.com/knative/serving/issues/3026" rel="noopener ugc nofollow" target="_blank">https://github.com/knative/serving/issues/3026</a><br/>内部 Kubernetes API 调用被 Istio<br/><a class="ae ld" href="https://github.com/istio/istio/issues/8696" rel="noopener ugc nofollow" target="_blank">https://github.com/istio/istio/issues/8696</a>阻止</p><p id="a9ca" class="pw-post-body-paragraph ka kb hu kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hn dt translated">首先得到集群 FQDN。</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="8151" class="ln jd hu lj b fv lo lp l lq lr">az aks show -n $CLUSTER_NAME -g $RESOURCE_GROUP -o table</span><span id="124b" class="ln jd hu lj b fv ls lp l lq lr">Name             Location    ResourceGroup    KubernetesVersion    ProvisioningState    Fqdn<br/>---------------  ----------  ---------------  -------------------  -------------------  -------------------------------------------------------------<br/>knative-cluster  eastus      knative-group    1.11.8               Succeeded            knative-cl-knative-group-630e95-44db6d79.hcp.eastus.azmk8s.io</span></pre><p id="008c" class="pw-post-body-paragraph ka kb hu kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hn dt translated">接下来，基于 FQDN 创建以下清单。<br/>根据自己的环境各换各的。</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="d3a9" class="ln jd hu lj b fv lo lp l lq lr">apiVersion: networking.istio.io/v1alpha3<br/>kind: ServiceEntry<br/>metadata:<br/>  name: azmk8s-ext<br/>spec:<br/>  hosts:<br/>  - "knative-cl-knative-group-630e95-44db6d79.hcp.eastus.azmk8s.io"<br/>  location: MESH_EXTERNAL<br/>  ports:<br/>  - number: 443<br/>    name: https<br/>    protocol: HTTPS<br/>  resolution: DNS<br/>---<br/>apiVersion: networking.istio.io/v1alpha3<br/>kind: VirtualService<br/>metadata:<br/>  name: tls-routing<br/>spec:<br/>  hosts:<br/>  - knative-cl-knative-group-630e95-44db6d79.hcp.eastus.azmk8s.io<br/>  tls:<br/>  - match:<br/>    - port: 443<br/>      sniHosts:<br/>      - knative-cl-knative-group-630e95-44db6d79.hcp.eastus.azmk8s.io<br/>    route:<br/>    - destination:<br/>        host: knative-cl-knative-group-630e95-44db6d79.hcp.eastus.azmk8s.io</span></pre><p id="2fd9" class="pw-post-body-paragraph ka kb hu kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hn dt translated">一旦你设置好你的 istio，再次检查你的 pod。</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="da4b" class="ln jd hu lj b fv lo lp l lq lr">kubectl get pods --namespace knative-serving<br/>NAME                          READY     STATUS    RESTARTS   AGE<br/>activator-6f7d494f55-sdhcw    2/2       Running   8          16m<br/>autoscaler-5cb4d56d69-xng46   2/2       Running   8          16m<br/>controller-6d65444c78-wrnnc   1/1       Running   0          16m<br/>webhook-55f88654fb-tndgw      1/1       Running   0          16m</span></pre><p id="f27f" class="pw-post-body-paragraph ka kb hu kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hn dt translated">确保你们都在跑。</p><p id="fb0f" class="pw-post-body-paragraph ka kb hu kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hn dt translated">展开构建</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="42f2" class="ln jd hu lj b fv lo lp l lq lr">kubectl apply --filename <a class="ae ld" href="https://github.com/knative/build/releases/download/v0.4.0/build.yaml" rel="noopener ugc nofollow" target="_blank">https://github.com/knative/build/releases/download/v0.4.0/build.yaml</a></span></pre><p id="2f7e" class="pw-post-body-paragraph ka kb hu kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hn dt translated">检查豆荚</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="1435" class="ln jd hu lj b fv lo lp l lq lr">kubectl get pods --namespace knative-build<br/>NAME                                READY     STATUS    RESTARTS   AGE<br/>build-controller-68dfb74954-vx4rb   1/1       Running   0          12s<br/>build-webhook-866fd64885-dsmdn      1/1       Running   0          12s</span></pre><p id="1082" class="pw-post-body-paragraph ka kb hu kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hn dt translated">展开事件。</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="5555" class="ln jd hu lj b fv lo lp l lq lr">kubectl apply --filename <a class="ae ld" href="https://github.com/knative/eventing/releases/download/v0.4.0/release.yaml" rel="noopener ugc nofollow" target="_blank">https://github.com/knative/eventing/releases/download/v0.4.0/release.yaml</a></span></pre><p id="1b21" class="pw-post-body-paragraph ka kb hu kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hn dt translated">检查豆荚</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="94c4" class="ln jd hu lj b fv lo lp l lq lr">kubectl get pods --namespace knative-eventing<br/>NAME                                            READY     STATUS    RESTARTS   AGE<br/>eventing-controller-756d56fc7-t64lq             1/1       Running   0          35s<br/>in-memory-channel-controller-79ccbb59c-87cnr    1/1       Running   0          22s<br/>in-memory-channel-dispatcher-5c864b94f4-x5jgk   2/2       Running   1          20s<br/>webhook-85f7f4fb6-tdk46                         1/1       Running   0          34s</span></pre><p id="78e0" class="pw-post-body-paragraph ka kb hu kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hn dt translated">展开事件-源。</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="e557" class="ln jd hu lj b fv lo lp l lq lr">kubectl apply --filename <a class="ae ld" href="https://github.com/knative/eventing-sources/releases/download/v0.4.0/release.yaml" rel="noopener ugc nofollow" target="_blank">https://github.com/knative/eventing-sources/releases/download/v0.4.0/release.yaml</a></span></pre><p id="aaf6" class="pw-post-body-paragraph ka kb hu kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hn dt translated">检查豆荚</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="9757" class="ln jd hu lj b fv lo lp l lq lr">kubectl get pods --namespace knative-sources<br/>NAME                   READY     STATUS    RESTARTS   AGE<br/>controller-manager-0   1/1       Running   0          18m</span></pre><p id="f034" class="pw-post-body-paragraph ka kb hu kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hn dt translated">扩展监控</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="44a1" class="ln jd hu lj b fv lo lp l lq lr">kubectl apply --filename <a class="ae ld" href="https://github.com/knative/serving/releases/download/v0.4.0/monitoring.yaml" rel="noopener ugc nofollow" target="_blank">https://github.com/knative/serving/releases/download/v0.4.0/monitoring.yaml</a></span></pre><p id="dd7f" class="pw-post-body-paragraph ka kb hu kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hn dt translated">检查豆荚</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="9275" class="ln jd hu lj b fv lo lp l lq lr">kubectl get pods --namespace knative-monitoring<br/>NAME                                  READY     STATUS    RESTARTS   AGE<br/>elasticsearch-logging-0               1/1       Running   0          18m<br/>elasticsearch-logging-1               1/1       Running   0          17m<br/>grafana-754bc795bb-cm82c              1/1       Running   0          17m<br/>kibana-logging-7f7b9698bc-pnbp9       1/1       Running   0          18m<br/>kube-state-metrics-768dfff9c5-c4mf2   4/4       Running   0          17m<br/>node-exporter-2snzs                   2/2       Running   0          17m<br/>node-exporter-7tnjp                   2/2       Running   0          17m<br/>node-exporter-95k29                   2/2       Running   0          17m<br/>prometheus-system-0                   1/1       Running   0          17m<br/>prometheus-system-1                   1/1       Running   0          17m</span></pre><p id="a81e" class="pw-post-body-paragraph ka kb hu kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hn dt translated">展开集群角色</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="55db" class="ln jd hu lj b fv lo lp l lq lr">kubectl apply --filename <a class="ae ld" href="https://raw.githubusercontent.com/knative/serving/v0.4.0/third_party/config/build/clusterrole.yaml" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/knative/serving/v0.4.0/third_party/config/build/clusterrole.yaml</a></span></pre><p id="ec41" class="pw-post-body-paragraph ka kb hu kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hn dt translated">以上所有安装均已完成。</p><h1 id="3539" class="jc jd hu bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz dt translated">操作检查</h1><p id="7508" class="pw-post-body-paragraph ka kb hu kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx hn dt translated">根据文件检查操作。<br/><a class="ae ld" href="https://www.knative.dev/docs/install/getting-started-knative-app/" rel="noopener ugc nofollow" target="_blank">https://www . knative . dev/docs/install/getting-started-knative-app/</a></p><p id="13e8" class="pw-post-body-paragraph ka kb hu kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hn dt translated">展开以下内容:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="4649" class="ln jd hu lj b fv lo lp l lq lr">apiVersion: serving.knative.dev/v1alpha1<br/>kind: Service<br/>metadata:<br/>  name: helloworld-go<br/>  namespace: default<br/>spec:<br/>  runLatest:<br/>    configuration:<br/>      revisionTemplate:<br/>        spec:<br/>          container:<br/>            image: gcr.io/knative-samples/helloworld-go <br/>            env:<br/>              - name: TARGET<br/>                value: "Go Sample v1"</span></pre><p id="11f7" class="pw-post-body-paragraph ka kb hu kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hn dt translated">指定 INGRESSGATEWAY。</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="424b" class="ln jd hu lj b fv lo lp l lq lr">INGRESSGATEWAY=knative-ingressgateway<br/>if kubectl get configmap config-istio -n knative-serving &amp;&gt; /dev/null; then<br/>    INGRESSGATEWAY=istio-ingressgateway<br/>fi</span></pre><p id="64df" class="pw-post-body-paragraph ka kb hu kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hn dt translated">指定网关并检查 SVC。</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="3125" class="ln jd hu lj b fv lo lp l lq lr">kubectl get svc $INGRESSGATEWAY --namespace istio-system<br/>NAME                   TYPE           CLUSTER-IP     EXTERNAL-IP     PORT(S)                                                                                                                   AGE<br/>istio-ingressgateway   LoadBalancer   10.0.101.139   104.41.153.79   80:31380/TCP,443:31390/TCP,31400:31400/TCP,15011:30458/TCP,8060:31092/TCP,853:30754/TCP,15030:30403/TCP,15031:30798/TCP   53m</span></pre><p id="0800" class="pw-post-body-paragraph ka kb hu kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hn dt translated">获取 IP。</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="aef2" class="ln jd hu lj b fv lo lp l lq lr">export IP_ADDRESS=$(kubectl get svc $INGRESSGATEWAY --namespace istio-system --output 'jsonpath={.status.loadBalancer.ingress[0].ip}')</span></pre><p id="07e0" class="pw-post-body-paragraph ka kb hu kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hn dt translated">URL 检查</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="ccdb" class="ln jd hu lj b fv lo lp l lq lr">kubectl get ksvc helloworld-go  --output=custom-columns=NAME:.metadata.name,DOMAIN:.status.domain<br/>NAME            DOMAIN<br/>helloworld-go   helloworld-go.default.example.com</span></pre><p id="1f44" class="pw-post-body-paragraph ka kb hu kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hn dt translated">确认“Hello Go 样品 v1！”回来了。</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="bcf6" class="ln jd hu lj b fv lo lp l lq lr">curl -H "Host: helloworld-go.default.example.com" <a class="ae ld" href="http://${IP_ADDRESS" rel="noopener ugc nofollow" target="_blank">http://${IP_ADDRESS</a>}<br/>Hello Go Sample v1!</span></pre><p id="22b9" class="pw-post-body-paragraph ka kb hu kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hn dt translated">以上操作检查完成。</p><h1 id="f664" class="jc jd hu bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz dt translated">摘要</h1><p id="7eb2" class="pw-post-body-paragraph ka kb hu kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx hn dt translated">Knative 现在在 Azure 工作。<br/>未来，使用 knative 的应用也会增加。<br/>此外，如果你使用 Knative Lambda 运行时，你将能够在 Azure 上做 Lambda。<br/>我很期待。</p></div><div class="ab cl lt lu hc lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="hn ho hp hq hr"><p id="9457" class="pw-post-body-paragraph ka kb hu kc b kd ky kf kg kh kz kj kk kl la kn ko kp lb kr ks kt lc kv kw kx hn dt translated">原文内容(日文):<a class="ae ld" href="http://level69.net/archives/26443" rel="noopener ugc nofollow" target="_blank">http://level69.net/archives/26443</a></p></div></div>    
</body>
</html>