# 沙()！

> 原文：<https://medium.com/hackernoon/sha-zam-b01cf9c7126a>

捍卫你的国家频道的冠军网络。

![](img/82c80cd0c98c4cb3796795d3e3813b6a.png)

I choose YOU as Champion of my State!

我是[元交易](/@austin_48503/ethereum-meta-transactions-90ccf0859e84)的[加油站网络](/tabookey/1-800-ethereum-gas-stations-network-for-toll-free-transactions-4bbfc03a0a56)的忠实粉丝。它极大地简化了处理分散元事务中继网络的信任博弈机制的问题。特别是，我真的很喜欢 DApps 负责决定他们想要使用哪些继电器，以及决定他们何时被滥用的方式，所有这些都不需要放弃任何安全保证。

阅读更多关于[加油站网络](/tabookey/1-800-ethereum-gas-stations-network-for-toll-free-transactions-4bbfc03a0a56)，以及[齐柏林加入加油站联盟](https://blog.zeppelinos.org/gas-station-network-alliance/)。

最近，当我在加油站网络上构建演示时，我想知道我们是否可以使用相同的机制来支持第二层解决方案，这些解决方案通常由复杂的游戏机制和本机令牌支持。

状态通道的一个问题在本文[中被雄辩地解释为活动性和可用性。基本上，如果你在两方之间有一个开放的状态通道，你就依赖于双方都在线，并且愿意互相交流。](https://l4.ventures/papers/statechannels.pdf)

这是很重要的，因为状态信道的安全保证取决于这样一个事实，即如果双方不同意，他们总是可以返回到主网，以在被称为“挑战持续时间”的一段时间内证明最近的有效状态。然而，如果一方无法连接到网络(例如，他们失去了互联网连接或者他们关闭了他们的浏览器)，则仍然具有连接的一方可以在链上呈现具有旧状态的事务，而没有连接的第二方要么不知道，要么不能挑战无效状态。

如果双方失去联系(或更糟)，他们的资金可能会被无限期锁定在存款合同中。

[加油站网络](https://github.com/tabookey/tabookey-gasless)通过单一契约运行，该契约包含所有愿意付费中继交易的中继的注册，以及一些避免不良行为的削减机制。

DApps 可以自由选择他们希望的任何中继，如果中继行为不端，它不仅不能窃取 DApp 用户的资金，而且如果它决定中继被滥用，DApps 可以自由地将它列入黑名单。

这个系统真的非常优雅，目前正由 Zeppelin 进行审计，最糟糕的行为只会让 DApp 损失几秒钟的时间而没有资金。

# 我选你为冠军！(我所在的州)

![](img/f0e68027eebe575b350f7bfc96e50a62.png)

DC Comics

那么，如果我们将加油站网络中最好的部分与国家渠道中最差的部分合并，会发生什么呢？好吧，比利·艾森，**我选择你作为(我最近有效状态的)冠军！**。

DApp 用户不是很好的国家监护者，在正常运行时间方面也不太可靠。用户的连接性会有很大的不同，如果浏览器窗口关闭，用户的状态就会消失。

用，我叫什么“沙(zam)！”网络(当然是 DC 漫画的未决诉讼！)当两个用户在他们之间打开状态信道时，他们还可以各自指定一个中继作为“冠军”,以在连接丢失或他们的对手方的恶意行为的情况下保护他们的状态。

**我们来举个例子:**

爱丽丝决定为鲍勃打开一个游戏的国家频道。

首先，Alice 和 Bob 都将存款存入合同中(姑且称之为冠军中心，就像加油站网络中的中继中心)。爱丽丝看着“冠军中心”,随机选择一个“冠军”来捍卫她的状态。同时，Bob 也去“冠军中心”选择他的“冠军”来捍卫他的州。

Alice 和 Bob 可以在链外进行高速、无成本的交易，就像普通的支付/状态通道一样。

不同的是，对于 Alice 和 Bob 之间的每笔交易，他们都会向各自的支持者发送一份副本以进行安全保管，并定期向各自的支持者发送“保持活动”消息，让他们知道“一切都好”。

如果 Alice 或 Bob 未能向他们各自的支持者报到，他们的支持者可以假设发生了一些事情，并向网络提交他们最近收到的有效状态，以开始关闭通道的挑战过程。

在被元交易驱动的情况下，此时，Bob 或 Alice 可以请求他们的冠军也为该交易支付汽油费用。

因此，例如，如果 Alice 失去了互联网连接，并且未能向她的冠军报到，则在一段时间后，冠军将向存款合同提交它从 Alice 收到的最新状态，以关闭通道。

同时，Bob 的支持者应该注意到质询期已经开始，并随后将从 Bob 处收到的状态的最新副本提交给存款合同。确认最近的有效状态，并且网络执行该状态。与此同时，两位冠军都获得了一笔奖金，作为促成“冠军赛”的费用。

冠军受到激励密切关注存款合同，因为没有两个冠军就关闭的国家频道可能会惩罚“懒惰的冠军”。

这种设置的好处在于推理起来非常简单。爱丽丝和鲍勃不需要互相信任，他们各自的冠军也不需要互相认识。明智地选择伴侣也是每个参与者的责任。

就像在加油站网络中一样，DApps 和 Relayers(冠军)可以自由决定他们想要与谁合作，以及他们何时被利用。

注意，这是一个新鲜的想法(新鲜的就像新的和酷的一样)，所以很明显存在需要更好地考虑的不良因素和攻击的边缘情况，但一般来说，系统应该很容易做到足够安全和健壮，以满足大多数用例。

![](img/c73d0ebc792a2917061de08a787d2340.png)

Say my name so my STATE CHANNEL may flow through you! (Image Credit: Warner Bros)

一些想到的事情:

*   如果一个冠军在公开状态的频道中间消失了，你会怎么做？如果 Bob 的冠军消失了，他可以自由选择一个新的冠军，并将他的最新状态副本转发给新的冠军。如果这种行为在 DApp 参与者中普遍存在，DApp 可以决定将这位冠军列入黑名单(或者甚至砍掉鲍勃的冠军)。如果 Bob 的冠军在游戏结束之前提前提交了他的状态，DApp 可以检测到这一点，并提交状态通道仍然打开的证明(例如，来自 Alice 的更新的事务)，这可以用于惩罚冠军。
*   爱丽丝和鲍勃可以自由地选择他们想要的冠军，只要他们都得到适当的补偿。这样会增加安全感(安心？)进行更高价值的交易。虽然如果选择了多个冠军，我倾向于避免花哨的博弈论，但可以实现某种可证明的惩罚机制，以防止联盟为同一用户服务的冠军之间的不当行为。
*   整个过程可以是元事务友好的。
*   这个想法可能有利于推广。在状态通道的开始，Alice 和 Bob 都可以签署一个确定性的状态转移机器，该机器可以由 chain 运行，也可以直接在 chain 上运行。冠军可以计算每个有效的状态，以形成一个可以在链上(或其他冠军的冠军！我完全没有想到…).
*   两方以上的国家频道可以允许一方退出频道，方法是让一个支持者承担希望提前退出的用户的退出成本，并在不关闭频道的情况下收回他们的资金。
*   冠军甚至可以将最新状态的已签名交易发送回 Bob 或 Alice，作为他们诚实行事的“证据”。在这种情况下，Bob 或 Alice 总是可以自由地自己发布这个证明。这与 GSN 网络非常相似，在 GSN 网络中，如果在接收已签名的交易回复时出现延迟，那么 DApp 就有很大的渎职嫌疑。在这一点上，它可以选择一个新的冠军，或者关闭他们收到的最后一个有效状态的通道。
*   需要考虑的是，如果你选择了一个与你的对手勾结的冠军，是否有攻击的媒介。理想情况下，将会有如此多的冠军，两个政党不太可能选择同一个冠军。对这个问题的部分缓解是，用户也可以自由地质疑并返回到 main-net 以从存款合同中取回他们的资金。另一个潜在的解决方案是强制随机选择冠军，以防止任何一个用户被包围。
*   在目前的描述中，这个系统不像正常的状态通道交易那样私密，因为冠军双方都至少知道一半的状态转换。对于简单的价值转移，这很可能不是问题，因为它的私密性不亚于 Alice 和 Bob 在主网络上的最终价值转移。对于复杂的状态转换，可能有必要提出一个隐私保护层来对 Champion 本身隐藏状态转换。
*   冠军可能的抢先(这并不一定会引入任何漏洞)可以通过让 Alice 和 Bob 在与他们的冠军共享他们的状态更新之前彼此共享它们来解决。
*   如果 Alice 试图通过向她的支持者发送与她发送给 Bob 的不同的签名事务来进行欺骗，她的支持者将最终保持无效状态，并且在 Alice 失去连接的情况下将不再能够帮助 Alice。冠军将仍然能够获得报酬，尽管试图提交一个无效的状态，因为该状态将由 Alice 签名。这种情况下，冠军要么砍了爱丽丝，要么决定以后不做她的冠军。

然而，实际上，几乎没有作弊的动机。冠军可以获得可靠的声誉(可能是连锁经营),从而成为“宠儿”。冠军可以共享资源，在意外不可用的情况下互相“覆盖”。DApps 可以购买针对灾难性事件的保险，或者只是作为做生意的成本。冠军无法获得用户资金，因此他们受到激励，努力做到尽可能高效和可靠。

他们还可以设置自己的费用，甚至可能以代币支付(戴！)无论是基于每个交易还是持续时间。可以创建更复杂的状态转换模型，并在状态通道参与者和冠军之间共享，以支持更多的参与者。

我想，最有可能的冠军实际上将是 DApp 服务提供商本身，允许他们的用户以分散的方式进行交互，但当他们的用户在不可靠的系统(如移动网络浏览器)上运行 DApp 时，提供基础设施来实现这一点。

这就是“SHaZAM”的创意州香奈儿冠军网络。下一步是创建一个 ERC，然后创建一个演示。

如果你想了解更多，请通过[电报](https://t.me/Dennisonbertram)或[推特](https://twitter.com/DennisonBertram)联系我！

我是开发者拥护者[齐柏林飞船](https://medium.com/u/4e5199c3ee0a?source=post_page-----b01cf9c7126a--------------------------------)。