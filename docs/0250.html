<html>
<head>
<title>The ultimate RxJS operator</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">终极RxJS操作员</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/the-ultimate-rxjs-operator-fae6414d5db4?source=collection_archive---------9-----------------------#2019-01-10">https://medium.com/hackernoon/the-ultimate-rxjs-operator-fae6414d5db4?source=collection_archive---------9-----------------------#2019-01-10</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="8e43" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">给予console.log它真正应得的爱</h2></div><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff jj"><img src="../Images/adac27c1e535e1993687e68cdcf18746.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H564Cjz69qz0BLrjtoM1gQ.jpeg"/></div></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek">Photo by <a class="ae jz" href="https://unsplash.com/photos/AmhdN68wjPc?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Fauzan Saari</a> on <a class="ae jz" href="https://unsplash.com/search/photos/trophy?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="82c9" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">我有99件感到羞耻的事情，但用<code class="eh kw kx ky kz b">console.log</code>调试不在其中。我的代码充满了它们，我甚至数不过来。我最近发现自己在RxJS管道上记录了太多东西，我还看到了一堆代码库在管道的不同步骤记录值。</p><blockquote class="la"><p id="4dd0" class="lb lc hu bd ld le lf lg lh li lj kv ek translated">我有99件应该感到羞耻的事情，但是用<code class="eh kw kx ky kz b">console.log</code>调试并不是其中之一。</p></blockquote><p id="7bdc" class="pw-post-body-paragraph ka kb hu kc b kd lk iv kf kg ll iy ki kj lm kl km kn ln kp kq kr lo kt ku kv hn dt translated">我相信你也面临过这种情况，你可能为此使用过<code class="eh kw kx ky kz b">map</code>或<code class="eh kw kx ky kz b">tap</code>:</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="lp lq l"/></div></figure><p id="f912" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">现在，让我们拥抱我们的守护进程，接受我们的职业生活依赖于日志的事实。然后，我们将创建一个操作符，使记录RxJS变得轻而易举。一个主宰一切的操作员。<strong class="kc hv">让我们构建终极RxJS运算符</strong>🏆<strong class="kc hv">。</strong></p><p id="2d6e" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">我所说的<em class="lr">微风</em>指的是这样的东西，它会记录“下一次”、“错误”和“完成”:</p><pre class="jk jl jm jn fq ls kz lt lu aw lv dt"><span id="25fd" class="lw lx hu kz b fv ly lz l ma mb">source.pipe(log()).subscribe(...)</span></pre></div><div class="ab cl mc md hc me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="hn ho hp hq hr"><h1 id="e31a" class="mj lx hu bd mk ml mm mn mo mp mq mr ms ja mt jb mu jd mv je mw jg mx jh my mz dt translated">构建日志运算符</h1><p id="a487" class="pw-post-body-paragraph ka kb hu kc b kd na iv kf kg nb iy ki kj nc kl km kn nd kp kq kr ne kt ku kv hn dt translated">我们将逐步构建<code class="eh kw kx ky kz b">log</code>操作符。这实际上会帮助您理解如何创建自己的操作符。事实上，让我感到自豪，并在您的项目中创建一个<code class="eh kw kx ky kz b">utils/operators.ts</code>文件。现在用尽可能多的运算符填充那个东西。<strong class="kc hv">你的代码看起来将是FP-abulous </strong>。</p><ol class=""><li id="b899" class="nf ng hu kc b kd ke kg kh kj nh kn ni kr nj kv nk nl nm nn dt translated">RxJS算子是高阶函数。这意味着<em class="lr">一个函数返回另一个函数</em>。</li></ol><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="lp lq l"/></div></figure><p id="1f10" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">2.然而，返回函数的签名是不完整的。构建操作符的经验法则是:<strong class="kc hv">RxJS操作符必须接收并返回一个可观察值。</strong>让我们开始吧:</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="lp lq l"/></div></figure><p id="f04e" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">3.太多垃圾了，我是来记录东西的！从小我们就被告知，我们需要订阅一个可观察值来获得它的值。因此，如果我们想要记录传入的值，我们需要订阅输入observable并调用console.log。</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="lp lq l"/></div></figure><p id="b90d" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated"><em class="lr">…不过看看dat green console.log吧。</em></p><p id="a2d3" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">4.现在，请记住,<code class="eh kw kx ky kz b">output</code>可观测值将是下一个运营商将订阅的值。因此，如果我们劫持源可观察对象来记录它的值，那么我们必须负责并将值传递给下一个操作者。可以把它想象成<strong class="kc hv">一个只获取值的代理，console.logs它并把它传递给</strong>。我们可以通过做<code class="eh kw kx ky kz b">observer.next(val)</code>来达到这个目的。</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="lp lq l"/></div></figure><p id="f148" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">5.同样的原理也适用于<code class="eh kw kx ky kz b">error</code>和<code class="eh kw kx ky kz b">complete</code>，因此，无论何时我们的源出错或完成，我们的输出也会出错。</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="lp lq l"/></div></figure><p id="66f8" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">6.我们需要小心，因为我们正在创建输入源的内部订阅。在同行评审中，每个人都被告知“适当地处理dat订阅，你想要内存泄漏还是什么”。这种情况很容易通过遵循<a class="ae jz" href="https://github.com/ReactiveX/rxjs/blob/master/doc/operator-creation.md#guidelines" rel="noopener ugc nofollow" target="_blank">官方运营商创建指南</a>来解决，该指南建议只返回内部订阅并忘记它。<strong class="kc hv">让我们这样做，看看我们的操作符最终是什么样子:</strong></p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="lp lq l"/></div></figure><h1 id="2e9b" class="mj lx hu bd mk ml no mn mo mp np mr ms ja nq jb mu jd nr je mw jg ns jh my mz dt translated">让它shine🕺</h1><p id="d93c" class="pw-post-body-paragraph ka kb hu kc b kd na iv kf kg nb iy ki kj nc kl km kn nd kp kq kr ne kt ku kv hn dt translated">是时候使用我们全新的<code class="eh kw kx ky kz b">log</code>操作员了。</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="lp lq l"/></div></figure><p id="411d" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">上面的代码片段在映射前记录日志，然后在平方数字后记录日志(<a class="ae jz" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Arithmetic_Operators#Exponentiation_(**)" rel="noopener ugc nofollow" target="_blank">否，</a>表示<code class="eh kw kx ky kz b"><a class="ae jz" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Arithmetic_Operators#Exponentiation_(**)" rel="noopener ugc nofollow" target="_blank">**</a></code> <a class="ae jz" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Arithmetic_Operators#Exponentiation_(**)" rel="noopener ugc nofollow" target="_blank">不是错别字</a>)，最后在过滤后记录日志。多酷啊。我为你创造了一个闪电战，这样你就可以和操作员玩了。过会儿谢谢我。</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="nt lq l"/></div></figure></div><div class="ab cl mc md hc me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="hn ho hp hq hr"><p id="9de4" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated">我希望你和我一样喜欢记录东西！如果你有兴趣从我这里读到更多的东西，你可能想看看<a class="ae jz" href="https://hackernoon.com/angular-pro-tip-how-to-dynamically-create-components-in-body-ba200cc289e6" rel="noopener ugc nofollow" target="_blank">这篇文章</a>或者<a class="ae jz" href="https://hackernoon.com/deploying-frontend-applications-the-fun-way-bc3f69e15331" rel="noopener ugc nofollow" target="_blank">这篇</a>。我不时地写一些关于web dev的文章，所以考虑订阅或者用掌声来表达我的爱吧！👏👏</p><p id="bca1" class="pw-post-body-paragraph ka kb hu kc b kd ke iv kf kg kh iy ki kj kk kl km kn ko kp kq kr ks kt ku kv hn dt translated"><em class="lr"> PS:我在</em><a class="ae jz" href="https://twitter.com/caroso1222" rel="noopener ugc nofollow" target="_blank"><em class="lr">@ caroso 1222</em></a><em class="lr">得到了DMs开放，以防你想跟进这个帖子或者问我什么。</em></p></div></div>    
</body>
</html>