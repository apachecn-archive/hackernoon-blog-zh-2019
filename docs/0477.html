<html>
<head>
<title>Intercept HTTPS Traffic On A Android Emulator</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在安卓模拟器上拦截HTTPS流量</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/intercept-https-traffic-on-a-android-emulator-46023f17f6b3?source=collection_archive---------2-----------------------#2019-01-19">https://medium.com/hackernoon/intercept-https-traffic-on-a-android-emulator-46023f17f6b3?source=collection_archive---------2-----------------------#2019-01-19</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="7445" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">有时候，我们希望在一个应用程序中看到所有的网络流量。这可能很麻烦，因此我们需要一种简单的方法来完成。<br/>在本文中，我将介绍如何使用MITM(中间人)代理拦截来自Android模拟器的HTTP/HTTPS流量。</p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div class="fe ff jp"><img src="../Images/da1d00507674bd03f1a4b095026654ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:890/format:webp/1*6SPvBeNj336kduC7XnYxmA.jpeg"/></div></figure><p id="6c86" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">开始时，我们需要两样东西</p><ul class=""><li id="bef4" class="jx jy hu it b iu iv iy iz jc jz jg ka jk kb jo kc kd ke kf dt translated"><a class="ae kg" href="https://mitmproxy.org/" rel="noopener ugc nofollow" target="_blank"> Mitmproxy </a>(用于创建我们的代理服务器)</li><li id="3ddf" class="jx jy hu it b iu kh iy ki jc kj jg kk jk kl jo kc kd ke kf dt translated"><a class="ae kg" href="https://developer.android.com/studio/run/emulator" rel="noopener ugc nofollow" target="_blank"> Android模拟器</a>(用于运行应用程序)</li></ul><p id="9fcb" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们从安装Mitmproxy开始，他们的网站上有很好的<a class="ae kg" href="https://mitmproxy.org/" rel="noopener ugc nofollow" target="_blank">安装指南</a>。当使用Mac和自制软件时，你可以做<code class="eh km kn ko kp b">brew install mitmproxy</code>。<br/>安装完Mitmproxy后，我们需要设置一个android模拟器。我们在这里采用的方法要求我们使用低于7的Android版本。我用的是Android 6 (API 23)。</p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="fe ff kq"><img src="../Images/aa7d3f007871596841e3da3cd718c670.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0mUwTX4o0sKkopzG3GuTsw.png"/></div></div><figcaption class="kv kw fg fe ff kx ky bd b be z ek">AVD example of setup with Android 6 (API 23)</figcaption></figure><p id="e156" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">安装完所有需求后，我们将启动代理并设置模拟器来使用它。<br/>为了启动代理，我们运行<code class="eh km kn ko kp b">mitmweb</code>，这将启动一个在端口<code class="eh km kn ko kp b">8080</code>上运行的代理。(<code class="eh km kn ko kp b">mitmweb</code>打开一个显示请求的网站，如果您想在终端中看到它，只需使用<code class="eh km kn ko kp b">mitmproxy</code>代替)<br/>要使用带有仿真器的代理，打开仿真器并进入配置窗口。在配置窗口下，转到<code class="eh km kn ko kp b">Settings</code> → <code class="eh km kn ko kp b">Proxy</code>，将其更改为手动代理配置。<br/>然后输入你电脑的IP地址(可以用<code class="eh km kn ko kp b">ifconfig</code>找到)代理的默认端口是<code class="eh km kn ko kp b">8080</code>。请记住，图像显示的是我的本地IP的例子，你的可能会有所不同。</p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="fe ff kz"><img src="../Images/e3731e4b0cb4835b148fe1bc57e4082d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7_7o7EZ47CkKPHzdOFaTMw.png"/></div></div><figcaption class="kv kw fg fe ff kx ky bd b be z ek">Android emulator settings example for my computer</figcaption></figure><p id="fa35" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在您的代理已经设置好了，下一步是安装证书。要安装证书，请在android模拟器上进入<a class="ae kg" href="http://mitm.it" rel="noopener ugc nofollow" target="_blank"> mitm.it </a>，您应该会看到以下屏幕。</p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div class="fe ff la"><img src="../Images/9be3525519e3dcc968984cd8ff6e8373.png" data-original-src="https://miro.medium.com/v2/resize:fit:510/format:webp/1*6pmvdIptxA0AV-AYWApUhg.png"/></div><figcaption class="kv kw fg fe ff kx ky bd b be z ek">Android emulator showing mitm.it</figcaption></figure><p id="e843" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在这个屏幕上选择android并给证书一个名字。我给我的取名<code class="eh km kn ko kp b">mitm.it</code>，但是名字可以是你喜欢的任何名字。安装证书后，您就可以使用代理了。打开你的应用程序。现在，您可以在浏览器中查看您的请求，以便解决问题。</p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="fe ff lb"><img src="../Images/b636f70874efc02cd37fe584f23c20da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_wq2goC1o4yr1uelXkWoUw.png"/></div></div><figcaption class="kv kw fg fe ff kx ky bd b be z ek">Example of data received through mitmproxy</figcaption></figure><p id="b7f3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">请记住，一些应用程序可能不允许您这样做，因为这可能会违反您同意的条款。</p></div></div>    
</body>
</html>