<html>
<head>
<title>Tokenization Without Tokens</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">没有标记的标记化</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/implementing-asset-ownership-without-tokens-1d5ae0238590?source=collection_archive---------11-----------------------#2019-05-27">https://medium.com/hackernoon/implementing-asset-ownership-without-tokens-1d5ae0238590?source=collection_archive---------11-----------------------#2019-05-27</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="8234" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">如何使用访问控制在区块链中实现资产所有权？</h2></div><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff jj"><img src="../Images/fe9875e32672e5f6ccbe472384c246fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ruRYETS3_uoXJnjlAdp1Bw.jpeg"/></div></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek">Photo by <a class="ae jz" href="https://www.pexels.com/@elevate?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">ELEVATE</a> from <a class="ae jz" href="https://www.pexels.com/photo/person-using-forklift-1267338/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">Pexels</a></figcaption></figure><blockquote class="ka"><p id="f0e1" class="kb kc hu bd kd ke kf kg kh ki kj kk ek translated">科技行业唯一不变的就是变化。—马克·贝尼奥夫</p></blockquote><h1 id="253a" class="kl km hu bd kn ko kp kq kr ks kt ku kv ja kw jb kx jd ky je kz jg la jh lb lc dt translated">介绍</h1><p id="3968" class="pw-post-body-paragraph ld le hu lf b lg lh iv li lj lk iy ll lm ln lo lp lq lr ls lt lu lv lw lx kk hn dt translated">一般认为，要在区块链中表示资产，应该使用ERC721令牌。作为TechHQ的首席架构师，我设计了许多用区块链表示实物资产的解决方案，我发现在供应链场景中，ERC721并不出色。</p><p id="dac6" class="pw-post-body-paragraph ld le hu lf b lg ly iv li lj lz iy ll lm ma lo lp lq mb ls lt lu mc lw lx kk hn dt translated">有向无环图允许更自然地跟踪资产生命周期，在<a class="ae jz" href="https://hackernoon.com/implementing-a-supply-chain-in-the-ethereum-blockchain-dcc91ea718ab" rel="noopener ugc nofollow" target="_blank">以前的文章</a>中我们详细描述了如何实现它。</p><p id="9c10" class="pw-post-body-paragraph ld le hu lf b lg ly iv li lj lz iy ll lm ma lo lp lq mb ls lt lu mc lw lx kk hn dt translated">简而言之，每个资产由一系列状态表示，每个状态记录资产生命周期中的一个事件。状态可以指向过去的状态，并且状态一旦创建就不能修改。</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff md"><img src="../Images/fc833a1d4be0b4a794d5244091c93fe0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*k785o0oF_HzJgJKMs0yMTQ.gif"/></div></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek">Supply Chain as a Directed Acyclic Graph</figcaption></figure><p id="84a5" class="pw-post-body-paragraph ld le hu lf b lg ly iv li lj lz iy ll lm ma lo lp lq mb ls lt lu mc lw lx kk hn dt translated">由于抛弃了ERC721令牌，我们必须想出一种方法来表示资产所有权和转移。</p><p id="2fdc" class="pw-post-body-paragraph ld le hu lf b lg ly iv li lj lz iy ll lm ma lo lp lq mb ls lt lu mc lw lx kk hn dt translated">想想看，来自任何ERC令牌的<em class="me">传输</em>和<em class="me">传输自</em>方法都是一种访问控制形式。<em class="me"> transfer </em>调用只是记录令牌所有权的数据结构的更新，只有特定用户才能执行。一个<em class="me"> transferFrom </em>调用是一个权限委托。</p><p id="d280" class="pw-post-body-paragraph ld le hu lf b lg ly iv li lj lz iy ll lm ma lo lp lq mb ls lt lu mc lw lx kk hn dt translated">我们将不得不实现类似于<em class="me">传输</em>的东西，但是是针对图中的节点。我们必须编写访问控制代码，以便将数据添加到我们的图形结构中。</p><p id="f7a9" class="pw-post-body-paragraph ld le hu lf b lg ly iv li lj lz iy ll lm ma lo lp lq mb ls lt lu mc lw lx kk hn dt translated">为了不用令牌来表示资产所有权和转移，我们正在解构然后重建以太坊生态系统的核心特性之一。请跟我进兔子洞。</p><h1 id="1287" class="kl km hu bd kn ko kp kq kr ks kt ku kv ja mf jb kx jd mg je kz jg mh jh lb lc dt translated">概念解</h1><p id="26d9" class="pw-post-body-paragraph ld le hu lf b lg lh iv li lj lk iy ll lm ln lo lp lq lr ls lt lu lv lw lx kk hn dt translated">在我们的供应链中，每一项资产都被描绘成一系列相互关联的状态。随着资产经历其生命周期，我们附加更多的状态，表示诸如转换、组合、破坏等事件。</p><p id="0a18" class="pw-post-body-paragraph ld le hu lf b lg ly iv li lj lz iy ll lm ma lo lp lq mb ls lt lu mc lw lx kk hn dt translated">只有资产的所有者能够向其生命周期添加新的状态。只要所有者愿意，他就可以将这一权利让给其他人。他也应该能够为了别人而失去将国家附加到资产上的权利。</p><p id="bff0" class="pw-post-body-paragraph ld le hu lf b lg ly iv li lj lz iy ll lm ma lo lp lq mb ls lt lu mc lw lx kk hn dt translated">对附加状态的这种限制表示每个资产的所有权。资产的所有权控制着对它的访问。</p><p id="0da4" class="pw-post-body-paragraph ld le hu lf b lg ly iv li lj lz iy ll lm ma lo lp lq mb ls lt lu mc lw lx kk hn dt translated">一个真实世界的场景可以帮助我们更清楚地想象我们的用例。</p><ul class=""><li id="8da4" class="mi mj hu lf b lg ly lj lz lm mk lq ml lu mm kk mn mo mp mq dt translated">比方说，我拥有一家制造厂，接收材料，将其转化为小工具，然后卖给经销商。</li><li id="14ff" class="mi mj hu lf b lg mr lj ms lm mt lq mu lu mv kk mn mo mp mq dt translated">当材料到达我的工厂时，我获得了它们的所有权，并委托给我的工厂操作员。</li><li id="f03b" class="mi mj hu lf b lg mr lj ms lm mt lq mu lu mv kk mn mo mp mq dt translated">我的操作员将材料转换成小工具，记录供应链图中的步骤。</li><li id="eb34" class="mi mj hu lf b lg mr lj ms lm mt lq mu lu mv kk mn mo mp mq dt translated">然后，我将把这些小工具连同向它们添加状态的权限一起交给分发者。</li></ul><p id="e5f8" class="pw-post-body-paragraph ld le hu lf b lg ly iv li lj lz iy ll lm ma lo lp lq mb ls lt lu mc lw lx kk hn dt translated">我们现在将使用我们最近发布的<a class="ae jz" href="https://hackernoon.com/role-based-access-control-for-the-ethereum-blockchain-bcc9dfbcfe5c" rel="noopener ugc nofollow" target="_blank">基于角色的访问控制</a>库来实现这些功能，而<a class="ae jz" href="https://hackernoon.com/role-based-access-control-for-the-ethereum-blockchain-bcc9dfbcfe5c" rel="noopener ugc nofollow" target="_blank">出现在这个媒体的首页</a>。</p><h1 id="f14d" class="kl km hu bd kn ko kp kq kr ks kt ku kv ja mf jb kx jd mg je kz jg mh jh lb lc dt translated">履行</h1><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff mw"><img src="../Images/826351d7012ce4a1818f098b05885b99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*izD1vicqsCMzQIBwkqiFZw.gif"/></div></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek">Using access control to represent asset ownership on a supply chain</figcaption></figure><p id="b0c1" class="pw-post-body-paragraph ld le hu lf b lg ly iv li lj lz iy ll lm ma lo lp lq mb ls lt lu mc lw lx kk hn dt translated">在最初的供应链图实现中，我们为每个状态记录了三个数据项。</p><ul class=""><li id="8d14" class="mi mj hu lf b lg ly lj lz lm mk lq ml lu mm kk mn mo mp mq dt translated">创建状态的帐户；</li><li id="731e" class="mi mj hu lf b lg mr lj ms lm mt lq mu lu mv kk mn mo mp mq dt translated">国家所指的资产</li><li id="aed9" class="mi mj hu lf b lg mr lj ms lm mt lq mu lu mv kk mn mo mp mq dt translated">先例表明。</li></ul><p id="e4d4" class="pw-post-body-paragraph ld le hu lf b lg ly iv li lj lz iy ll lm ma lo lp lq mb ls lt lu mc lw lx kk hn dt translated">为了实现所有权概念，我将在每个状态中添加两个变量:</p><ul class=""><li id="c288" class="mi mj hu lf b lg ly lj lz lm mk lq ml lu mm kk mn mo mp mq dt translated">可以创建新资产并将其移交给其他用户的所有者角色</li><li id="b58f" class="mi mj hu lf b lg mr lj ms lm mt lq mu lu mv kk mn mo mp mq dt translated">以及可以在不改变所有权的情况下向资产添加新状态的操作员角色。</li></ul><p id="916b" class="pw-post-body-paragraph ld le hu lf b lg ly iv li lj lz iy ll lm ma lo lp lq mb ls lt lu mc lw lx kk hn dt translated">下面你可以看到基本的契约实现，包括事件、结构、契约变量和助手方法。</p><pre class="jk jl jm jn fq mx my mz na aw nb dt"><span id="1e87" class="nc km hu my b fv nd ne l nf ng">contract SupplyChain is RBAC {</span><span id="4c71" class="nc km hu my b fv nh ne l nf ng">uint256 constant public NO_STATE = 0;</span><span id="7017" class="nc km hu my b fv nh ne l nf ng">event <strong class="my hv">StateCreated</strong>(uint256 state);</span><span id="4e38" class="nc km hu my b fv nh ne l nf ng">event <strong class="my hv">AssetCreated</strong>(uint256 asset);</span><span id="5587" class="nc km hu my b fv nh ne l nf ng">struct <strong class="my hv">State</strong> {<br/>        address creator;<br/>        uint256 asset;<br/>        uint256 precedent;<br/>        uint256 operatorRole;<br/>        uint256 ownerRole;<br/>    }</span><span id="385e" class="nc km hu my b fv nh ne l nf ng">State[] public <strong class="my hv">states</strong>;</span><span id="1fd4" class="nc km hu my b fv nh ne l nf ng">mapping(uint256 =&gt; uint256) public <strong class="my hv">lastStates</strong>;</span><span id="652a" class="nc km hu my b fv nh ne l nf ng">uint256 public <strong class="my hv">totalAssets</strong>;</span><span id="f6f3" class="nc km hu my b fv nh ne l nf ng">function <strong class="my hv">isAsset<br/>    </strong>(<br/>        uint256 _asset<br/>    )<br/>        public<br/>        view<br/>        returns(bool)<br/>    {<br/>        return lastStates[_asset] != 0;<br/>    }</span><span id="562c" class="nc km hu my b fv nh ne l nf ng">function <strong class="my hv">isOperator<br/>    </strong>(<br/>        address _address, <br/>        uint256 _asset<br/>    )<br/>        public<br/>        view<br/>        returns(uint256)<br/>    {<br/>        State memory lastState = states[lastStates[_asset]];<br/>        return hasRole(_address, lastState.operatorRole);<br/>    }</span><span id="5333" class="nc km hu my b fv nh ne l nf ng">function <strong class="my hv">isOwner<br/>    </strong>(<br/>        address _address, <br/>        uint256 _asset<br/>    )<br/>        public<br/>        view<br/>        returns(uint256)<br/>    {<br/>        State memory lastState = states[lastStates[_asset]];<br/>        return hasRole(_address, lastState.ownerRole);<br/>    }</span></pre><p id="a33b" class="pw-post-body-paragraph ld le hu lf b lg ly iv li lj lz iy ll lm ma lo lp lq mb ls lt lu mc lw lx kk hn dt translated">我现在将实现三个新函数，在我们的三个新用例中向供应链图添加状态:</p><ul class=""><li id="25a8" class="mi mj hu lf b lg ly lj lz lm mk lq ml lu mm kk mn mo mp mq dt translated">通过添加没有先例的状态来创建新资产；</li><li id="6e5f" class="mi mj hu lf b lg mr lj ms lm mt lq mu lu mv kk mn mo mp mq dt translated">在考虑所有权的情况下，向现有资产添加新状态</li><li id="796a" class="mi mj hu lf b lg mr lj ms lm mt lq mu lu mv kk mn mo mp mq dt translated">并且将资产的控制权移交给不同的账户。</li></ul><pre class="jk jl jm jn fq mx my mz na aw nb dt"><span id="e65f" class="nc km hu my b fv nd ne l nf ng">    function <strong class="my hv">createAsset<br/>    </strong>(<br/>        uint256 _operatorRole,<br/>        uint256 _ownerRole<br/>    )<br/>        public<br/>    {<br/>        require(<br/>            hasRole(msg.sender, _ownerRole), <br/>            “Creator not in ownerRole.”<br/>        );</span><span id="f5ec" class="nc km hu my b fv nh ne l nf ng">        totalAssets += 1;<br/>        asset = totalAssets;<br/>        emit AssetCreated(asset);<br/>        <br/>        uint256 stateId = states.push(<br/>            State(<br/>                msg.sender,<br/>                totalAssets,<br/>                NO_STATE,<br/>                _operatorRole,<br/>                _ownerRole<br/>            )<br/>        ) — 1;<br/>        lastStates[asset] = stateId;<br/>        emit StateCreated(stateId);<br/>    }</span><span id="6176" class="nc km hu my b fv nh ne l nf ng">    function <strong class="my hv">addState<br/>    </strong>(<br/>        uint256 _asset<br/>    )<br/>        public<br/>    {<br/>        require(<br/>            isAsset(_asset), <br/>            “Asset does not exist.”<br/>        );<br/>        require(<br/>            isOperator(msg.sender, _asset),<br/>            “Not an operator of asset.”<br/>        );</span><span id="78fc" class="nc km hu my b fv nh ne l nf ng">        uint256 precedent = lastStates[_asset];<br/>        uint256 stateId = states.push(<br/>            State(<br/>                msg.sender,<br/>                _asset,<br/>                precedent,<br/>                states[precedent].operatorRole,<br/>                states[precedent].ownerRole<br/>            )<br/>        ) — 1;<br/>        lastStates[_asset] = stateId;<br/>        emit StateCreated(stateId);<br/>    }</span><span id="7b2e" class="nc km hu my b fv nh ne l nf ng">    function <strong class="my hv">handoverAsset<br/>    </strong>(<br/>        uint256 _action,<br/>        uint256 _asset,<br/>        uint256 _operatorRole,<br/>        uint256 _ownerRole<br/>    )<br/>        public<br/>    {<br/>        require(<br/>            isAsset(_asset), <br/>            “Asset does not exist.”<br/>        );<br/>        require(<br/>            isOwner(msg.sender, _asset), <br/>            “Needs owner for handover.”<br/>        );</span><span id="3aea" class="nc km hu my b fv nh ne l nf ng">        precedent = lastStates[_asset];<br/>        uint256 stateId = states.push(<br/>            State(<br/>                msg.sender,<br/>                _asset,<br/>                precedent,<br/>                operatorRole,<br/>                ownerRole<br/>            )<br/>        ) — 1;<br/>        lastStates[_asset] = stateId;<br/>        emit StateCreated(stateId);<br/>    }<br/>}</span></pre><p id="0108" class="pw-post-body-paragraph ld le hu lf b lg ly iv li lj lz iy ll lm ma lo lp lq mb ls lt lu mc lw lx kk hn dt translated">insiġ库有这个代码的全功能版本。为了简单起见，我在本文中删除了每个州有多个先例的功能。</p><h1 id="10cb" class="kl km hu bd kn ko kp kq kr ks kt ku kv ja mf jb kx jd mg je kz jg mh jh lb lc dt translated">结论</h1><p id="8a85" class="pw-post-body-paragraph ld le hu lf b lg lh iv li lj lk iy ll lm ln lo lp lq lr ls lt lu lv lw lx kk hn dt translated">在本文中，我们展示了如何为供应链实现资产所有权。我们解构了ERC721方法的目的，以表明实际上资产所有权是一种访问控制形式。</p><p id="a360" class="pw-post-body-paragraph ld le hu lf b lg ly iv li lj lz iy ll lm ma lo lp lq mb ls lt lu mc lw lx kk hn dt translated">在实现中，我们通过控制谁可以向特定资产添加新状态来表示资产所有权。为了表示资产转移，所有者更改资产最后状态中的权限。</p><p id="6852" class="pw-post-body-paragraph ld le hu lf b lg ly iv li lj lz iy ll lm ma lo lp lq mb ls lt lu mc lw lx kk hn dt translated">本文和实现是制造业供应链新解决方案的一部分。我们正在颠覆我们所知道的我们所消费的东西，并释放出目前与实物资产挂钩的大量投资资本。</p><p id="4a8c" class="pw-post-body-paragraph ld le hu lf b lg ly iv li lj lz iy ll lm ma lo lp lq mb ls lt lu mc lw lx kk hn dt translated">接下来还有更多。在以后的文章中，我们将展示如何表示资产的合并和分割，以及如何在所描述的供应链中标记资产。</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="ni nj l"/></div></figure></div></div>    
</body>
</html>