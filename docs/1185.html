<html>
<head>
<title>Make Your Own Youtube player in React using youtube data API v3</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 youtube 数据 API v3 在 React 中制作自己的 Youtube 播放器</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/make-your-own-youtube-player-in-react-using-youtube-data-api-v3-4b9bb5403a87#2019-02-19">https://medium.com/hackernoon/make-your-own-youtube-player-in-react-using-youtube-data-api-v3-4b9bb5403a87#2019-02-19</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/8eeecd9963fcfc9ebf8a2999e5555073.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*mWjBT-KdENGTx6u4"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">Photo by <a class="ae jg" href="https://unsplash.com/@rachitank?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Rachit Tank</a> on <a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="1b2e" class="jh ji hu bd jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dt translated">那计划是什么？🤔</h1><p id="820c" class="pw-post-body-paragraph kf kg hu kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">所以，在这个故事中，我将带你走过如何制作你自己的 Youtube 播放器的整个旅程。这很简单，我保证你会在一个小时内准备好你自己的播放器。太神奇了，不是吗？我们的最终结果将看起来像<a class="ae jg" href="http://ytsearch.surge.sh/" rel="noopener ugc nofollow" target="_blank">这个</a>。如果你浏览了这个链接，你可能会注意到一些事情。这些视频将通过他们提供的 API 直接从 youtube 数据库中获取。你们中的一些人可能已经看到了像超出每日限额这样的错误信息。哎呀，这意味着谷歌已经给了这个 API 有限的访问权限。因此，在创建项目时，请确保不要过多地使用 API，否则您将不得不等待第二天😃为你的配额充值。说够了。让我们制定一个循序渐进的计划。这里是 GitHub 库的<a class="ae jg" href="https://github.com/dsc712/Youtube-Player-In-React" rel="noopener ugc nofollow" target="_blank">链接</a>，如果你想边看边看代码的话。</p><h2 id="ab66" class="ld ji hu bd jj le lf lg jn lh li lj jr kq lk ll jv ku lm ln jz ky lo lp kd lq dt translated">项目的逐步规划</h2><ol class=""><li id="e2c3" class="lr ls hu kh b ki kj km kn kq lt ku lu ky lv lc lw lx ly lz dt translated">首先，我们将从<a class="ae jg" href="https://console.developers.google.com/" rel="noopener ugc nofollow" target="_blank">谷歌开发者控制台</a>获取 API 密钥。</li><li id="ece0" class="lr ls hu kh b ki ma km mb kq mc ku md ky me lc lw lx ly lz dt translated">我们将使用 facebook 的<a class="ae jg" href="https://facebook.github.io/create-react-app/" rel="noopener ugc nofollow" target="_blank"> create-react-app </a>开始我们的项目。</li><li id="8d6d" class="lr ls hu kh b ki ma km mb kq mc ku md ky me lc lw lx ly lz dt translated">我们将安装 npm 包'<a class="ae jg" href="https://www.npmjs.com/package/youtube-api-search" rel="noopener ugc nofollow" target="_blank"> youtube-api-search </a>'。</li><li id="cc13" class="lr ls hu kh b ki ma km mb kq mc ku md ky me lc lw lx ly lz dt translated">对于 UI，我们会使用阿里巴巴著名的 React UI 库<a class="ae jg" href="https://ant.design/" rel="noopener ugc nofollow" target="_blank">蚂蚁设计</a>。</li><li id="38d0" class="lr ls hu kh b ki ma km mb kq mc ku md ky me lc lw lx ly lz dt translated">对于响应式 iframe，我们将使用一点自举。</li><li id="12c9" class="lr ls hu kh b ki ma km mb kq mc ku md ky me lc lw lx ly lz dt translated">最后，我们将对 youtube 播放器进行编码。</li><li id="026d" class="lr ls hu kh b ki ma km mb kq mc ku md ky me lc lw lx ly lz dt translated">最后，我们将使用<a class="ae jg" href="https://surge.sh/" rel="noopener ugc nofollow" target="_blank"> surge </a>托管我们的项目。面向前端 web 开发人员的静态 web 发布工具。</li></ol><h1 id="73ad" class="jh ji hu bd jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dt translated">让我们开始一些真正的行动💯</h1><h2 id="5bb1" class="ld ji hu bd jj le lf lg jn lh li lj jr kq lk ll jv ku lm ln jz ky lo lp kd lq dt translated">1.获取 API 密钥🔑</h2><p id="6a34" class="pw-post-body-paragraph kf kg hu kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">首先，让我们获得 API 密钥。访问<a class="ae jg" href="https://console.developers.google.com/" rel="noopener ugc nofollow" target="_blank">这个</a>并打开你的谷歌开发者仪表板，搜索<strong class="kh hv"> Youtube 数据 API V3。</strong>启用 API 并移至凭证部分，您可以在此处看到您的 API 密钥。您可以在项目中随时使用它。所以我们已经准备好了。</p><h2 id="f0bd" class="ld ji hu bd jj le lf lg jn lh li lj jr kq lk ll jv ku lm ln jz ky lo lp kd lq dt translated">2.使用 create-react-app 启动项目😑</h2><pre class="mf mg mh mi fq mj mk ml mm aw mn dt"><span id="7696" class="ld ji hu mk b fv mo mp l mq mr">npx create-react-app myapp<br/>cd myapp<br/>yarn start</span></pre><p id="569b" class="pw-post-body-paragraph kf kg hu kh b ki ms kk kl km mt ko kp kq mu ks kt ku mv kw kx ky mw la lb lc hn dt translated">就是这样。我们有一些项目的启动代码。只要我们在终端点击<code class="eh mx my mz mk b">yarn start</code>。一个开发服务器启动了，我们的项目在<code class="eh mx my mz mk b">localhost:3000/</code>托管</p><h2 id="27d7" class="ld ji hu bd jj le lf lg jn lh li lj jr kq lk ll jv ku lm ln jz ky lo lp kd lq dt translated">3.让我们在项目中安装 youtube-api-search</h2><pre class="mf mg mh mi fq mj mk ml mm aw mn dt"><span id="c8e1" class="ld ji hu mk b fv mo mp l mq mr">$ yarn add youtube-api-search </span></pre><h2 id="09ae" class="ld ji hu bd jj le lf lg jn lh li lj jr kq lk ll jv ku lm ln jz ky lo lp kd lq dt translated">4.在项目中添加 antd React UI 库</h2><pre class="mf mg mh mi fq mj mk ml mm aw mn dt"><span id="33f2" class="ld ji hu mk b fv mo mp l mq mr">$ yarn add antd</span></pre><p id="f27a" class="pw-post-body-paragraph kf kg hu kh b ki ms kk kl km mt ko kp kq mu ks kt ku mv kw kx ky mw la lb lc hn dt translated">现在在<code class="eh mx my mz mk b">src/App.css</code>的顶部加上<code class="eh mx my mz mk b">antd/dist/antd.css</code></p><pre class="mf mg mh mi fq mj mk ml mm aw mn dt"><span id="b7bb" class="ld ji hu mk b fv mo mp l mq mr">@import ‘~antd/dist/antd.css’;</span><span id="a8ed" class="ld ji hu mk b fv na mp l mq mr">.App { <br/>   text-align: center; <br/> } </span></pre><p id="7a5b" class="pw-post-body-paragraph kf kg hu kh b ki ms kk kl km mt ko kp kq mu ks kt ku mv kw kx ky mw la lb lc hn dt translated">现在我们准备在我们的 create-react-app 中使用 ant 设计。</p><h2 id="ae84" class="ld ji hu bd jj le lf lg jn lh li lj jr kq lk ll jv ku lm ln jz ky lo lp kd lq dt translated">5.添加自举 CDN 在(<code class="eh mx my mz mk b">public/index.html )</code> &lt;头&gt;&lt;/头&gt;</h2><pre class="mf mg mh mi fq mj mk ml mm aw mn dt"><span id="307d" class="ld ji hu mk b fv mo mp l mq mr">&lt;head&gt;<br/>&lt;link <em class="nb">rel=</em>"stylesheet" <em class="nb">href=</em>"https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" /&gt;<br/>&lt;/head&gt;</span></pre><p id="ef60" class="pw-post-body-paragraph kf kg hu kh b ki ms kk kl km mt ko kp kq mu ks kt ku mv kw kx ky mw la lb lc hn dt translated">酷，现在我们准备开始写一些 react 代码。</p><h2 id="4924" class="ld ji hu bd jj le lf lg jn lh li lj jr kq lk ll jv ku lm ln jz ky lo lp kd lq dt translated">6.让我们最后编码 Youtube 播放器😃</h2><p id="6871" class="pw-post-body-paragraph kf kg hu kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">现在让我们首先在<strong class="kh hv">中添加<strong class="kh hv"> API 键</strong>。env </strong>文件。通常我们使用 npm 的<strong class="kh hv"> dotenv </strong>包来完成。但是你可能想知道，我还没有告诉你安装 dotenv 包。实际上，这个包预装了 create-react-app。现在有一种在 create-react-app 中添加环境变量的特殊方法。您必须为您的环境变量加上前缀<code class="eh mx my mz mk b">REACT_APP_</code>。不然就不行了。此外，在本地主机上工作时，您需要<code class="eh mx my mz mk b">.env.development</code>文件，而生产构建<code class="eh mx my mz mk b">.env</code>文件将完成这项工作。</p><p id="99fe" class="pw-post-body-paragraph kf kg hu kh b ki ms kk kl km mt ko kp kq mu ks kt ku mv kw kx ky mw la lb lc hn dt translated">所以，让我们把这两个文件放在项目的根目录下。并添加变量，如</p><pre class="mf mg mh mi fq mj mk ml mm aw mn dt"><span id="e4e7" class="ld ji hu mk b fv mo mp l mq mr"><em class="nb">REACT_APP_API_KEY</em>='your_api_key_jdfe39u3cmijsd'</span></pre><h2 id="de3b" class="ld ji hu bd jj le lf lg jn lh li lj jr kq lk ll jv ku lm ln jz ky lo lp kd lq dt translated">为我们的应用程序规划组件</h2><p id="dbd0" class="pw-post-body-paragraph kf kg hu kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">使用 App 作为根组件，我们将需要另外 4 个组件<strong class="kh hv"> SearchBar </strong>、<strong class="kh hv"> VideoDetail </strong>、<strong class="kh hv"> VideoList </strong>和<strong class="kh hv"> VideoListItem </strong>。因此，在项目的<strong class="kh hv"> src </strong>目录中创建一个目录名<strong class="kh hv"> Components </strong>。</p><pre class="mf mg mh mi fq mj mk ml mm aw mn dt"><span id="76b6" class="ld ji hu mk b fv mo mp l mq mr">└── src<br/> └── Components<br/>     <!-- --> <!-- -->├── SearchBar.js<br/>      ├── VideoDetail.js <br/>      ├── VideoList.js<br/>      ├── VideoListItem.js<br/>  ├──App.js<br/>   ...</span></pre><p id="1070" class="pw-post-body-paragraph kf kg hu kh b ki ms kk kl km mt ko kp kq mu ks kt ku mv kw kx ky mw la lb lc hn dt translated">让我们用一些生活❤ ️.来填充这些组件</p><h2 id="8c4d" class="ld ji hu bd jj le lf lg jn lh li lj jr kq lk ll jv ku lm ln jz ky lo lp kd lq dt translated">App.js(我们的根组件)</h2><figure class="mf mg mh mi fq iv"><div class="bz el l di"><div class="nc nd l"/></div></figure><p id="59f4" class="pw-post-body-paragraph kf kg hu kh b ki ms kk kl km mt ko kp kq mu ks kt ku mv kw kx ky mw la lb lc hn dt translated">在这个组件中有一些事情需要注意。首先，<strong class="kh hv"> welcome()方法</strong>。它用于向用户发出<strong class="kh hv">欢迎通知</strong>。为此，我使用了 antd 的<strong class="kh hv">通知组件。第二个<strong class="kh hv">，handleChange()方法</strong>应用于<strong class="kh hv"> SearchBar 组件</strong>的 onChange 属性。一旦我们开始在 SearchBar 中输入内容，handleChange()方法就会触发。那就是一个<strong class="kh hv">受控组件</strong>是什么。从 handleChange()方法内部，我们调用了<strong class="kh hv"> videoSearch()方法。</strong>现在来看‘YouTube-API-search’包的使用。这个包返回一个函数，我们可以用它向 youtube API 发出请求。这个函数接受一个对象作为第一个参数，它有一个名为 key 的键，在这里您需要提供您的 API 键作为一个值。另一个关键字名为 term，它将搜索项作为值。第二个参数是回调。请求一完成，这个 API 就以 5 个对象的数组的形式返回数据，这些对象包含所获取的视频的细节。如果超过了每日限制，它会返回一个不同类型的对象，我已经在 try/catch 块中处理过了。这里我维护了两个状态变量，一个是包含 5 个视频数组的视频，它将显示在视频列表组件中，另一个是选择的视频，它将被播放。此外，我们还使用了一个布尔型的状态变量搜索。在 handleChange()方法中，我使用了几个 setTimeouts 来控制对 API 的请求数量。也可以通过<a class="ae jg" href="https://www.npmjs.com/package/react-debounce-input" rel="noopener ugc nofollow" target="_blank">反作用去抖</a>来完成。但是也很好。这就是我们的根组件。</strong></p><h2 id="4ba2" class="ld ji hu bd jj le lf lg jn lh li lj jr kq lk ll jv ku lm ln jz ky lo lp kd lq dt translated">SearchBar.js</h2><figure class="mf mg mh mi fq iv"><div class="bz el l di"><div class="nc nd l"/></div></figure><p id="63c8" class="pw-post-body-paragraph kf kg hu kh b ki ms kk kl km mt ko kp kq mu ks kt ku mv kw kx ky mw la lb lc hn dt translated">这里，我使用了来自 antd 的<a class="ae jg" href="https://ant.design/components/auto-complete/" rel="noopener ugc nofollow" target="_blank">自动完成</a>组件。并且，我用 5 个视频填充这个自动完成组件，这些视频来自基于搜索词的 API。酷，我们已经准备好了一个带有自动完成功能的搜索栏。</p><h2 id="15f7" class="ld ji hu bd jj le lf lg jn lh li lj jr kq lk ll jv ku lm ln jz ky lo lp kd lq dt translated"><strong class="ak">视频列表. js </strong></h2><figure class="mf mg mh mi fq iv"><div class="bz el l di"><div class="nc nd l"/></div></figure><p id="ebe3" class="pw-post-body-paragraph kf kg hu kh b ki ms kk kl km mt ko kp kq mu ks kt ku mv kw kx ky mw la lb lc hn dt translated">在这里，我们的视频列表有两种状态，一种是当列表为空时，另一种是当列表充满视频建议时。你可以在上面的代码中看到，我是如何处理的。</p><h2 id="1175" class="ld ji hu bd jj le lf lg jn lh li lj jr kq lk ll jv ku lm ln jz ky lo lp kd lq dt translated">VideoListItem.js</h2><figure class="mf mg mh mi fq iv"><div class="bz el l di"><div class="nc nd l"/></div></figure><h2 id="404a" class="ld ji hu bd jj le lf lg jn lh li lj jr kq lk ll jv ku lm ln jz ky lo lp kd lq dt translated">视频细节. js</h2><figure class="mf mg mh mi fq iv"><div class="bz el l di"><div class="nc nd l"/></div></figure><p id="903c" class="pw-post-body-paragraph kf kg hu kh b ki ms kk kl km mt ko kp kq mu ks kt ku mv kw kx ky mw la lb lc hn dt translated">这里，我们简单地使用了一个 iframe 来播放 youtube 视频。并使用了 bootstrap 中的几个类来提高它的响应能力。</p><p id="7c8e" class="pw-post-body-paragraph kf kg hu kh b ki ms kk kl km mt ko kp kq mu ks kt ku mv kw kx ky mw la lb lc hn dt translated">这就是我们准备好的 Youtube 播放器。</p><h2 id="4ecc" class="ld ji hu bd jj le lf lg jn lh li lj jr kq lk ll jv ku lm ln jz ky lo lp kd lq dt translated">现在托管与激增</h2><p id="1670" class="pw-post-body-paragraph kf kg hu kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc hn dt translated">如果你以前没有使用过 surge，让我告诉你这是部署你的前端应用程序最简单的方法。检查此<a class="ae jg" href="https://surge.sh/help/getting-started-with-surge" rel="noopener ugc nofollow" target="_blank">出</a>开始与浪涌。</p><p id="2eb6" class="pw-post-body-paragraph kf kg hu kh b ki ms kk kl km mt ko kp kq mu ks kt ku mv kw kx ky mw la lb lc hn dt translated">现在如何使用 surge 托管 create-react-app。首先，您必须创建一个生产版本。</p><pre class="mf mg mh mi fq mj mk ml mm aw mn dt"><span id="36ed" class="ld ji hu mk b fv mo mp l mq mr">$ myapp/ yarn build</span></pre><p id="36c2" class="pw-post-body-paragraph kf kg hu kh b ki ms kk kl km mt ko kp kq mu ks kt ku mv kw kx ky mw la lb lc hn dt translated">这将为您创建一个优化的构建。一个构建目录将进入你的项目的根目录。现在，您可以使用 surge 托管您的应用程序。</p><pre class="mf mg mh mi fq mj mk ml mm aw mn dt"><span id="5203" class="ld ji hu mk b fv mo mp l mq mr">$ myapp/ cd build<br/>$ myapp/build/ surge</span></pre><p id="e8cc" class="pw-post-body-paragraph kf kg hu kh b ki ms kk kl km mt ko kp kq mu ks kt ku mv kw kx ky mw la lb lc hn dt translated">加油🎉 🎉 🎉 🎉。您已经部署了自己的 youtube 播放器。</p><p id="3ac2" class="pw-post-body-paragraph kf kg hu kh b ki ms kk kl km mt ko kp kq mu ks kt ku mv kw kx ky mw la lb lc hn dt translated">如果你真的喜欢这个故事，请鼓掌几次(最多 50 次😃 ).更多类似的故事，请跟我来。</p></div></div>    
</body>
</html>