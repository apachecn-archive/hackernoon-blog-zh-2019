<html>
<head>
<title>Stock Market Prediction &amp; Clustering</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">股票市场预测和聚类</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/stock-market-prediction-clustering-32e59bf61ff2#2019-04-25">https://medium.com/hackernoon/stock-market-prediction-clustering-32e59bf61ff2#2019-04-25</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="f033" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt jp translated">股票市场是最动态、最不稳定的数据来源之一。<br/>随着<strong class="it hv">金钱永不停歇</strong>，每秒钟都会产生数据。股票价值的变化是市场和人们情绪变化的结果。</p><figure class="jz ka kb kc fq kd fe ff paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="fe ff jy"><img src="../Images/ce4a39f8fa9dd2d47abdd35d5dd0f961.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w5Ee58wup7Nw6bc2u_305A.jpeg"/></div></div></figure><p id="8613" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在这个项目中，我们试图预测<strong class="it hv">印度国家证券交易所</strong> (NSE)在一段时间内涨幅居前和跌幅居前的股票。这将用于股票聚类。</p><p id="c8d1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这是一个基于 python 的项目，使用机器学习来预测第二天的股票价值。</p><figure class="jz ka kb kc fq kd fe ff paragraph-image"><div class="fe ff kk"><img src="../Images/c7d59b1b2522630df17d08b6bf87354e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1270/format:webp/1*Ud0yUPUNSVU5XrPHBjytyg.png"/></div></figure></div><div class="ab cl kl km hc kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="hn ho hp hq hr"><h2 id="77db" class="ks kt hu bd ku kv kw kx ky kz la lb lc jc ld le lf jg lg lh li jk lj lk ll lm dt translated">数据</h2><p id="fbe0" class="pw-post-body-paragraph ir is hu it b iu ln iw ix iy lo ja jb jc lp je jf jg lq ji jj jk lr jm jn jo hn dt translated">因为我们考虑的数据来自 NSE，所以我们使用 nsepy 和 nsetools 库来获取数据。nsepy 为所提供的符号提供日常数据。</p><p id="351d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><a class="ae ls" href="https://www.nseindia.com/" rel="noopener ugc nofollow" target="_blank"> NSE 官网</a></p><p id="34fe" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><a class="ae ls" href="https://www.nseindia.com/products/content/derivatives/equities/fo_underlying_home.htm" rel="noopener ugc nofollow" target="_blank"> NSE 符号列表</a></p><figure class="jz ka kb kc fq kd"><div class="bz el l di"><div class="lt lu l"/></div></figure><p id="bedc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">选取 4 家公司进行预测</p><figure class="jz ka kb kc fq kd fe ff paragraph-image"><div class="fe ff lv"><img src="../Images/34a6e6b58321657caeaa29b5a6194ce5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1072/format:webp/1*NvQys6cEt13GF0ck-HcmBw.png"/></div></figure><ol class=""><li id="87c7" class="lw lx hu it b iu iv iy iz jc ly jg lz jk ma jo mb mc md me dt translated">旅群</li><li id="41e9" class="lw lx hu it b iu mf iy mg jc mh jg mi jk mj jo mb mc md me dt translated">高德瑞地产有限公司</li><li id="9192" class="lw lx hu it b iu mf iy mg jc mh jg mi jk mj jo mb mc md me dt translated">ITC 有限公司</li><li id="da5e" class="lw lx hu it b iu mf iy mg jc mh jg mi jk mj jo mb mc md me dt translated">信实工业有限公司</li></ol><h2 id="16d2" class="ks kt hu bd ku kv kw kx ky kz la lb lc jc ld le lf jg lg lh li jk lj lk ll lm dt translated">预处理</h2><p id="2898" class="pw-post-body-paragraph ir is hu it b iu ln iw ix iy lo ja jb jc lp je jf jg lq ji jj jk lr jm jn jo hn dt translated">该模型主要使用 4 个特征进行预测，即开盘、盘高、盘低和收盘。因此，我们放弃了数据帧中的额外功能。</p><figure class="jz ka kb kc fq kd fe ff paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="fe ff mk"><img src="../Images/fa86a652ed7a93d1270278cc81c499e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ToGXDjfV1KvXgvYmXczbRw.png"/></div></div></figure><p id="26dc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">数据帧中添加了 2 个功能，这提供了洞察力。</p><ol class=""><li id="ae0f" class="lw lx hu it b iu iv iy iz jc ly jg lz jk ma jo mb mc md me dt translated">变化——代表股票每天的变化或波动。</li><li id="0798" class="lw lx hu it b iu mf iy mg jc mh jg mi jk mj jo mb mc md me dt translated">收益-代表日常价值的收益或损失的分类特征。</li></ol><p id="2e20" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">一旦去掉了额外的特征，我们就有了上市股票的<em class="ml"> df.head() </em>和<em class="ml"> df.describe() </em>，分别提供了数据帧的前 5 个值和统计描述。</p><figure class="jz ka kb kc fq kd fe ff paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="fe ff mm"><img src="../Images/be713028bb1abd6950531e42b14af82d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5sXHoPtXhnjLnJekhvBBzQ.png"/></div></div><figcaption class="mn mo fg fe ff mp mq bd b be z ek">Brigade Enterprises Limited</figcaption></figure><figure class="jz ka kb kc fq kd fe ff paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="fe ff mr"><img src="../Images/05f92d298cfb44bc62043eb4261c2969.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EVUn1dmntv3FFZ6ni743NA.png"/></div></div><figcaption class="mn mo fg fe ff mp mq bd b be z ek">Godrej Properties Limited</figcaption></figure><figure class="jz ka kb kc fq kd fe ff paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="fe ff ms"><img src="../Images/9f6241d70845b965e8969c27d7701a7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NJFh_7wLIxI_3NUUZUxDUw.png"/></div></div><figcaption class="mn mo fg fe ff mp mq bd b be z ek">ITC Limited</figcaption></figure><figure class="jz ka kb kc fq kd fe ff paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="fe ff mt"><img src="../Images/2446e8695b340bd23365044758bc10a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2CEXFfBQzx92XpFP1MSSAQ.png"/></div></div><figcaption class="mn mo fg fe ff mp mq bd b be z ek">Reliance Industries Limited</figcaption></figure></div><div class="ab cl kl km hc kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="hn ho hp hq hr"><h2 id="ee72" class="ks kt hu bd ku kv kw kx ky kz la lb lc jc ld le lf jg lg lh li jk lj lk ll lm dt translated">形象化</h2><p id="c5d1" class="pw-post-body-paragraph ir is hu it b iu ln iw ix iy lo ja jb jc lp je jf jg lq ji jj jk lr jm jn jo hn dt translated">可视化这些年来的特征，这为我们提供了关于公司过去趋势和波动性的信息。</p><p id="4690" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">此外，还包括 OHLC、HLC 和历年收盘价图，用于说明金融工具价格随时间的变化</p><p id="382c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">旅组</strong></p><figure class="jz ka kb kc fq kd fe ff paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="fe ff mu"><img src="../Images/eb3b9cb86a8b45c5740697752f399b32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hJY-CAb2AFJeluMxOI14Bg.png"/></div></div></figure><figure class="jz ka kb kc fq kd fe ff paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="fe ff mv"><img src="../Images/f0c4a0342f6c4b5fe13a40f41ae69af6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mvh_RKg_Vo-hNmkJnJkh_A.png"/></div></div></figure><figure class="jz ka kb kc fq kd fe ff paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="fe ff mw"><img src="../Images/18117d26bfab867963db22812c379566.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0XT_3R3ZOqcrl3lxbYu3_A.png"/></div></div><figcaption class="mn mo fg fe ff mp mq bd b be z ek">OHLC and HLC Values over the years</figcaption></figure><p id="b011" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv"> Godrej 房地产有限公司</strong></p><figure class="jz ka kb kc fq kd fe ff paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="fe ff mu"><img src="../Images/f7ac6eacee4124163658e19f24a6342a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v5KP_k7gFQq5M2USOft2sg.png"/></div></div></figure><figure class="jz ka kb kc fq kd fe ff paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="fe ff mx"><img src="../Images/98c003264e8ae05636ac84e4a82cbd66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZknGp0Xur0WkjlTCLPmDZg.png"/></div></div></figure><figure class="jz ka kb kc fq kd fe ff paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="fe ff my"><img src="../Images/5a09301ba1930a31f74b59e2f107e36f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JXrrnv_IIiiIWUds6wZYjA.png"/></div></div><figcaption class="mn mo fg fe ff mp mq bd b be z ek">OHLC and HLC Values over the years</figcaption></figure><p id="539d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv"> ITC 有限公司</strong></p><figure class="jz ka kb kc fq kd fe ff paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="fe ff mz"><img src="../Images/0ff83bf0ae1e233ec3099dfa7edf42d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bGXnZo-Jr8Uo5opShpyoPw.png"/></div></div></figure><figure class="jz ka kb kc fq kd fe ff paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="fe ff na"><img src="../Images/cf37aed4cd9d092f152ceb994bbe1ade.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ph42DhNpAu8y4NtgDFuJBg.png"/></div></div></figure><figure class="jz ka kb kc fq kd fe ff paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="fe ff nb"><img src="../Images/452540138f8e4bdd59caeaa6cd6cfe21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4Aq755uBsnLkRfMH2CiBlQ.png"/></div></div><figcaption class="mn mo fg fe ff mp mq bd b be z ek">OHLC and HLC Values over the years</figcaption></figure><p id="4df7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">信实工业有限公司</strong></p><figure class="jz ka kb kc fq kd fe ff paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="fe ff mz"><img src="../Images/c7bc7c77970e5d75247df77be657d3cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rt21h0IgneTVyg8VTwQQzg.png"/></div></div></figure><figure class="jz ka kb kc fq kd fe ff paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="fe ff na"><img src="../Images/1162425a7ea6e7d7941466098dcacfaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t1ha9TrM-Bf-8XSDyLr2Ig.png"/></div></div></figure><figure class="jz ka kb kc fq kd fe ff paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="fe ff nc"><img src="../Images/a0165f6317479c1feb139fc44e6e76c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QtyuhpNQVD5BFX8rhiXN1A.png"/></div></div><figcaption class="mn mo fg fe ff mp mq bd b be z ek">OHLC and HLC Values over the years</figcaption></figure></div><div class="ab cl kl km hc kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="hn ho hp hq hr"><h2 id="d0a7" class="ks kt hu bd ku kv kw kx ky kz la lb lc jc ld le lf jg lg lh li jk lj lk ll lm dt translated">预言；预测；预告</h2><p id="08e6" class="pw-post-body-paragraph ir is hu it b iu ln iw ix iy lo ja jb jc lp je jf jg lq ji jj jk lr jm jn jo hn dt translated">预测是使用 lstm ( <strong class="it hv">长短期记忆网络</strong>)完成的，因为它们非常擅长提取时间序列数据中的特征。</p><p id="46a9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">列车测试以 75-25%的比例进行。</p><p id="c0fe" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">每种股票总共 5 个周期。</p><p id="8c0c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在对每只股票分别进行训练后，模型对测试数据集进行预测，并计算 RMSE ( <strong class="it hv">均方根误差)。</strong></p><figure class="jz ka kb kc fq kd"><div class="bz el l di"><div class="lt lu l"/></div></figure><p id="ffe2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们得到以下相同的结果。</p><p id="03a6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">旅组</strong></p><p id="d2dc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">测试数据集 5.13 上的 RMSE</p><figure class="jz ka kb kc fq kd fe ff paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="fe ff nd"><img src="../Images/5cede8d04ab4050ce00183631aca003c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MoLfNqkFbjk_ZHJfCJYAyw.png"/></div></div></figure><p id="9f64" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">戈德雷吉地产有限公司</strong></p><p id="abc5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">测试数据集 14.72 上的 RMSE</p><figure class="jz ka kb kc fq kd fe ff paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="fe ff nd"><img src="../Images/b77983d9a18f3804d266d0311deadd67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F2bbyuagc2WtdWlvI2F5fg.png"/></div></div></figure><p id="6c72" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv"> ITC 有限公司</strong></p><p id="fc29" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">测试数据集 6.38 上的 RMSE</p><figure class="jz ka kb kc fq kd fe ff paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="fe ff ne"><img src="../Images/5f0400e36754e6e03b3f4da476f36c5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zqfxEu7edR9dUQ0KXLW5MA.png"/></div></div></figure><p id="4695" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">信实工业有限公司</strong></p><p id="6175" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">测试数据集 29.19 上的 RMSE</p><figure class="jz ka kb kc fq kd fe ff paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="fe ff nf"><img src="../Images/20226d402a03afead42746eb8f96ee2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZO5Fs6sQOBPvM1dtVidQew.png"/></div></div></figure><p id="e13f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这篇文章包括完整项目的一个模块，即使用神经网络进行预测。项目的另一个方面包括关于公司股票的项目的情感部分。</p><p id="fceb" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当结合两个模块的结果，我们可以集群股票的收益或损失。</p><p id="bbab" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">完整的代码，请访问我的 github 库:</p><div class="ng nh fm fo ni nj"><a href="https://github.com/sahilverma0696/Stock-market-prediction-clustering" rel="noopener  ugc nofollow" target="_blank"><div class="nk ab ej"><div class="nl ab nm cl cj nn"><h2 class="bd hv fv z el no eo ep np er et ht dt translated">sahilverma 0696/股票市场预测分类</h2><div class="nq l"><h3 class="bd b fv z el no eo ep np er et ek translated">使用股票市场数据和多重聚类算法预测最佳方法…</h3></div><div class="nr l"><p class="bd b gc z el no eo ep np er et ek translated">github.com</p></div></div><div class="ns l"><div class="nt l nu nv nw ns nx ki nj"/></div></div></a></div><figure class="jz ka kb kc fq kd"><div class="bz el l di"><div class="ny lu l"/></div></figure></div></div>    
</body>
</html>