# 选择一个不烂的 React 原生栈。

> 原文：<https://medium.com/hackernoon/choosing-a-react-native-stack-that-doesnt-suck-70dde637c9fe>

## 如果你想“学一次”，而不是到处都吸，该用什么，该避免什么。

![](img/037f965105b8ae38001973607acf37c0.png)

React Native 的承诺是“一次学习，随处书写”。此外，很大一部分吸引力是代码重用和利用新兴生态系统的可能性，以提高我们的开发速度和降低我们的可维护性成本。如果 React Native 做不到这一点，**而不牺牲用户体验**，那就不值得麻烦了。

# **良好的第一印象**

第一次潜入 React Native 时，我当然感觉到这“不是你爸爸的混合移动开发体验”，并且考虑到我们可以做什么，利用团队现有的 JS 知识，变得非常兴奋。问题是，当你尝试超越琐碎的入门应用程序时，这并不容易。

## 容易进入的舱口

与之前混合技术的承诺有一个微妙但*关键的不同*，因为 React Native 正努力通过 javascript 向本地世界提供一个跨平台的界面*,这就是问题所在。过度依赖 javascript 来实现应用的核心功能，而不是利用目标平台的原生功能，将会导致性能受限和体验质量下降。*

> *当开始一个 React 原生项目时，你应该问的一个关键问题是“这实际上会改善或简化开发体验吗？”*

## *将其与本土发展进行比较*

*老实说，关于原生开发的许多难点，在使用 React Native 时仍然是难点。对于许多 web 开发人员来说，到处使用 JS 的诱惑很大，但根据我去年的经验，这不是学习 Swift 和 Kotlin(或者 java，如果你必须的话)进行原生开发，而是原生生态系统、供应、构建系统、依赖性管理、部署到应用商店、性能分析等。当使用 React Native 开始一个项目时，你应该问的一个关键问题是“这是否会在满足用户期望的同时真正改善或简化开发体验”。*

# *重大选择*

*有几个关键的交叉问题会影响用户体验，不管是什么应用，我们发现最大的决定如下。*

## *按指定路线发送*

*React navigation(React Native 中路由的 JS 解决方案)的受欢迎程度有了极大的提高。我，我肯定像许多人一样，起初觉得这很有意义，并且对它是 JS 解决方案这一事实感到满意。我对我们的选择很满意，直到我们发现，在一个简单的基于文本的演示应用程序中，一个简单的幻灯片动画在旗舰设备上运行时不会不流畅。现在已经做了广泛的研究，有一些方法可以改善这一点，但正如我稍后将提到的，我认为我们不应该为此付出如此大的努力，尤其是在我们甚至考虑到还有什么可能会争夺设备上宝贵的稀缺资源之前。*

*输入 Wix React Native Navigation v2。我不能说转移到这个解决方案是容易的，设置是艰巨的，文档需要很多帮助。也就是说，一旦我们把这些都连接起来，导航就变得流畅了，附带的好处是，我们的代码更整洁，也更容易推理。*

## *后端*

*除了自己动手，还有一些很有前途的选择，这完全取决于你的需求。对我们来说，除了授权和推送通知之外，我们最常构建跨平台的 web 和移动应用，最近还需要基于云的服务，如媒体编码、图形数据等。在过去使用过 GCP(和 Firebase)、Azure 和 AWS 之后，我最初倾向于 AWS，直到我发现了 [Firebase React 原生项目](https://rnfirebase.io/)。*

*虽然所有这些服务都很棒，但它们都有各自的优势和劣势。它们都没有为 React Native 提供第一方原生解决方案。Firebase 在生产率方面也是一个胜利，超过了我以前用 AWS 实现的一个更好的后端。也就是说，我很失望地发现只有 JS 支持云函数。t*

*最终，我们的决定因素是能够安装原生 SDK，这提供了一些额外的好处，在他们的文档中详细讨论了这些好处，并将其从 JS 线程中移除。*

## *用户界面库*

*这似乎是一个与 React Native 一般的开放区域。有很多库，有些比其他的好，有些更灵活，但最终我对我们使用的每一个都感到失望。从 react-native-elements，到 native-base，react-native-paper，在构建生产应用程序时，似乎没有一个完全准备好。*

*尽管作为一个整体库，在这个领域没有明显的赢家，但有许多非常有用的组件，我们会反复使用:*

*   *[反应原生矢量图标](https://github.com/oblador/react-native-vector-icons)*
*   *[反应自然线性渐变](https://github.com/react-native-community/react-native-linear-gradient)*
*   *[反应原生地图](https://github.com/lelandrichardson/react-native-maps)*
*   *[React 原生图像拾取器](https://github.com/react-native-community/react-native-image-picker)*

*更小更简单的库似乎是一个更好的选择，因为更完整的库，如 React Native Paper，虽然很有前途，但如果你想要对生产就绪型应用程序进行定制，最终将需要你分叉库。*

*查看我们的[牛逼的 react 原生用户界面](https://github.com/madhavanmalolan/awesome-reactnative-ui)，获取项目的详细列表。*

## *状态管理和持久性*

*这是我仍然和 redux 以及 redux-sagas 紧密结合的一个领域。两者都有助于将管理状态与管理 UI 分开，我们在 web 和移动中使用这一点。*

*但对于原生应用来说，一个关键的区别是离线功能，没有离线功能，你实际上只是在设备上提供网络体验，而不是开发连接的移动体验。虽然 redux-offline 是一个非常受欢迎的选择，但我们选择了 redux-persist，这是一个更简单的方法，并将其与 RealmDB 配对。*

*虽然您有许多关于持久性的选择，无论是 AsymcStorage、realm 还是令人印象深刻的新 WatermelonDB，这都需要在后端和前端架构的上下文中仔细考虑。*

*在我们的例子中，Firebase-react-native 也自己处理一些问题，所以 redux-persist 似乎对我们来说已经足够了，尽管这取决于您的其他选择、您对 redux 的喜爱程度以及您与 web 前端保持的对等程度。*

# *放弃*

*这个论点有很大一部分，围绕着先选择本地人。有很多很棒的 JS 库，我很清楚有很多可以优化的地方。几年前我在 Cordova 亲自实现了手势驱动的 60FPS 动画，我可以证明这是可能的。也就是说，我们不应该为了原生平台能给我们的东西而努力工作。*

*其次，不管是什么语言或平台，糟糕的代码就是糟糕的代码，简单地使用这些库，甚至切换到完全的原生代码都不是一个好办法，尤其是考虑到不可饶恕的本性或移动开发。*

# *TLDR:我用的是不太烂的 RN 堆栈*

*以下是我的要点列表，基于我们最近的测试、研究和使用 React Native 的经验，您的选择可能会有所不同，但我希望它们会在原生环境中得到考虑。*

*   *使用 Wix React 本地导航 v2 进行路由*
*   *单一 UI 库上的本机组件*
*   *React Native Firebase 和 Google Cloud 用于我们的后端*
*   *复杂状态的 Redux 和 Redux Sagas*
*   *redux-persist 使用 RealmdB 实现持久性*

*这些依赖关系的设置将会比简单的`npm install…`或`yarn add ...`更加复杂，并且在最初的一两天里你可能会感到沮丧。请记住，这与构建 web 应用程序是两码事。做一场持久战。将来你会感激的。*

# *记得在 React Native 里放 NATIVE*

*仔细考虑 React Native 应用中的每个组件、屏幕、库和架构决策。一个糟糕的选择可能会对您的最终用户以及您的开发人员体验产生真正的影响。记得把原生的放在你的 React 原生应用里。*

*[Paul van Zyl](https://medium.com/u/65d064c2c3b2?source=post_page-----70dde637c9fe--------------------------------) 是一名全栈 JS 和 Golang 开发人员，屡获殊荣的产品设计师，也是适马数字公司的创始人，这是一个分散的产品设计和开发团队。[在推特上关注他。](https://twitter.com/pushplaybang)*