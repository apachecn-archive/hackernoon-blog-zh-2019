<html>
<head>
<title>Raspberry Pi based Wifi Routers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于Raspberry Pi的Wifi路由器</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/raspberry-pi-based-wifi-routers-3b8c7c49143f?source=collection_archive---------1-----------------------#2019-01-17">https://medium.com/hackernoon/raspberry-pi-based-wifi-routers-3b8c7c49143f?source=collection_archive---------1-----------------------#2019-01-17</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><figure class="ht hu fm fo hv hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff hs"><img src="../Images/42972d81c10941db085479b452bdf827.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q0xPVZH0PmW-DT7PWWjcCA.jpeg"/></div></div></figure><div class=""/><p id="7f8c" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这篇相当长的帖子将带你完成在一台<a class="ae ka" href="https://hackernoon.com/tagged/raspberry-pi" rel="noopener ugc nofollow" target="_blank"> Raspberry Pi </a> Zero W或Raspberry Pi 3上设置一个<a class="ae ka" href="https://hackernoon.com/tagged/wifi-router" rel="noopener ugc nofollow" target="_blank"> WiFi路由器</a>的过程。有很多原因会让你想做这样的事情:</p><ul class=""><li id="86cd" class="kb kc if je b jf jg jj jk jn kd jr ke jv kf jz kg kh ki kj dt translated">为您的web应用程序的任何位置接入点设置演示</li><li id="4929" class="kb kc if je b jf kk jj kl jn km jr kn jv ko jz kg kh ki kj dt translated">创建用于网络测试的可部署设备。</li></ul><p id="0f47" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">作为一个额外的收获，这篇文章还描述了如何安装NodeJS和AWS命令行工具来创建带有AWS的脚本化工作流。</p><h1 id="e18e" class="kp kq if bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm dt translated">设置树莓Pi</h1><p id="069e" class="pw-post-body-paragraph jc jd if je b jf ln jh ji jj lo jl jm jn lp jp jq jr lq jt ju jv lr jx jy jz hn dt translated">使用<a class="ae ka" href="https://www.raspberrypi.org/downloads/raspbian/" rel="noopener ugc nofollow" target="_blank"> Raspbian Lite </a>设置Raspberry Pi Zero W。我用的版本是<code class="eh ls lt lu lv b">2018-06-27-raspbian-stretch-lite.img</code></p><p id="a545" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">以下说明以Mac OSX为中心，但与使用其他操作系统的方式没有太大区别。</p><p id="91a7" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je ig">定位SD卡</strong></p><p id="1854" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在Mac上，您可以通过命令行使用diskutil来实现这一点。执行下面的命令，并查找与您的SD卡大小相匹配的/dev/disk。对我来说，那就是/dev/disk2</p><pre class="lw lx ly lz fq ma lv mb mc aw md dt"><span id="7ea8" class="me kq if lv b fv mf mg l mh mi">$ diskutil list</span></pre><p id="d370" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je ig">卸下SD卡</strong></p><p id="d25d" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">接下来使用磁盘号卸载SD卡。</p><pre class="lw lx ly lz fq ma lv mb mc aw md dt"><span id="f9fb" class="me kq if lv b fv mf mg l mh mi">$ diskutil unmountDisk /dev/disk2</span></pre><p id="cb3e" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je ig">刷新操作系统镜像</strong></p><p id="129c" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">使用<code class="eh ls lt lu lv b">dd</code>命令将Raspbian lite映像刷新到您的SD卡上。执行此操作时要小心！</p><p id="a425" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这是一个很好的机会来提一下如果你不小心使用的话,<code class="eh ls lt lu lv b">dd</code>命令会非常危险。始终确保您将<code class="eh ls lt lu lv b">dd</code>指向正确的磁盘驱动器！你不会想删除错误的驱动器。毕竟，该命令被称为磁盘破坏者是有原因的，但这不是dd所代表的意思。如果你感兴趣，可以看看这段<code class="eh ls lt lu lv b"><a class="ae ka" href="https://en.wikipedia.org/wiki/Dd_%28Unix%29" rel="noopener ugc nofollow" target="_blank">dd</a></code>历史。</p><pre class="lw lx ly lz fq ma lv mb mc aw md dt"><span id="83d0" class="me kq if lv b fv mf mg l mh mi">$ sudo dd bs=1m if=./2018-06-27-raspbian-stretch-lite.img of=/dev/disk2 conv=sync</span></pre><p id="6114" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">当dd正在运行时，您可以按下键盘上的ctrl-t来检查状态。根据SD卡的速度，SD磁盘闪存可能需要一段时间。</p><p id="a247" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">出于性能原因，建议您使用6类或10类microSDHC卡。</p><p id="b65c" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">复制完成后，您可以将光盘刻录到卡上:</p><pre class="lw lx ly lz fq ma lv mb mc aw md dt"><span id="9502" class="me kq if lv b fv mf mg l mh mi">$ cd /Volumes/boot</span></pre><p id="e081" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">创建一个空的ssh文件，告诉操作系统您希望启用SSH访问:</p><pre class="lw lx ly lz fq ma lv mb mc aw md dt"><span id="808a" class="me kq if lv b fv mf mg l mh mi">$ touch ssh</span></pre><p id="8246" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">接下来用下面的内容创建一个<code class="eh ls lt lu lv b">wpa_supplicant.conf</code>文件，确保用你路由器的设置替换你的ssid和psk字段。</p><pre class="lw lx ly lz fq ma lv mb mc aw md dt"><span id="6c4b" class="me kq if lv b fv mf mg l mh mi">ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev<br/>update_config=1<br/>country=US<br/>network={<br/>    ssid="YOUR-SSID"<br/>    psk="YOUR-PASSWORD"<br/>    scan_ssid=1<br/>}</span></pre><p id="67df" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">完成更改后，安全地卸载SD。</p><pre class="lw lx ly lz fq ma lv mb mc aw md dt"><span id="7aae" class="me kq if lv b fv mf mg l mh mi">$ cd ~<br/>$ diskutil unmountDisk /dev/disk2</span></pre><p id="d6b4" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je ig">连接并配置您的Raspberry Pi </strong></p><p id="5623" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">接下来，将SD插入Pi Zero并启动设备。</p><p id="38e9" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">给它一分钟左右的时间来完成，然后尝试ping设备以找到它。</p><pre class="lw lx ly lz fq ma lv mb mc aw md dt"><span id="3a9f" class="me kq if lv b fv mf mg l mh mi">$ ping raspberrypi.local</span></pre><p id="d7ed" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">或者使用您的网络路由器或Wifi扫描仪找到设备，例如<a class="ae ka" href="https://itunes.apple.com/us/app/who-is-on-my-wifi/id909760813?mt=12" rel="noopener ugc nofollow" target="_blank">谁在我的Wifi上</a></p><p id="8d2f" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">您可以使用以下方式ssh进入设备:</p><pre class="lw lx ly lz fq ma lv mb mc aw md dt"><span id="2e85" class="me kq if lv b fv mf mg l mh mi">$ ssh pi@raspberrypi.local<br/>or<br/>$ ssh pi@10.10.0.107</span></pre><p id="e485" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">默认密码是<code class="eh ls lt lu lv b">raspberry</code>。</p><p id="1834" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果您遇到以下错误:</p><pre class="lw lx ly lz fq ma lv mb mc aw md dt"><span id="79db" class="me kq if lv b fv mf mg l mh mi">@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@<br/>@ WARNING: POSSIBLE DNS SPOOFING DETECTED! @<br/>@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@</span></pre><p id="f418" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">然后简单地编辑您的<code class="eh ls lt lu lv b">.ssh/known_hosts</code>文件，删除含有<code class="eh ls lt lu lv b">raspberrypi</code>条目的那一行。</p><pre class="lw lx ly lz fq ma lv mb mc aw md dt"><span id="2afb" class="me kq if lv b fv mf mg l mh mi">$ vi /Users/${USER}/.ssh/known_hosts</span></pre><p id="30f1" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">继续，一旦你登录，第一件事就是修改密码！</p><pre class="lw lx ly lz fq ma lv mb mc aw md dt"><span id="45b5" class="me kq if lv b fv mf mg l mh mi">$ passwd</span></pre><p id="a3e8" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">用户名仍将保持<code class="eh ls lt lu lv b">pi</code>，但您可以使用新密码登录。</p><p id="f967" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果您愿意，可以使用raspi-config实用程序进行其他调整。</p><pre class="lw lx ly lz fq ma lv mb mc aw md dt"><span id="5c3b" class="me kq if lv b fv mf mg l mh mi">$ sudo raspi-config</span></pre><p id="d19e" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">接下来，确保操作系统是最新的:</p><pre class="lw lx ly lz fq ma lv mb mc aw md dt"><span id="c9b0" class="me kq if lv b fv mf mg l mh mi">$ sudo apt-get update<br/>$ sudo apt-get upgrade</span></pre><ul class=""><li id="5af5" class="kb kc if je b jf jg jj jk jn kd jr ke jv kf jz kg kh ki kj dt translated"><strong class="je ig"> <em class="mj">关于上面的更新命令的一个注意事项:如果在安装软件包时您得到一个错误，如</em> </strong> <code class="eh ls lt lu lv b"><strong class="je ig"><em class="mj">E: Unable to fetch some archives, maybe run apt-get update or try with — fix-missing?</em></strong></code> <strong class="je ig"> <em class="mj">，那么重新运行</em> </strong> <code class="eh ls lt lu lv b"><strong class="je ig"><em class="mj">sudo apt-get update</em></strong></code> <strong class="je ig"> <em class="mj">并重试失败的软件包更新。事实证明这是成功的。</em> </strong></li></ul><p id="c6a1" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">最后，这里花点时间来设置您的时区:</p><p id="3eec" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><code class="eh ls lt lu lv b">$ sudo dpkg-reconfigure tzdata</code></p></div><div class="ab cl mk ml hc mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="hn ho hp hq hr"><h1 id="1850" class="kp kq if bd kr ks mr ku kv kw ms ky kz la mt lc ld le mu lg lh li mv lk ll lm dt translated">添加节点</h1><p id="6ceb" class="pw-post-body-paragraph jc jd if je b jf ln jh ji jj lo jl jm jn lp jp jq jr lq jt ju jv lr jx jy jz hn dt translated">对于Pi ZeroW使用:</p><pre class="lw lx ly lz fq ma lv mb mc aw md dt"><span id="84bd" class="me kq if lv b fv mf mg l mh mi">$ mkdir nodejs; cd nodejs<br/>$ wget <a class="ae ka" href="https://nodejs.org/dist/v8.12.0/node-v8.12.0-linux-armv6l.tar.xz" rel="noopener ugc nofollow" target="_blank">https://nodejs.org/dist/v8.12.0/node-v8.12.0-linux-armv6l.tar.xz</a><br/>$ tar -xvf node-v8.12.0-linux-armv6l.tar.xz<br/>$ cd /usr/local/bin<br/>$ sudo cp /home/pi/nodejs/node-v8.12.0-linux-armv6l/bin/node .<br/>$ sudo ln -sf /home/pi/nodejs/node-v8.12.0-linux-armv6l/bin/npx npx<br/>$ sudo ln -sf /home/pi/nodejs/node-v8.12.0-linux-armv6l/bin/npm npm<br/>$ cd ~</span></pre><p id="f55f" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果使用Raspberry Pi 3，使用:</p><pre class="lw lx ly lz fq ma lv mb mc aw md dt"><span id="88a7" class="me kq if lv b fv mf mg l mh mi">$ mkdir nodejs; cd nodejs<br/>$ wget <a class="ae ka" href="https://nodejs.org/dist/v10.14.0/node-v10.14.0-linux-armv7l.tar.xz" rel="noopener ugc nofollow" target="_blank">https://nodejs.org/dist/v10.14.0/node-v10.14.0-linux-armv7l.tar.xz</a><br/>$ tar -xvf node-v10.14.0-linux-armv7l.tar.xz<br/>$ cd /usr/local/bin<br/>$ sudo cp /home/pi/nodejs/node-v10.14.0-linux-armv7l/bin/node .<br/>$ sudo ln -sf /home/pi/nodejs/node-v10.14.0-linux-armv7l/bin/npx npx<br/>$ sudo ln -sf /home/pi/nodejs/node-v10.14.0-linux-armv7l/bin/npm npm<br/>$ cd ~</span></pre><p id="d9d2" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">您可以通过以下方式测试NodeJS安装:</p><pre class="lw lx ly lz fq ma lv mb mc aw md dt"><span id="4083" class="me kq if lv b fv mf mg l mh mi">$ node --version</span></pre></div><div class="ab cl mk ml hc mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="hn ho hp hq hr"><h1 id="a33c" class="kp kq if bd kr ks mr ku kv kw ms ky kz la mt lc ld le mu lg lh li mv lk ll lm dt translated">安装AWS命令行工具</h1><p id="78b5" class="pw-post-body-paragraph jc jd if je b jf ln jh ji jj lo jl jm jn lp jp jq jr lq jt ju jv lr jx jy jz hn dt translated">这是一个可选的步骤，但是如果您在S3存储桶中有想要复制到Raspberry Pi中的文件，这是非常有用的。</p><p id="09f5" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><code class="eh ls lt lu lv b">$ sudo apt-get install awscli</code></p><p id="151d" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">接下来配置AWS访问:</p><pre class="lw lx ly lz fq ma lv mb mc aw md dt"><span id="38e2" class="me kq if lv b fv mf mg l mh mi">$ aws configure<br/>AWS Access Key ID [None]: ************<br/>AWS Secret Access Key [None]: ***************************<br/>Default region name [None]: us-west-2<br/>Default output format [None]: json</span></pre><p id="20d1" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">下载资产脚本</p><pre class="lw lx ly lz fq ma lv mb mc aw md dt"><span id="d095" class="me kq if lv b fv mf mg l mh mi">#!/bin/bash<br/>mkdir -p $1<br/>aws s3 cp s3://bucketname/$1 ./$1 — recursive</span></pre><p id="efce" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">用法:</p><pre class="lw lx ly lz fq ma lv mb mc aw md dt"><span id="8208" class="me kq if lv b fv mf mg l mh mi">./download.sh 303A0FA/teb002/3A0FA-2018/10/18/90918447–2fnaodyxhbr</span></pre></div><div class="ab cl mk ml hc mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="hn ho hp hq hr"><h1 id="d53d" class="kp kq if bd kr ks mr ku kv kw ms ky kz la mt lc ld le mu lg lh li mv lk ll lm dt translated">设置为路由器</h1><ul class=""><li id="81f3" class="kb kc if je b jf ln jj lo jn mw jr mx jv my jz kg kh ki kj dt translated">由<a class="ae ka" rel="noopener" href="/@ivaylov/raspberry-pi-wifi-router-82921ed2ac17">https://medium . com/@ ivaylov/raspberry-pi-wifi-router-82921 ed2 AC 17</a>提供的步骤，有以下一些改动:</li></ul><p id="2f96" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je ig">移除WPA恳求者</strong></p><p id="7862" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><code class="eh ls lt lu lv b">$ sudo apt-get purge wpasupplicant</code></p><p id="f4a0" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je ig">安装DHCP服务器</strong> <br/> <code class="eh ls lt lu lv b">$ sudo apt-get install isc-dhcp-server</code></p><p id="fe91" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je ig">设置DHCP </strong> <br/> <code class="eh ls lt lu lv b">$ sudo vi /etc/dhcp/dhcpd.conf</code></p><p id="0f03" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">添加到文件末尾:</p><pre class="lw lx ly lz fq ma lv mb mc aw md dt"><span id="b988" class="me kq if lv b fv mf mg l mh mi">subnet 172.16.1.0 netmask 255.255.255.0 {<br/>  range 172.16.1.25 172.16.1.50;<br/>  option domain-name-servers 8.8.4.4;<br/>  option routers 172.16.1.1;<br/>  interface wlan0;<br/>}</span></pre><p id="08a2" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je ig">安装主机接入点守护进程</strong> <br/> <code class="eh ls lt lu lv b">$ sudo apt-get install hostapd</code></p><p id="1224" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><strong class="je ig">配置hostapd </strong></p><p id="78ea" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">创建一个hostapd.conf文件<br/>T12】</p><p id="388c" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">将这些行添加到hostapd.conf文件中</p><pre class="lw lx ly lz fq ma lv mb mc aw md dt"><span id="b47f" class="me kq if lv b fv mf mg l mh mi">interface=wlan0<br/>#driver=nl80211<br/>ssid=YOUR_STATION<br/>hw_mode=g<br/>channel=5<br/>wpa=1<br/>wpa_passphrase=SECRETPASSWORD<br/>wpa_key_mgmt=WPA-PSK<br/>wpa_pairwise=TKIP CCMP<br/>wpa_ptk_rekey=600<br/>macaddr_acl=0</span></pre><p id="1360" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">继续前进…</p><pre class="lw lx ly lz fq ma lv mb mc aw md dt"><span id="b76b" class="me kq if lv b fv mf mg l mh mi">$ sudo ifconfig wlan0 172.16.1.1<br/>$ sudo /etc/init.d/isc-dhcp-server restart</span></pre><p id="ff4d" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">-d用于调试模式，以便您可以查看是否出现任何错误<br/> <code class="eh ls lt lu lv b">$ sudo hostapd -d /etc/hostapd/hostapd.conf</code></p><p id="da88" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在^^^之后可能需要ctrl-c</p><p id="f947" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在让我们使这些变化持久化<br/> <code class="eh ls lt lu lv b">$ sudo vi /etc/network/interfaces</code></p><p id="eeb2" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">接下来，添加或编辑以下几行</p><pre class="lw lx ly lz fq ma lv mb mc aw md dt"><span id="6ac1" class="me kq if lv b fv mf mg l mh mi">auto wlan0<br/>iface wlan0 inet static<br/>address 172.16.1.1<br/>netmask 255.255.255.0</span></pre><p id="2a22" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">编辑rc.local …</p><p id="0d71" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><code class="eh ls lt lu lv b">$ sudo vi /etc/rc.local</code></p><p id="8aa5" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">并在最后一行前增加两行<code class="eh ls lt lu lv b">exit 0</code></p><pre class="lw lx ly lz fq ma lv mb mc aw md dt"><span id="94ac" class="me kq if lv b fv mf mg l mh mi">hostapd -B /etc/hostapd/hostapd.conf<br/>iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE</span></pre><p id="0147" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">然后取消/etc/sysctrl.conf中以下行的注释</p><p id="50e4" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><code class="eh ls lt lu lv b">$ sudo vi /etc/sysctl.conf</code></p><pre class="lw lx ly lz fq ma lv mb mc aw md dt"><span id="a284" class="me kq if lv b fv mf mg l mh mi"># Uncomment the next line to enable packet forwarding for IPv4<br/>#net.ipv4.ip_forward=1</span></pre><p id="008b" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">所以上面应该是:</p><pre class="lw lx ly lz fq ma lv mb mc aw md dt"><span id="7828" class="me kq if lv b fv mf mg l mh mi">net.ipv4.ip_forward=1</span></pre><p id="f1e5" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">就是这样。我们现在可以重启机器了。</p><p id="f11e" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><code class="eh ls lt lu lv b">$ sudo reboot</code></p><h1 id="b417" class="kp kq if bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm dt translated">测试</h1><p id="b6c4" class="pw-post-body-paragraph jc jd if je b jf ln jh ji jj lo jl jm jn lp jp jq jr lq jt ju jv lr jx jy jz hn dt translated">在此阶段，您应该能够访问WiFi网络。</p><h1 id="d609" class="kp kq if bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm dt">—</h1><p id="71c6" class="pw-post-body-paragraph jc jd if je b jf ln jh ji jj lo jl jm jn lp jp jq jr lq jt ju jv lr jx jy jz hn dt translated"><em class="mj">感谢阅读！如果你喜欢你所读的，按住下面的拍手按钮，让其他人也能看到。也可以</em> <a class="ae ka" href="https://twitter.com/cjus" rel="noopener ugc nofollow" target="_blank"> <em class="mj">在Twitter上关注我</em> </a> <em class="mj">。</em></p><figure class="lw lx ly lz fq hw"><div class="bz el l di"><div class="mz na l"/></div></figure></div></div>    
</body>
</html>