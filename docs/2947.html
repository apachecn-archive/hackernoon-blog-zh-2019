<html>
<head>
<title>Taste all the Features of the Hyperledger Fabric v1.4 Network</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">体验Hyperledger Fabric v1.4网络的所有功能</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/taste-all-the-features-of-hyperledger-fabric-v1-4-4275fd9b9d8e?source=collection_archive---------5-----------------------#2019-05-09">https://medium.com/hackernoon/taste-all-the-features-of-hyperledger-fabric-v1-4-4275fd9b9d8e?source=collection_archive---------5-----------------------#2019-05-09</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="9ac1" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">使用CouchDB &amp; Raft订购服务的不同参与组织的多渠道最低配置。</h2></div><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff jj"><img src="../Images/2ba60d65a5258c0b5b92d5a035aeffd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NesMie_FXd0gEl9a6jPB5w.jpeg"/></div></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek">System Architecture</figcaption></figure><h1 id="7870" class="jz ka hu bd kb kc kd ke kf kg kh ki kj ja kk jb kl jd km je kn jg ko jh kp kq dt translated">概观</h1><p id="1cf2" class="pw-post-body-paragraph kr ks hu kt b ku kv iv kw kx ky iy kz la lb lc ld le lf lg lh li lj lk ll lm hn dt translated">本文涵盖了最低配置的<a class="ae ln" href="https://hyperledger-fabric.readthedocs.io/en/release-1.4/" rel="noopener ugc nofollow" target="_blank"> Hyperledger Fabric v1.4 </a>网络的所有功能，这是<a class="ae ln" href="https://hyperledger-fabric.readthedocs.io/en/release-1.4/build_network.html" rel="noopener ugc nofollow" target="_blank">构建您的第一个网络</a>的“下一步”。在本文中，我们展示了一个具有三个组织的网络，其中两个组织具有多对等体和两个不同渠道的设置，每个渠道具有不同的参与组织，通过使用CouchDB作为分类帐数据库，使用Raft订购服务建立。</p><p id="1333" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">我们假设你知道Hyperledger Fabric v1.4的所有<a class="ae ln" href="https://hyperledger-fabric.readthedocs.io/en/release-1.4/key_concepts.html" rel="noopener ugc nofollow" target="_blank">关键概念</a>，并且对<a class="ae ln" href="https://hyperledger-fabric.readthedocs.io/en/release-1.4/build_network.html" rel="noopener ugc nofollow" target="_blank">构建你的第一个网络</a>有很好的了解。</p><p id="6fd3" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">这是一篇快速文章，以最低配置涵盖了<a class="ae ln" href="https://hyperledger-fabric.readthedocs.io/en/release-1.4/" rel="noopener ugc nofollow" target="_blank"> Hyperledger Fabric v1.4 </a>网络的所有功能。</p><h1 id="6be3" class="jz ka hu bd kb kc kd ke kf kg kh ki kj ja kk jb kl jd km je kn jg ko jh kp kq dt translated">系统结构</h1><p id="759c" class="pw-post-body-paragraph kr ks hu kt b ku kv iv kw kx ky iy kz la lb lc ld le lf lg lh li lj lk ll lm hn dt translated">这里我们有三个组织，分别是Org1、Org2和Org3，其中Org1和Org2有两个同级组织。有两个通道，即通道1和通道2。</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff jj"><img src="../Images/2ba60d65a5258c0b5b92d5a035aeffd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NesMie_FXd0gEl9a6jPB5w.jpeg"/></div></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek">System Architecture</figcaption></figure><p id="0021" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">在这里，信道1包含所有对等方和所有组织，信道2包含对等方0。通过使用raft订购服务，我们可以使用多个订购者，因此我们将使用五个订购者。L1是由智能联系人S1调用的渠道1的分类帐，L2是由智能联系人S2调用的渠道2的分类帐。</p><h1 id="fcfa" class="jz ka hu bd kb kc kd ke kf kg kh ki kj ja kk jb kl jd km je kn jg ko jh kp kq dt translated">第一步</h1><p id="fb11" class="pw-post-body-paragraph kr ks hu kt b ku kv iv kw kx ky iy kz la lb lc ld le lf lg lh li lj lk ll lm hn dt translated">首先，准备好<a class="ae ln" href="https://hyperledger-fabric.readthedocs.io/en/release-1.4/prereqs.html" rel="noopener ugc nofollow" target="_blank">先决条件</a>之后你还需要安装样本、二进制文件和Docker镜像。我假设您现在位于主目录中，并运行以下命令:</p><pre class="jk jl jm jn fq lt lu lv lw aw lx dt"><span id="1575" class="ly ka hu lu b fv lz ma l mb mc">curl -sSL http://bit.ly/2ysbOFE | bash -s</span></pre><p id="7ae1" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">完成后，您将看到目录“fabric-samples ”,所需的docker图像也已经下载。</p><p id="5921" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated"><strong class="kt hv">注意:</strong>样本、二进制文件可能会改变，所以你需要根据这些改变来编辑你的一些文件。</p><h1 id="1152" class="jz ka hu bd kb kc kd ke kf kg kh ki kj ja kk jb kl jd km je kn jg ko jh kp kq dt translated">第二步</h1><p id="07a8" class="pw-post-body-paragraph kr ks hu kt b ku kv iv kw kx ky iy kz la lb lc ld le lf lg lh li lj lk ll lm hn dt translated">首先你需要在<strong class="kt hv"> home/fabric-samples </strong>下创建一个名为<strong class="kt hv"> mynetwork </strong>的新目录，然后需要进入那个目录。从现在开始，我们将从<strong class="kt hv">home/fabric-samples/my network</strong>目录运行所有命令。</p><pre class="jk jl jm jn fq lt lu lv lw aw lx dt"><span id="8824" class="ly ka hu lu b fv lz ma l mb mc">cd fabric-samples<br/>mkdir mynetwork<br/>cd mynetwork</span></pre><p id="57de" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">要停止和删除所有以前的docker容器、docker卷、docker网络、脚本创建的文件，我们需要运行这些命令:</p><pre class="jk jl jm jn fq lt lu lv lw aw lx dt"><span id="0103" class="ly ka hu lu b fv lz ma l mb mc">#STOP AND DELETE THE DOCKER CONTAINERS<br/>docker ps -aq | xargs -n 1 docker stop<br/>docker ps -aq | xargs -n 1 docker rm -v</span><span id="a2b1" class="ly ka hu lu b fv md ma l mb mc">#DELETE THE OLD DOCKER VOLUMES<br/>docker volume prune -f</span><span id="ad02" class="ly ka hu lu b fv md ma l mb mc">#DELETE OLD DOCKER NETWORKS<br/>docker network prune -f</span><span id="5226" class="ly ka hu lu b fv md ma l mb mc">#Remove all stopped containers<br/>docker container prune -f</span><span id="3695" class="ly ka hu lu b fv md ma l mb mc">#Remove All Unused Objects<br/>docker system prune -f<br/>docker system prune --volumes -f</span><span id="f790" class="ly ka hu lu b fv md ma l mb mc">#DELETE SCRIPT-CREATED FILES<br/>rm -rf channel-artifacts/*.block channel-artifacts/*.tx crypto-config</span><span id="837a" class="ly ka hu lu b fv md ma l mb mc">#DELETE un-tagged images<br/>docker rmi -f $(docker images | awk '($1 ~ /dev-peer.*/) {print $3}')</span><span id="df77" class="ly ka hu lu b fv md ma l mb mc">#if you get error in future you may also need to remove docker images using the commands given below:<br/>#docker rm -f $(docker ps -aq)<br/>#docker rmi -f $(docker images -q)</span></pre><p id="4683" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">我们所有的二进制文件都存放在bin目录中。首先，我们需要创建如下所示的<strong class="kt hv"> crypto-config.yaml </strong>文件:</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="me mf l"/></div></figure><p id="1179" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">我们必须运行cryptogen工具，它将在<strong class="kt hv"> crypto-config </strong>文件夹中创建所有必要的证书和密钥。</p><pre class="jk jl jm jn fq lt lu lv lw aw lx dt"><span id="0100" class="ly ka hu lu b fv lz ma l mb mc">../bin/cryptogen generate --config=./crypto-config.yaml</span></pre><h1 id="5fca" class="jz ka hu bd kb kc kd ke kf kg kh ki kj ja kk jb kl jd km je kn jg ko jh kp kq dt translated">第三步</h1><p id="4e65" class="pw-post-body-paragraph kr ks hu kt b ku kv iv kw kx ky iy kz la lb lc ld le lf lg lh li lj lk ll lm hn dt translated">首先我们需要创建一个名为<strong class="kt hv"> channel-artifacts </strong>的目录，在那里我们存储脚本创建的文件，比如' _ '。阻止'或' _ '。tx '</p><p id="e825" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">然后我们需要在托管所有业务网络的<strong class="kt hv">home/fabric-samples/my network</strong>目录下创建<strong class="kt hv"> configtx.yaml </strong>文件。</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="me mf l"/></div></figure><p id="ce27" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">我们需要在<strong class="kt hv">home/fabric-samples/my network</strong>目录中创建一个名为<strong class="kt hv"> channel-artifacts </strong>的新目录，然后我们需要告诉configtxgentool在我们当前的工作目录中查找<strong class="kt hv"> configtx.yaml </strong>文件:</p><pre class="jk jl jm jn fq lt lu lv lw aw lx dt"><span id="20c0" class="ly ka hu lu b fv lz ma l mb mc">export FABRIC_CFG_PATH=$PWD</span></pre><p id="202a" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">最后，我们需要调用configtxgen工具来为Raft订购服务创建订购者起源块。它将在<strong class="kt hv">通道工件</strong>目录下创建genesis.block。</p><pre class="jk jl jm jn fq lt lu lv lw aw lx dt"><span id="ab1b" class="ly ka hu lu b fv lz ma l mb mc">../bin/configtxgen -profile SampleMultiNodeEtcdRaft -channelID byfn-sys-channel -outputBlock ./channel-artifacts/genesis.block</span></pre><h1 id="307f" class="jz ka hu bd kb kc kd ke kf kg kh ki kj ja kk jb kl jd km je kn jg ko jh kp kq dt translated">第四步</h1><p id="90c4" class="pw-post-body-paragraph kr ks hu kt b ku kv iv kw kx ky iy kz la lb lc ld le lf lg lh li lj lk ll lm hn dt translated">在这一步中，我们将创建所有的渠道事务工件。所以我们需要定义一些环境变量。</p><pre class="jk jl jm jn fq lt lu lv lw aw lx dt"><span id="aa29" class="ly ka hu lu b fv lz ma l mb mc">export CHANNEL_ONE_NAME=channel1</span><span id="ffaa" class="ly ka hu lu b fv md ma l mb mc">export CHANNEL_ONE_PROFILE=Channel1</span><span id="9a2c" class="ly ka hu lu b fv md ma l mb mc">export CHANNEL_TWO_NAME=channel2</span><span id="e054" class="ly ka hu lu b fv md ma l mb mc">export CHANNEL_TWO_PROFILE=Channel2</span></pre><p id="76ea" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">现在我们需要创建渠道交易构件，这将创建'<strong class="kt hv"> _。<strong class="kt hv">通道-工件目录</strong>中的tx </strong>文件以及包含通道定义的文件。分别给出通道1和通道2的命令:</p><pre class="jk jl jm jn fq lt lu lv lw aw lx dt"><span id="4c1e" class="ly ka hu lu b fv lz ma l mb mc">../bin/configtxgen -profile ${CHANNEL_ONE_PROFILE} -outputCreateChannelTx ./channel-artifacts/${CHANNEL_ONE_NAME}.tx -channelID $CHANNEL_ONE_NAME</span><span id="399a" class="ly ka hu lu b fv md ma l mb mc">../bin/configtxgen -profile ${CHANNEL_TWO_PROFILE} -outputCreateChannelTx ./channel-artifacts/${CHANNEL_TWO_NAME}.tx -channelID $CHANNEL_TWO_NAME</span></pre><p id="ccaf" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">是时候为渠道1定义锚定对等点了，渠道1由三个组织组成。</p><pre class="jk jl jm jn fq lt lu lv lw aw lx dt"><span id="6fd0" class="ly ka hu lu b fv lz ma l mb mc">../bin/configtxgen -profile ${CHANNEL_ONE_PROFILE} -outputAnchorPeersUpdate ./channel-artifacts/Org1MSPanchors_${CHANNEL_ONE_NAME}.tx -channelID $CHANNEL_ONE_NAME -asOrg Org1MSP</span><span id="e634" class="ly ka hu lu b fv md ma l mb mc">../bin/configtxgen -profile ${CHANNEL_ONE_PROFILE} -outputAnchorPeersUpdate ./channel-artifacts/Org2MSPanchors_${CHANNEL_ONE_NAME}.tx -channelID $CHANNEL_ONE_NAME -asOrg Org2MSP</span><span id="6a08" class="ly ka hu lu b fv md ma l mb mc">../bin/configtxgen -profile ${CHANNEL_ONE_PROFILE} -outputAnchorPeersUpdate ./channel-artifacts/Org3MSPanchors_${CHANNEL_ONE_NAME}.tx -channelID $CHANNEL_ONE_NAME -asOrg Org3MSP</span></pre><p id="a5f3" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">之后，我们需要为渠道2定义锚定对等点，包括两个组织。</p><pre class="jk jl jm jn fq lt lu lv lw aw lx dt"><span id="f78e" class="ly ka hu lu b fv lz ma l mb mc">../bin/configtxgen -profile ${CHANNEL_TWO_PROFILE} -outputAnchorPeersUpdate ./channel-artifacts/Org2MSPanchors_${CHANNEL_TWO_NAME}.tx -channelID $CHANNEL_TWO_NAME -asOrg Org2MSP</span><span id="2d36" class="ly ka hu lu b fv md ma l mb mc">../bin/configtxgen -profile ${CHANNEL_TWO_PROFILE} -outputAnchorPeersUpdate ./channel-artifacts/Org3MSPanchors_${CHANNEL_TWO_NAME}.tx -channelID $CHANNEL_TWO_NAME -asOrg Org3MSP</span></pre><h1 id="8c14" class="jz ka hu bd kb kc kd ke kf kg kh ki kj ja kk jb kl jd km je kn jg ko jh kp kq dt translated">第五步</h1><p id="b9f4" class="pw-post-body-paragraph kr ks hu kt b ku kv iv kw kx ky iy kz la lb lc ld le lf lg lh li lj lk ll lm hn dt translated">我们需要在<strong class="kt hv">home/fabric-samples/my network</strong>目录中创建一个名为<strong class="kt hv"> base </strong>的目录。在<strong class="kt hv"> base </strong>中，我们需要创建两个文件，分别命名为<strong class="kt hv">docker-compose-base . YAML</strong>&amp;<strong class="kt hv">peer-base . YAML .</strong></p><p id="5c4e" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated"><strong class="kt hv">docker-compose-base . YAML</strong>文件如下:</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="me mf l"/></div></figure><p id="d0ad" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated"><strong class="kt hv"> peer-base.yaml </strong>文件给出如下:</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="me mf l"/></div></figure><p id="a187" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">现在我们需要在<strong class="kt hv">home/fabric-samples/my network</strong>目录下创建一个名为<strong class="kt hv">docker-compose-CLI . YAML</strong>的文件。</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="me mf l"/></div></figure><p id="cee6" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">Hyperledger Fabric network部署在Docker容器中，因此我们需要编写这些文件。</p><p id="fc80" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">我们将使用CouchDB存储我们的分类帐，所以我们需要创建<strong class="kt hv">docker-compose-couch . YAML</strong>文件。</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="me mf l"/></div></figure><p id="4cfe" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">由于我们正在使用Raft订购服务，我们需要创建<strong class="kt hv">docker-compose-etc draft 2 . YAML</strong>文件。</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="me mf l"/></div></figure><p id="5455" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">我们还需要创造。环境文件。</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="me mf l"/></div></figure><p id="25a5" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">最后，我们完成了所有文件的编写，现在可以使用以下命令启动网络了:</p><pre class="jk jl jm jn fq lt lu lv lw aw lx dt"><span id="75cc" class="ly ka hu lu b fv lz ma l mb mc">docker-compose -f docker-compose-cli.yaml -f docker-compose-couch.yaml -f docker-compose-etcdraft2.yaml up -d</span></pre><h1 id="98ac" class="jz ka hu bd kb kc kd ke kf kg kh ki kj ja kk jb kl jd km je kn jg ko jh kp kq dt translated">第六步</h1><p id="ff7c" class="pw-post-body-paragraph kr ks hu kt b ku kv iv kw kx ky iy kz la lb lc ld le lf lg lh li lj lk ll lm hn dt translated">现在，我们可以创建自己的频道，并向频道添加对等点。为此，我们需要进入CLI容器。</p><pre class="jk jl jm jn fq lt lu lv lw aw lx dt"><span id="a143" class="ly ka hu lu b fv lz ma l mb mc">docker exec -it cli bash</span></pre><p id="4507" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">进入CLI容器后，我们需要添加<strong class="kt hv">通道1 </strong>。</p><pre class="jk jl jm jn fq lt lu lv lw aw lx dt"><span id="07b4" class="ly ka hu lu b fv lz ma l mb mc">#environment variable for peer0.org1<br/><a class="ae ln" href="mailto:CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/users/Admin@org1.example.com" rel="noopener ugc nofollow" target="_blank">CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/users/Admin@org1.example.com</a>/msp<br/>CORE_PEER_ADDRESS=peer0.org1.example.com:7051<br/>CORE_PEER_LOCALMSPID="Org1MSP"<br/>CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/ca.crt</span><span id="3344" class="ly ka hu lu b fv md ma l mb mc">#export channel name<br/>export CHANNEL_NAME=channel1</span><span id="ec1a" class="ly ka hu lu b fv md ma l mb mc">#creation of channel1<br/>peer channel create -o orderer.example.com:7050 -c $CHANNEL_NAME -f ./channel-artifacts/channel1.tx --tls --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem</span></pre><p id="2f3a" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">现在我们需要加入<strong class="kt hv">频道1 </strong>的所有同行。</p><pre class="jk jl jm jn fq lt lu lv lw aw lx dt"><span id="fac2" class="ly ka hu lu b fv lz ma l mb mc">#Now let’s join peer0.org1.example.com to the channel.</span><span id="de22" class="ly ka hu lu b fv md ma l mb mc">peer channel join -b channel1.block</span><span id="b830" class="ly ka hu lu b fv md ma l mb mc">#Rather than join every peer, we will simply join peer1.org1.example.com in our channel.<br/><a class="ae ln" href="mailto:CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/users/Admin@org1.example.com" rel="noopener ugc nofollow" target="_blank">CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/users/Admin@org1.example.com</a>/msp CORE_PEER_ADDRESS=peer1.org1.example.com:8051 CORE_PEER_LOCALMSPID="Org1MSP" CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/peers/peer1.org1.example.com/tls/ca.crt peer channel join -b channel1.block</span><span id="bde7" class="ly ka hu lu b fv md ma l mb mc">#Rather than join every peer, we will simply join peer0.org2.example.com so that we can properly update the anchor peer definitions in our channel.</span><span id="824a" class="ly ka hu lu b fv md ma l mb mc"><a class="ae ln" href="mailto:CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/users/Admin@org2.example.com" rel="noopener ugc nofollow" target="_blank">CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/users/Admin@org2.example.com</a>/msp CORE_PEER_ADDRESS=peer0.org2.example.com:9051 CORE_PEER_LOCALMSPID="Org2MSP" CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/peers/peer0.org2.example.com/tls/ca.crt peer channel join -b channel1.block</span><span id="b1f4" class="ly ka hu lu b fv md ma l mb mc">#Rather than join every peer, we will simply join peer1.org2.example.com in our channel.<br/><a class="ae ln" href="mailto:CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/users/Admin@org2.example.com" rel="noopener ugc nofollow" target="_blank">CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/users/Admin@org2.example.com</a>/msp CORE_PEER_ADDRESS=peer1.org2.example.com:10051 CORE_PEER_LOCALMSPID="Org2MSP" CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/peers/peer1.org2.example.com/tls/ca.crt peer channel join -b channel1.block</span><span id="b189" class="ly ka hu lu b fv md ma l mb mc">#Rather than join every peer, we will simply join peer0.org3.example.com so that we can properly update the anchor peer definitions in our channel.</span><span id="9411" class="ly ka hu lu b fv md ma l mb mc"><a class="ae ln" href="mailto:CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org3.example.com/users/Admin@org3.example.com" rel="noopener ugc nofollow" target="_blank">CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org3.example.com/users/Admin@org3.example.com</a>/msp CORE_PEER_ADDRESS=peer0.org3.example.com:11051 CORE_PEER_LOCALMSPID="Org3MSP" CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org3.example.com/peers/peer0.org3.example.com/tls/ca.crt peer channel join -b channel1.block</span></pre><p id="a342" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">现在我们需要更新频道定义来定义<strong class="kt hv">频道1 </strong>的锚节点。</p><pre class="jk jl jm jn fq lt lu lv lw aw lx dt"><span id="07d0" class="ly ka hu lu b fv lz ma l mb mc">#Update the channel definition to define the anchor peer for Org1 as peer0.org1.example.com:</span><span id="9514" class="ly ka hu lu b fv md ma l mb mc"><a class="ae ln" href="mailto:CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/users/Admin@org1.example.com" rel="noopener ugc nofollow" target="_blank">CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/users/Admin@org1.example.com</a>/msp CORE_PEER_ADDRESS=peer0.org1.example.com:7051 CORE_PEER_LOCALMSPID="Org1MSP" CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/ca.crt peer channel update -o orderer.example.com:7050 -c $CHANNEL_NAME -f ./channel-artifacts/Org1MSPanchors_channel1.tx --tls --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem</span><span id="9598" class="ly ka hu lu b fv md ma l mb mc">#Now update the channel definition to define the anchor peer for Org2 as peer0.org2.example.com.</span><span id="417c" class="ly ka hu lu b fv md ma l mb mc"><a class="ae ln" href="mailto:CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/users/Admin@org2.example.com" rel="noopener ugc nofollow" target="_blank">CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/users/Admin@org2.example.com</a>/msp CORE_PEER_ADDRESS=peer0.org2.example.com:9051 CORE_PEER_LOCALMSPID="Org2MSP" CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/peers/peer0.org2.example.com/tls/ca.crt peer channel update -o orderer.example.com:7050 -c $CHANNEL_NAME -f ./channel-artifacts/Org2MSPanchors_channel1.tx --tls --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem</span><span id="0dcc" class="ly ka hu lu b fv md ma l mb mc">#Now update the channel definition to define the anchor peer for Org3 as peer0.org3.example.com.</span><span id="e9bf" class="ly ka hu lu b fv md ma l mb mc"><a class="ae ln" href="mailto:CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org3.example.com/users/Admin@org3.example.com" rel="noopener ugc nofollow" target="_blank">CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org3.example.com/users/Admin@org3.example.com</a>/msp CORE_PEER_ADDRESS=peer0.org3.example.com:11051 CORE_PEER_LOCALMSPID="Org3MSP" CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org3.example.com/peers/peer0.org3.example.com/tls/ca.crt peer channel update -o orderer.example.com:7050 -c $CHANNEL_NAME -f ./channel-artifacts/Org3MSPanchors_channel1.tx --tls --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem</span></pre><p id="9aac" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">我们需要对<strong class="kt hv">通道2 </strong>和<strong class="kt hv"> </strong>遵循相同的程序。所有命令如下所示:</p><pre class="jk jl jm jn fq lt lu lv lw aw lx dt"><span id="378d" class="ly ka hu lu b fv lz ma l mb mc">#environment variable for peer0.org2<br/><a class="ae ln" href="mailto:CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/users/Admin@org2.example.com" rel="noopener ugc nofollow" target="_blank">CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/users/Admin@org2.example.com</a>/msp<br/>CORE_PEER_ADDRESS=peer0.org2.example.com:9051<br/>CORE_PEER_LOCALMSPID="Org2MSP"<br/>CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/peers/peer0.org2.example.com/tls/ca.crt</span><span id="e4c8" class="ly ka hu lu b fv md ma l mb mc">#export channel name<br/>export CHANNEL_NAME=channel2</span><span id="7cee" class="ly ka hu lu b fv md ma l mb mc">#creation of channel2<br/>peer channel create -o orderer.example.com:7050 -c $CHANNEL_NAME -f ./channel-artifacts/channel2.tx --tls --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem</span><span id="8679" class="ly ka hu lu b fv md ma l mb mc">#Now let’s join peer0.org1.example.com to the channel.</span><span id="f2c5" class="ly ka hu lu b fv md ma l mb mc">peer channel join -b channel2.block</span><span id="fe70" class="ly ka hu lu b fv md ma l mb mc">#Rather than join every peer, we will simply join peer0.org3.example.com so that we can properly update the anchor peer definitions in our channel.</span><span id="b3bb" class="ly ka hu lu b fv md ma l mb mc"><a class="ae ln" href="mailto:CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org3.example.com/users/Admin@org3.example.com" rel="noopener ugc nofollow" target="_blank">CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org3.example.com/users/Admin@org3.example.com</a>/msp CORE_PEER_ADDRESS=peer0.org3.example.com:11051 CORE_PEER_LOCALMSPID="Org3MSP" CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org3.example.com/peers/peer0.org3.example.com/tls/ca.crt peer channel join -b channel2.block</span><span id="b887" class="ly ka hu lu b fv md ma l mb mc">#Now update the channel definition to define the anchor peer for Org2 as peer0.org2.example.com.</span><span id="9148" class="ly ka hu lu b fv md ma l mb mc"><a class="ae ln" href="mailto:CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/users/Admin@org2.example.com" rel="noopener ugc nofollow" target="_blank">CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/users/Admin@org2.example.com</a>/msp CORE_PEER_ADDRESS=peer0.org2.example.com:7051 CORE_PEER_LOCALMSPID="Org2MSP" CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/peers/peer0.org2.example.com/tls/ca.crt peer channel update -o orderer.example.com:7050 -c $CHANNEL_NAME -f ./channel-artifacts/Org2MSPanchors_channel2.tx --tls --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem</span><span id="b217" class="ly ka hu lu b fv md ma l mb mc">#Now update the channel definition to define the anchor peer for Org3 as peer0.org3.example.com.</span><span id="fc9c" class="ly ka hu lu b fv md ma l mb mc"><a class="ae ln" href="mailto:CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org3.example.com/users/Admin@org3.example.com" rel="noopener ugc nofollow" target="_blank">CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org3.example.com/users/Admin@org3.example.com</a>/msp CORE_PEER_ADDRESS=peer0.org3.example.com:7051 CORE_PEER_LOCALMSPID="Org3MSP" CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org3.example.com/peers/peer0.org3.example.com/tls/ca.crt peer channel update -o orderer.example.com:7050 -c $CHANNEL_NAME -f ./channel-artifacts/Org3MSPanchors_channel2.tx --tls --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem</span></pre><h1 id="9073" class="jz ka hu bd kb kc kd ke kf kg kh ki kj ja kk jb kl jd km je kn jg ko jh kp kq dt translated">第六步</h1><p id="922d" class="pw-post-body-paragraph kr ks hu kt b ku kv iv kw kx ky iy kz la lb lc ld le lf lg lh li lj lk ll lm hn dt translated">我们将在两个渠道中安装两个不同的智能合约。</p><p id="536d" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">我们将在<strong class="kt hv">通道1 </strong>中安装智能合约'<strong class="kt hv"> mycc </strong> ' (S1)，并将针对每个对等体发出安装<strong class="kt hv"> </strong>命令。通过使用go语言，智能合同被写在<strong class="kt hv">home/fabric-samples/chain code/chain code _ example 02</strong>目录下。</p><pre class="jk jl jm jn fq lt lu lv lw aw lx dt"><span id="fab6" class="ly ka hu lu b fv lz ma l mb mc">#Applications interact with the blockchain ledger through chaincode. As such we need to install the chaincode on every peer that will execute and endorse our transactions, and then instantiate the chaincode on the channel.<br/>#Modify the following four environment variables to issue the install command against peer0 in Org1:<br/><a class="ae ln" href="mailto:CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/users/Admin@org1.example.com" rel="noopener ugc nofollow" target="_blank">CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/users/Admin@org1.example.com</a>/msp<br/>CORE_PEER_ADDRESS=peer0.org1.example.com:7051<br/>CORE_PEER_LOCALMSPID="Org1MSP"<br/>CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/ca.crt</span><span id="d22e" class="ly ka hu lu b fv md ma l mb mc"># this installs the Go chaincode. For go chaincode -p takes the relative path from $GOPATH/src<br/>peer chaincode install -n mycc -v 1.0 -p github.com/chaincode/chaincode_example02/go/</span><span id="26c4" class="ly ka hu lu b fv md ma l mb mc">#Modify the following four environment variables to issue the install command against peer1 in Org1:<br/><a class="ae ln" href="mailto:CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/users/Admin@org1.example.com" rel="noopener ugc nofollow" target="_blank">CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/users/Admin@org1.example.com</a>/msp<br/>CORE_PEER_ADDRESS=peer1.org1.example.com:8051<br/>CORE_PEER_LOCALMSPID="Org1MSP"<br/>CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/peers/peer1.org1.example.com/tls/ca.crt</span><span id="0177" class="ly ka hu lu b fv md ma l mb mc">#Now install the sample Go chaincode onto a peer1 in Org1<br/>peer chaincode install -n mycc -v 1.0 -p  github.com/chaincode/chaincode_example02/go/</span><span id="4ce4" class="ly ka hu lu b fv md ma l mb mc">#Modify the following four environment variables to issue the install command against peer0 in Org2:</span><span id="3d7d" class="ly ka hu lu b fv md ma l mb mc"><a class="ae ln" href="mailto:CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/users/Admin@org2.example.com" rel="noopener ugc nofollow" target="_blank">CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/users/Admin@org2.example.com</a>/msp<br/>CORE_PEER_ADDRESS=peer0.org2.example.com:9051<br/>CORE_PEER_LOCALMSPID="Org2MSP"<br/>CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/peers/peer0.org2.example.com/tls/ca.crt</span><span id="50a5" class="ly ka hu lu b fv md ma l mb mc">#Now install the sample Go chaincode onto a peer0 in Org2<br/>peer chaincode install -n mycc -v 1.0 -p  github.com/chaincode/chaincode_example02/go/</span><span id="cf39" class="ly ka hu lu b fv md ma l mb mc">#Modify the following four environment variables to issue the install command against peer1 in Org2:</span><span id="d945" class="ly ka hu lu b fv md ma l mb mc"><a class="ae ln" href="mailto:CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/users/Admin@org2.example.com" rel="noopener ugc nofollow" target="_blank">CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/users/Admin@org2.example.com</a>/msp<br/>CORE_PEER_ADDRESS=peer1.org2.example.com:10051<br/>CORE_PEER_LOCALMSPID="Org2MSP"<br/>CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/peers/peer1.org2.example.com/tls/ca.crt</span><span id="5bb5" class="ly ka hu lu b fv md ma l mb mc">#17. Now install the sample Go chaincode onto a peer1 in Org2.</span><span id="f513" class="ly ka hu lu b fv md ma l mb mc">peer chaincode install -n mycc -v 1.0 -p  github.com/chaincode/chaincode_example02/go/</span><span id="50db" class="ly ka hu lu b fv md ma l mb mc">#Modify the following four environment variables to issue the install command against peer0 in Org3:</span><span id="3331" class="ly ka hu lu b fv md ma l mb mc"><a class="ae ln" href="mailto:CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org3.example.com/users/Admin@org3.example.com" rel="noopener ugc nofollow" target="_blank">CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org3.example.com/users/Admin@org3.example.com</a>/msp<br/>CORE_PEER_ADDRESS=peer0.org3.example.com:11051<br/>CORE_PEER_LOCALMSPID="Org3MSP"<br/>CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org3.example.com/peers/peer0.org3.example.com/tls/ca.crt</span><span id="c52d" class="ly ka hu lu b fv md ma l mb mc">#17.1 Now install the Go chaincode onto a peer0 in Org3.</span><span id="5157" class="ly ka hu lu b fv md ma l mb mc">peer chaincode install -n mycc -v 1.0 -p  github.com/chaincode/chaincode_example02/go/</span></pre><p id="90b7" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">我们将在<strong class="kt hv">频道2 </strong>中安装智能合约'<strong class="kt hv">弹珠</strong> ' (S2)，并将针对每个对等体发出安装<strong class="kt hv"> </strong>命令。通过使用go语言，智能合同被写在<strong class="kt hv">home/fabric-samples/chain code/marbles 02</strong>目录下。</p><pre class="jk jl jm jn fq lt lu lv lw aw lx dt"><span id="d09d" class="ly ka hu lu b fv lz ma l mb mc">#Modify the following four environment variables to issue the install command against peer0 in Org2:</span><span id="6973" class="ly ka hu lu b fv md ma l mb mc"><a class="ae ln" href="mailto:CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/users/Admin@org2.example.com" rel="noopener ugc nofollow" target="_blank">CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/users/Admin@org2.example.com</a>/msp<br/>CORE_PEER_ADDRESS=peer0.org2.example.com:9051<br/>CORE_PEER_LOCALMSPID="Org2MSP"<br/>CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/peers/peer0.org2.example.com/tls/ca.crt</span><span id="10df" class="ly ka hu lu b fv md ma l mb mc">#Now install the sample Go chaincode onto a peer0 in Org2<br/>peer chaincode install -n marbles -v 1.0 -p github.com/chaincode/marbles02/go</span><span id="a191" class="ly ka hu lu b fv md ma l mb mc">#Modify the following four environment variables to issue the install command against peer0 in Org3:</span><span id="f3c4" class="ly ka hu lu b fv md ma l mb mc"><a class="ae ln" href="mailto:CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org3.example.com/users/Admin@org3.example.com" rel="noopener ugc nofollow" target="_blank">CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org3.example.com/users/Admin@org3.example.com</a>/msp<br/>CORE_PEER_ADDRESS=peer0.org3.example.com:11051<br/>CORE_PEER_LOCALMSPID="Org3MSP"<br/>CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org3.example.com/peers/peer0.org3.example.com/tls/ca.crt</span><span id="8a2d" class="ly ka hu lu b fv md ma l mb mc">#Now install the Go chaincode onto a peer0 in Org3.</span><span id="c8c2" class="ly ka hu lu b fv md ma l mb mc">peer chaincode install -n marbles -v 1.0 -p github.com/chaincode/marbles02/go</span></pre><p id="220f" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">安装后，我们需要实例化我们的链码。</p><p id="9f61" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">要实例化<strong class="kt hv">通道1 </strong>中的链码<strong class="kt hv">‘mycc’</strong>(S1 ),我们需要使用以下命令:</p><pre class="jk jl jm jn fq lt lu lv lw aw lx dt"><span id="4d15" class="ly ka hu lu b fv lz ma l mb mc">#environment variable for peer0.org1<br/><a class="ae ln" href="mailto:CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/users/Admin@org1.example.com" rel="noopener ugc nofollow" target="_blank">CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/users/Admin@org1.example.com</a>/msp<br/>CORE_PEER_ADDRESS=peer0.org1.example.com:7051<br/>CORE_PEER_LOCALMSPID="Org1MSP"<br/>CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/ca.crt</span><span id="2719" class="ly ka hu lu b fv md ma l mb mc">#export channel name<br/>export CHANNEL_NAME=channel1</span><span id="d107" class="ly ka hu lu b fv md ma l mb mc">#instantiate<br/>peer chaincode instantiate -o orderer.example.com:7050 --tls --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C $CHANNEL_NAME -n mycc -v 1.0 -c '{"Args":["init","a", "100", "b","200"]}' -P "OR ('Org1MSP.peer', 'Org2MSP.peer', 'Org3MSP.peer')"</span></pre><p id="ccbc" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">要实例化<strong class="kt hv">通道2 </strong>中的链码<strong class="kt hv">‘弹珠’</strong>(S2)，我们需要使用以下命令:</p><pre class="jk jl jm jn fq lt lu lv lw aw lx dt"><span id="369e" class="ly ka hu lu b fv lz ma l mb mc">#environment variable for peer0.org2<br/><a class="ae ln" href="mailto:CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/users/Admin@org2.example.com" rel="noopener ugc nofollow" target="_blank">CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/users/Admin@org2.example.com</a>/msp<br/>CORE_PEER_ADDRESS=peer0.org2.example.com:9051<br/>CORE_PEER_LOCALMSPID="Org2MSP"<br/>CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/peers/peer0.org2.example.com/tls/ca.crt</span><span id="1bf8" class="ly ka hu lu b fv md ma l mb mc">#export channel name<br/>export CHANNEL_NAME=channel2</span><span id="9dc1" class="ly ka hu lu b fv md ma l mb mc">#instantiate<br/>peer chaincode instantiate -o orderer.example.com:7050 --tls --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C $CHANNEL_NAME -n marbles -v 1.0 -c '{"Args":["init"]}' -P "OR ('Org2MSP.peer','Org3MSP.peer')"</span></pre><h1 id="4fce" class="jz ka hu bd kb kc kd ke kf kg kh ki kj ja kk jb kl jd km je kn jg ko jh kp kq dt translated">第七步</h1><p id="f3c7" class="pw-post-body-paragraph kr ks hu kt b ku kv iv kw kx ky iy kz la lb lc ld le lf lg lh li lj lk ll lm hn dt translated">我们完成了所有的配置设置，现在我们准备使用我们的网络。</p><p id="bbd3" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">首先，我们通过使用以下命令尝试使用<strong class="kt hv">通道1 </strong>:</p><pre class="jk jl jm jn fq lt lu lv lw aw lx dt"><span id="ce97" class="ly ka hu lu b fv lz ma l mb mc">#environmental variable for peer0.org1<br/><a class="ae ln" href="mailto:CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/users/Admin@org1.example.com" rel="noopener ugc nofollow" target="_blank">CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/users/Admin@org1.example.com</a>/msp<br/>CORE_PEER_ADDRESS=peer0.org1.example.com:7051<br/>CORE_PEER_LOCALMSPID="Org1MSP"<br/>CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/ca.crt</span><span id="6410" class="ly ka hu lu b fv md ma l mb mc">#export channel name<br/>export CHANNEL_NAME=channel1</span><span id="74d8" class="ly ka hu lu b fv md ma l mb mc">#query<br/>peer chaincode query -C $CHANNEL_NAME -n mycc -c '{"Args":["query","a"]}'<br/>peer chaincode query -C $CHANNEL_NAME -n mycc -c '{"Args":["query","b"]}'</span><span id="02b7" class="ly ka hu lu b fv md ma l mb mc">#invoking<br/>peer chaincode invoke -o orderer.example.com:7050 --tls true --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C $CHANNEL_NAME -n mycc --peerAddresses peer0.org1.example.com:7051 --tlsRootCertFiles /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/ca.crt  -c '{"Args":["invoke","a","b","10"]}'</span><span id="ad0b" class="ly ka hu lu b fv md ma l mb mc">#environmental variable for peer0.org2<br/><a class="ae ln" href="mailto:CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/users/Admin@org2.example.com" rel="noopener ugc nofollow" target="_blank">CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/users/Admin@org2.example.com</a>/msp<br/>CORE_PEER_ADDRESS=peer0.org2.example.com:9051<br/>CORE_PEER_LOCALMSPID="Org2MSP"<br/>CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/peers/peer0.org2.example.com/tls/ca.crt</span><span id="43e0" class="ly ka hu lu b fv md ma l mb mc">#export channel name<br/>export CHANNEL_NAME=channel1</span><span id="8718" class="ly ka hu lu b fv md ma l mb mc">#query<br/>peer chaincode query -C $CHANNEL_NAME -n mycc -c '{"Args":["query","a"]}'<br/>peer chaincode query -C $CHANNEL_NAME -n mycc -c '{"Args":["query","b"]}'</span></pre><p id="498e" class="pw-post-body-paragraph kr ks hu kt b ku lo iv kw kx lp iy kz la lq lc ld le lr lg lh li ls lk ll lm hn dt translated">现在我们通过使用以下命令尝试使用<strong class="kt hv">通道2 </strong>:</p><pre class="jk jl jm jn fq lt lu lv lw aw lx dt"><span id="325c" class="ly ka hu lu b fv lz ma l mb mc">#environmental variable for peer0.org2<br/><a class="ae ln" href="mailto:CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/users/Admin@org2.example.com" rel="noopener ugc nofollow" target="_blank">CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/users/Admin@org2.example.com</a>/msp<br/>CORE_PEER_ADDRESS=peer0.org2.example.com:9051<br/>CORE_PEER_LOCALMSPID="Org2MSP"<br/>CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/peers/peer0.org2.example.com/tls/ca.crt</span><span id="2a3e" class="ly ka hu lu b fv md ma l mb mc">#export channel name<br/>export CHANNEL_NAME=channel2</span><span id="e22a" class="ly ka hu lu b fv md ma l mb mc">#invoking<br/>peer chaincode invoke -o orderer.example.com:7050 --tls --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C $CHANNEL_NAME -n marbles -c '{"Args":["initMarble","marble2","red","50","tom"]}'</span><span id="ddf6" class="ly ka hu lu b fv md ma l mb mc">peer chaincode invoke -o orderer.example.com:7050 --tls --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C $CHANNEL_NAME -n marbles -c '{"Args":["initMarble","marble1","blue","35","tom"]}'</span><span id="0c21" class="ly ka hu lu b fv md ma l mb mc">peer chaincode invoke -o orderer.example.com:7050 --tls --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C $CHANNEL_NAME -n marbles -c '{"Args":["initMarble","marble3","blue","70","tom"]}'</span><span id="92fe" class="ly ka hu lu b fv md ma l mb mc">peer chaincode invoke -o orderer.example.com:7050 --tls --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C $CHANNEL_NAME -n marbles -c '{"Args":["transferMarble","marble2","jerry"]}'</span><span id="4a73" class="ly ka hu lu b fv md ma l mb mc">peer chaincode invoke -o orderer.example.com:7050 --tls --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C $CHANNEL_NAME -n marbles -c '{"Args":["transferMarblesBasedOnColor","blue","jerry"]}'</span><span id="b216" class="ly ka hu lu b fv md ma l mb mc">#environmental variable for peer0.org3<br/><a class="ae ln" href="mailto:CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org3.example.com/users/Admin@org3.example.com" rel="noopener ugc nofollow" target="_blank">CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org3.example.com/users/Admin@org3.example.com</a>/msp<br/>CORE_PEER_ADDRESS=peer0.org3.example.com:11051<br/>CORE_PEER_LOCALMSPID="Org3MSP"<br/>CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org3.example.com/peers/peer0.org3.example.com/tls/ca.crt</span><span id="fb4a" class="ly ka hu lu b fv md ma l mb mc">#export channel name<br/>export CHANNEL_NAME=channel2</span><span id="dc06" class="ly ka hu lu b fv md ma l mb mc">#invoking &amp; query<br/>peer chaincode query -C $CHANNEL_NAME -n marbles -c '{"Args":["readMarble","marble2"]}'</span><span id="25a4" class="ly ka hu lu b fv md ma l mb mc">peer chaincode query -C $CHANNEL_NAME -n marbles -c '{"Args":["getHistoryForMarble","marble1"]}'</span><span id="c1b6" class="ly ka hu lu b fv md ma l mb mc">peer chaincode query -C $CHANNEL_NAME -n marbles -c '{"Args":["queryMarblesByOwner","jerry"]}'</span><span id="a9bf" class="ly ka hu lu b fv md ma l mb mc">peer chaincode invoke -o orderer.example.com:7050 --tls --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C $CHANNEL_NAME -n marbles -c '{"Args":["delete","marble1"]}'<br/></span></pre><h1 id="89fe" class="jz ka hu bd kb kc kd ke kf kg kh ki kj ja kk jb kl jd km je kn jg ko jh kp kq dt translated">第八步</h1><p id="0185" class="pw-post-body-paragraph kr ks hu kt b ku kv iv kw kx ky iy kz la lb lc ld le lf lg lh li lj lk ll lm hn dt translated">完成后，最好使用以下命令清除所有设置:</p><pre class="jk jl jm jn fq lt lu lv lw aw lx dt"><span id="05ed" class="ly ka hu lu b fv lz ma l mb mc">#STOP AND DELETE THE DOCKER CONTAINERS<br/>docker ps -aq | xargs -n 1 docker stop<br/>docker ps -aq | xargs -n 1 docker rm -v</span><span id="6bdd" class="ly ka hu lu b fv md ma l mb mc">#DELETE THE OLD DOCKER VOLUMES<br/>docker volume prune -f<br/>#DELETE OLD DOCKER NETWORKS<br/>docker network prune -f</span><span id="08ae" class="ly ka hu lu b fv md ma l mb mc">#Remove all stopped containers<br/>docker container prune -f<br/>#Remove All Unused Objects<br/>docker system prune -f<br/>docker system prune --volumes -f</span><span id="593f" class="ly ka hu lu b fv md ma l mb mc">#DELETE SCRIPT-CREATED FILES<br/>rm -rf channel-artifacts/*.block channel-artifacts/*.tx crypto-config</span><span id="03f7" class="ly ka hu lu b fv md ma l mb mc">#if you get error in future you may also need to remove docker images using the commands given below:<br/>#docker rm -f $(docker ps -aq)<br/>#docker rmi -f $(docker images -q)</span></pre><h1 id="4609" class="jz ka hu bd kb kc kd ke kf kg kh ki kj ja kk jb kl jd km je kn jg ko jh kp kq dt translated">总结:</h1><p id="8b8e" class="pw-post-body-paragraph kr ks hu kt b ku kv iv kw kx ky iy kz la lb lc ld le lf lg lh li lj lk ll lm hn dt translated">在本文中，我们将重点介绍在最低配置下<a class="ae ln" href="https://hyperledger-fabric.readthedocs.io/en/release-1.4/" rel="noopener ugc nofollow" target="_blank"> Hyperledger Fabric v1.4 </a>网络的所有功能。我们希望这对你很有帮助，如果你将面临一些问题，请<a class="ae ln" href="https://hyperledger-fabric.readthedocs.io/en/release-1.4/build_network.html#troubleshooting" rel="noopener ugc nofollow" target="_blank">排除</a>那些。</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="mg mf l"/></div></figure></div></div>    
</body>
</html>