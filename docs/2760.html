<html>
<head>
<title>Brett Lantz shows how to manage data with R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Brett Lantz展示了如何用R</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/brett-lantz-shows-how-to-manage-data-with-r-e144bb46c49f?source=collection_archive---------29-----------------------#2019-04-29">https://medium.com/hackernoon/brett-lantz-shows-how-to-manage-data-with-r-e144bb46c49f?source=collection_archive---------29-----------------------#2019-04-29</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="25a5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">处理海量数据集面临的挑战之一是收集、准备和管理来自各种来源的数据。本文重点介绍了将数据导入和导出r的基本功能。</p><p id="efb7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">基本的R数据结构是vector，它被扩展并组合成更复杂的数据类型，比如列表和数据帧。数据框是一种R数据结构，对应于既有要素又有示例的数据集的概念。r提供了向类似电子表格的表格数据文件读写数据框的函数。</p><p id="3988" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jp">本文节选自Brett Lantz著的《机器学习与R》第三版</em>  <em class="jp">一书。这本书提供了将机器学习应用于现实世界问题的实际操作的可读指南。无论你是一个经验丰富的R用户还是语言新手，这本书都会教你发现关键见解、做出新的预测和可视化你的发现所需的一切。</em></p><h1 id="f445" class="jr js hu bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko dt translated">保存、加载和删除R数据结构</h1><p id="17ff" class="pw-post-body-paragraph ir is hu it b iu kp iw ix iy kq ja jb jc kr je jf jg ks ji jj jk kt jm jn jo hn dt translated">当您花费大量时间将数据框转换成所需的格式时，您不需要在每次重新启动R会话时重新创建您的工作。要将数据结构保存到一个文件中，以便以后重新加载或传输到另一个系统，使用<code class="eh ku kv kw kx b">save()</code>功能。<code class="eh ku kv kw kx b">save()</code>函数将一个或多个R数据结构写入file参数指定的位置。r数据文件有一个。RData扩展。</p><p id="7a5d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">假设您有三个名为x、y和z的对象，您希望将它们保存到一个永久文件中。无论它们是向量、因子、列表还是数据框，都可以保存到名为mydata的文件中。RData使用以下命令:</p><pre class="ky kz la lb fq lc kx ld le aw lf dt"><span id="2eb4" class="lg js hu kx b fv lh li l lj lk">&gt; save(x, y, z, file = “mydata.RData”)</span></pre><p id="2260" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">load()</code>命令可以重新创建任何保存到<code class="eh ku kv kw kx b">.RData</code>文件的数据结构。要加载前面代码中创建的<code class="eh ku kv kw kx b">mydata.RData</code>文件，只需键入:</p><pre class="ky kz la lb fq lc kx ld le aw lf dt"><span id="15df" class="lg js hu kx b fv lh li l lj lk">&gt; load(“mydata.RData”)</span></pre><p id="5710" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这将在您的R环境中重新创建x、y和z数据结构。</p><p id="149c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv"> <em class="jp">注意</em> </strong> <em class="jp">:小心你正在装载的东西！使用</em> <code class="eh ku kv kw kx b"><em class="jp">load()</em></code> <em class="jp">命令导入的文件中存储的所有数据结构将被添加到您的工作空间，即使它们覆盖了您正在处理的其他内容。</em></p><p id="c7c0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果您需要快速结束您的R会话，<code class="eh ku kv kw kx b">save.image()</code>命令会将您的整个会话写入一个名为<code class="eh ku kv kw kx b">.RData</code>的文件。默认情况下，R将在您下次启动R时查找这个文件，并且您的会话将像您离开时一样被重新创建。</p><p id="8c56" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在R会话中工作一段时间后，您可能已经积累了许多数据结构。列表函数<code class="eh ku kv kw kx b">ls()</code>返回当前内存中所有数据结构的向量。例如，如果您一直遵循本章中的代码，<code class="eh ku kv kw kx b">ls()</code>函数将返回以下内容:</p><pre class="ky kz la lb fq lc kx ld le aw lf dt"><span id="6904" class="lg js hu kx b fv lh li l lj lk">&gt; ls()</span><span id="0fc3" class="lg js hu kx b fv ll li l lj lk">[1] “blood” “flu_status” “gender” “m”</span><span id="80e4" class="lg js hu kx b fv ll li l lj lk">[5] “subject_name” “subject1” “symptoms”</span><span id="97b3" class="lg js hu kx b fv ll li l lj lk">[9] “temperature”</span></pre><p id="3de7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">r在退出会话时会自动清除内存中的所有数据结构，但是对于大型对象，您可能希望尽快释放内存。移除功能<code class="eh ku kv kw kx b">rm()</code>可用于此目的。例如，要消除<code class="eh ku kv kw kx b">m</code>和<code class="eh ku kv kw kx b">subject1</code>对象，只需键入:</p><pre class="ky kz la lb fq lc kx ld le aw lf dt"><span id="1e5d" class="lg js hu kx b fv lh li l lj lk">&gt; rm(m, subject1)</span></pre><p id="e1d1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">rm()</code>函数也可以提供一个要删除的对象名的字符向量。这与<code class="eh ku kv kw kx b">ls()</code>功能一起清除整个R会话。</p><pre class="ky kz la lb fq lc kx ld le aw lf dt"><span id="24dd" class="lg js hu kx b fv lh li l lj lk">&gt; rm(list=ls())</span></pre><p id="f74a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">执行前面的代码时要非常小心，因为在移除对象之前不会提示您！</p><h1 id="184b" class="jr js hu bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko dt translated">从CSV文件导入和保存数据</h1><p id="86e2" class="pw-post-body-paragraph ir is hu it b iu kp iw ix iy kq ja jb jc kr je jf jg ks ji jj jk kt jm jn jo hn dt translated">公共数据集存储在文本文件中是非常常见的。文本文件几乎可以在任何计算机或操作系统上阅读，这使得这种格式几乎是通用的。它们还可以从Microsoft Excel等程序中导出和导入，从而提供了一种快速而简单的处理电子表格数据的方法。</p><p id="2678" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">表格</strong>(如“表格”)数据文件以矩阵形式构成，这样每行文本反映一个例子，每个例子具有相同数量的特征。每行上的特征值由一个预定义的符号分隔，称为<strong class="it hv">分隔符</strong>。通常，表格数据文件的第一行列出数据列的名称。这被称为<strong class="it hv">标题</strong>行。</p><p id="f788" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">也许最常见的表格文本文件格式是<strong class="it hv">逗号分隔值</strong> ( <strong class="it hv"> CSV </strong>)文件，顾名思义，它使用逗号作为分隔符。CSV文件可以导入和导出许多常见的应用程序。表示先前构建的医疗数据集的CSV文件可以存储为:</p><pre class="ky kz la lb fq lc kx ld le aw lf dt"><span id="2953" class="lg js hu kx b fv lh li l lj lk">subject_name,temperature,flu_status,gender,blood_type</span><span id="5f83" class="lg js hu kx b fv ll li l lj lk">John Doe,98.1,FALSE,MALE,O</span><span id="a677" class="lg js hu kx b fv ll li l lj lk">Jane Doe,98.6,FALSE,FEMALE,AB</span><span id="c6fd" class="lg js hu kx b fv ll li l lj lk">Steve Graves,101.4,TRUE, MALE,A</span></pre><p id="b406" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">给定位于R工作目录中的名为<code class="eh ku kv kw kx b">pt_data.csv</code>的患者数据文件，可以使用<code class="eh ku kv kw kx b">read.csv()</code>函数将文件加载到R:</p><pre class="ky kz la lb fq lc kx ld le aw lf dt"><span id="1697" class="lg js hu kx b fv lh li l lj lk">&gt; pt_data &lt;- read.csv(“pt_data.csv”, stringsAsFactors = FALSE)</span></pre><p id="97c7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这将把CSV文件读入名为pt_data的数据帧。正如我们之前在构建数据框时所做的一样，我们需要使用<code class="eh ku kv kw kx b">stringsAsFactors = FALSE</code>参数来防止R将所有文本变量转换为因子。除非您确定CSV文件中的每一列都是真正的因素，否则这一步最好留给您来执行，而不是R。</p><p id="7683" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv"> <em class="jp">注意</em> </strong> <em class="jp">:如果你的数据集驻留在R工作目录之外，那么调用read.csv()函数时可以使用CSV文件的完整路径(例如，“</em> <code class="eh ku kv kw kx b"><em class="jp">/path/to/mydata.csv</em></code> <em class="jp">”)。</em></p><p id="bd6a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">默认情况下，R假设CSV文件包含一个标题行，其中列出了数据集中的要素名称。如果一个CSV文件没有文件头，指定如下命令所示的<code class="eh ku kv kw kx b">option header = FALSE</code>, R将分配默认的特征名称，编号为V1、V2等等:</p><pre class="ky kz la lb fq lc kx ld le aw lf dt"><span id="4589" class="lg js hu kx b fv lh li l lj lk">&gt; mydata &lt;- read.csv(“mydata.csv”, stringsAsFactors = FALSE,</span><span id="b6f3" class="lg js hu kx b fv ll li l lj lk">header = FALSE)</span></pre><p id="8d25" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><code class="eh ku kv kw kx b">read.csv()</code>函数是<code class="eh ku kv kw kx b">read.table()</code>函数的特例，它可以读取许多不同形式的表格数据，包括其他分隔格式，如制表符分隔值(TSV)。关于<code class="eh ku kv kw kx b">read.table()</code>系列功能的更多详细信息，请参考使用<code class="eh ku kv kw kx b">?read.table</code>命令的R帮助页面。</p><p id="da66" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">使用<code class="eh ku kv kw kx b">write.csv()</code>功能将数据框保存为CSV文件。如果您的数据框名为<code class="eh ku kv kw kx b">pt_data</code>，只需输入:</p><pre class="ky kz la lb fq lc kx ld le aw lf dt"><span id="1a5a" class="lg js hu kx b fv lh li l lj lk">&gt; write.csv(pt_data, file = “pt_data.csv”, row.names = FALSE)</span></pre><p id="02cc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这将把一个名为<code class="eh ku kv kw kx b">pt_data.csv</code>的CSV文件写入R工作文件夹。row.names参数覆盖R的默认设置，即在CSV文件中输出行名。</p><h1 id="9f09" class="jr js hu bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko dt translated">结论</h1><p id="7051" class="pw-post-body-paragraph ir is hu it b iu kp iw ix iy kq ja jb jc kr je jf jg ks ji jj jk kt jm jn jo hn dt translated">在本文中，我们学习了在R中管理数据的基础知识。我们从学习用于在R中存储各种类型的数据的结构以及如何保存它们开始。然后，我们继续以常用的CSV格式读写数据。</p><p id="cff1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">现在，我们已经花了一些时间来理解R的数据管理基础，您已经准备好开始使用机器学习来解决现实世界的问题。要进一步研究，可以参考Brett Lantz的最新著作<a class="ae jq" href="https://prod.packtpub.com/big-data-and-business-intelligence/machine-learning-r-third-edition" rel="noopener ugc nofollow" target="_blank"> <em class="jp">带R的机器学习，第三版</em> </a>。</p><h1 id="761c" class="jr js hu bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko dt translated">关于作者</h1><p id="3446" class="pw-post-body-paragraph ir is hu it b iu kp iw ix iy kq ja jb jc kr je jf jg ks ji jj jk kt jm jn jo hn dt translated"><em class="jp"> Brett Lantz是DataCamp讲师，也是世界各地机器学习会议和研讨会的常客。作为一名训练有素的社会学家，Brett第一次被机器学习迷住是在对一个大型社交网络档案数据库进行研究的过程中。</em></p></div></div>    
</body>
</html>