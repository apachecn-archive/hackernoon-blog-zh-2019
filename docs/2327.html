<html>
<head>
<title>DNS 101</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">DNS 101</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/dns-101-fdcbdbe9ccf6#2019-04-11">https://medium.com/hackernoon/dns-101-fdcbdbe9ccf6#2019-04-11</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/8fdc89309cb9f3e00f070be7370bf57c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eudhAwCgF58Wj7Ur96dIQA.jpeg"/></div></div></figure><figure class="jc jd je jf fq iv"><div class="bz el l di"><div class="jg jh l"/></div></figure></div><div class="ab cl ji jj hc jk" role="separator"><span class="jl bw bk jm jn jo"/><span class="jl bw bk jm jn jo"/><span class="jl bw bk jm jn"/></div><div class="hn ho hp hq hr"><p id="3706" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">凯尔萨斯的乔恩·克里斯滕森和克里斯·希克曼讲授了域名系统(DNS)的入门知识，并解释了当有人在浏览器中键入 URL(即互联网链接)时会发生什么。它们揭开了流程的神秘面纱，帮助您理解 DNS 是如何工作的以及其中涉及的机制。</p><p id="d023" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">该节目的一些亮点包括:</p><ul class=""><li id="a45a" class="kn ko hu jr b js jt jw jx ka kp ke kq ki kr km ks kt ku kv dt translated">什么是 DNS？互联网过去和现在的基本协议；通过友好的互联网协议(IP)地址建立连接，以识别和映射网络中的服务器</li><li id="183d" class="kn ko hu jr b js kw jw kx ka ky ke kz ki la km ks kt ku kv dt translated">DNS 和 IP 地址通过不同层次提供可扩展性。com，。网，。组织)</li><li id="3342" class="kn ko hu jr b js kw jw kx ka ky ke kz ki la km ks kt ku kv dt translated">DNS 服务器充当他们拥有和管理的域名的权威来源；服务器可以托管多个区域和级别来分割 URL 命名空间</li><li id="1dee" class="kn ko hu jr b js kw jw kx ka ky ke kz ki la km ks kt ku kv dt translated">DNS 的优势:多样化、功能强大、灵活，并能处理互联网流量</li><li id="81a6" class="kn ko hu jr b js kw jw kx ka ky ke kz ki la km ks kt ku kv dt translated">生存时间(TTL):指定解析程序缓存查询的时间长度或迭代次数的 DNS 记录设置</li><li id="4bab" class="kn ko hu jr b js kw jw kx ka ky ke kz ki la km ks kt ku kv dt translated">各种操作系统的 DNS 查找工具包括 Dig 和 NGiNX</li></ul><p id="2f7a" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated"><strong class="jr hv">链接和资源</strong></p><p id="c53c" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated"><a class="ae lb" href="https://en.wikipedia.org/wiki/IPv4" rel="noopener ugc nofollow" target="_blank">IP v4</a><br/><a class="ae lb" href="https://aws.amazon.com/route53/" rel="noopener ugc nofollow" target="_blank">AWS Route 53</a><br/><a class="ae lb" href="https://www.godaddy.com/" rel="noopener ugc nofollow" target="_blank">go daddy</a><br/><a class="ae lb" href="https://www.nginx.com/" rel="noopener ugc nofollow" target="_blank">NGiNX</a><br/><a class="ae lb" href="https://dnspropagation.net/dns-tools/" rel="noopener ugc nofollow" target="_blank">DNS 工具</a><br/><a class="ae lb" href="https://kelsus.com" rel="noopener ugc nofollow" target="_blank">kel sus</a><br/><a class="ae lb" href="https://www.secretstache.com/" rel="noopener ugc nofollow" target="_blank">Secret Stache Media</a></p><p id="65d8" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated"><strong class="jr hv">成绩单</strong></p><p id="825b" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">Rich:在 Mobycast 的第 54 集，Jon 和 Chris 教授了一个关于 DNS 的入门知识，并解释了当你在浏览器中输入 URL 时会发生什么。欢迎来到 Mobycast，这是一个关于云原生开发、AWS 和构建分布式系统的每周对话。让我们直接开始吧。</p><p id="1246" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">乔恩:欢迎你，克里斯。又是一集 Mobycast。</p><p id="5a2e" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">克里斯:嘿，乔恩。回来真好。</p><p id="a1ef" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">乔恩:很高兴和你谈话。那么，你这周在忙什么？</p><p id="dc0e" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">克里斯:我正在从上周史诗般的巴西之旅的时差中恢复过来。单程 32 小时。</p><p id="8b65" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">乔恩:哎哟。不过是谦虚的吹牛。哦，可怜的巴西人。</p><p id="d323" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">克里斯:太讽刺了。在巴西呆了四天，在这段旅程的两边呆了 32 个小时。几乎要被唤醒了。就像一个[…]。我付钱了。</p><p id="5d26" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">乔恩:你说了。我也是。我正在努力从巴西恢复过来。这很有趣，因为在我看到车队并对我们的未来感到兴奋后，这次旅行激励了我，但它也让我筋疲力尽。所以，我回来时动力十足，却没有精力做任何事情。但是我们在这里。下周，动力将会真正发挥作用。</p><p id="63e0" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">我们在那里谈论的一件事是，我们和团队一起上了很多课。我们决定今年复习一些基础知识。你对任何运动的基础越好，包括软件编程，你就越优秀。所以，我们决定回到一些基本的东西，只是重温一些很多人可能从来没有真正接触过的东西，其他人从大学课程开始就没有接触过。</p><p id="7389" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">我们谈得很多的事情之一是网络。今天，我们谈了一整天。我们不会这样对你，我们的听众。我们将长话短说，今天我们将与您进行一个小小的网络整体讨论。这可能是一个关于网络的系列的开始，我们将进入网络的基础知识，然后在 AWS 中围绕网络的一些细节，因为这只是超级有趣的东西。</p><p id="70d8" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">这可能是未来几集的轨迹，除非发生重大事件，否则我们必须做一个特别报告，就像我们最近对一些开源恶作剧所做的那样。</p><p id="f380" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">今天，我们将谈论 DNS。当你在浏览器中输入 www.kelsus.com 时会发生什么——现在就输入吧。</p><p id="7555" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">克里斯:我们会等的。</p><p id="2740" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">乔恩:是的，然后发生了什么？这就是我们今天要讲的内容，也许克里斯可以先给我们讲讲这个问题的答案。</p><p id="037b" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">克里斯:对。正如你提到的，当我们在巴西的[…]静修时，我们为团队进行了一系列技术内容培训，其中之一就是关于网络。正如你提到的，有很多东西要涵盖，但 DNS 肯定是其中的一个基本部分。</p><p id="e110" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">所以，只要想想当你输入一个网址时会发生什么，你的浏览器怎么知道去哪里？真正发生的机制是什么？这可能比大多数人意识到的要复杂得多。这很有趣，所以今天我们可以走一遍这个流程，来帮助揭开一点神秘的面纱，让大家更好地理解 DNS 是如何工作的。</p><p id="773d" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">也许从高层次开始，DNS 是域名系统的缩写。真的，DNS 是为我们，为人们而创造的。</p><p id="ec30" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">乔恩:是的。电脑不需要。没有它他们也很好。</p><p id="1ce8" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">克里斯:他们不仅不需要，而且也不想要。效率不是很高。在互联网的初期，当网络开始出现时，你有物理卡和网络接口卡。过去，网络中的所有东西，一张放置的卡最终都有一个 IP 地址。这叫做 IPv4，所以它是一个带点的 IP 地址。它有四个组成部分，很明显每个人都见过这些东西。192.32.33.255 或 232。255 其实很特别，我们不会用那个。这是地址。当这一切刚开始的时候，人们就是这么做的。他们连接到其中一个地址。</p><p id="bc49" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">一旦他们开始成为网络上的多台机器，人们很快就意识到这是行不通的。他们无法记住所有这些零散的东西，也无法将它们放在笔记本的某个地方，只是手动跟踪，“哦，那是乔恩的服务器，”或者，“那是拉里的服务器”，或者，“那是苏珊的服务器。”这种保持跟踪的概念，比如给这些地址取一些友好的名字，就是它的开始。</p><p id="cb57" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">这只是一个简单的文本文件，实际上是一个宿主文件。它是一个非常小的目录和一个文本文件，在友好名称和实际地址之间保存了一个映射。这使得人们能够输入那个友好的名字。他们可以键入“jon ”,这样就可以解析出 Jon 的 IP 地址，同样，也可以解析出 Susan 的 IP 地址。那是它的开始。</p><p id="7f9f" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">Jon:对，那个主机文件至少在 Unix 系统中的/etc/hosts 下。</p><p id="c2fb" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">克里斯:有趣的是，它今天仍然存在。它不仅存在于今天，而且我们会发现，它仍然是查找过程的一部分，因此它仍然是将主机名解析为实际地址时发生的事件链中的第一个环节。</p><p id="445e" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">其实那就是 DNS 基本上就是互联网的电话簿。你可以通过名字查找某样东西，它会给你它的地址。这就是计算机如何计算出？给定一个友好的名称，我连接到什么机器？我把我的包寄到哪里？</p><p id="6ec7" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">乔恩:没错。主机文件并没有真正扩展。你不能把互联网上所有的 IP 地址都放在你的主机文件上，并且用它们的名字来更新它们。人们必须想出另一种方法。</p><p id="d928" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">我喜欢 DNS 的一点是，他们提出的方法是一个任何人都可以参与的协议。并不是一家公司说，“我们将处理互联网上的域名路由。只要把你的钱寄给我们，当你给我们一个名字时，我们就会把 IP 地址发给你。”这就是我们的结局，也是我们现在的处境，因为这就是它的设计，任何人都可以玩。我们仍然有一个协议，任何人都可以建立 DNS 服务器，我认为这是我们必须谈论的旅程的下一部分。什么是 DNS 服务器，它们是做什么的？</p><p id="1fb2" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">克里斯:是的。再一次提到这一点，这很有趣。DNS 是构成互联网主干的早期基本协议之一。这在早期就已经存在了，从一开始就存在了。就像邮件、SMTP 等核心协议一样，这些东西已经存在了一段时间。他们有自己的局限性，他们在信任和安全方面有问题，我们在讨论这个问题时可能会谈到这些问题。</p><p id="f4c2" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">DNS 是一种客户端-服务器架构。您有 DNS 服务器来管理它们所负责的记录，然后您有客户端或解析器来查询这些服务器以获取记录。它基本上只是做一个查询，说，“嘿，这是我要找的名字。你有它的地址吗？”它要么会回复说，“是的，我有”，要么可能会将他们引向其他服务器。它是沿着层级链往下走。当你在 URL 的各个点上移动时，就有了这种父子关系。</p><p id="a5ca" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">你可以把 DNS 看作一个层级，在最顶层你有根，然后你有顶级域名。com，。网，或者。org，然后在它下面你有下一级域名，像 yahoo.com 或 kelsus.com 类型的东西。这里有一个层次结构，但是最终，你有管理文件和响应请求的服务器，然后你有客户端，解析器本身发出这些查询来进行查找。</p><p id="58ff" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">Jon:我喜欢思考的一件有趣的事情是，DNS 和 IP 地址是如何分层的，它们都支持一定的可扩展性。它们都使得只有少数服务器需要知道并负责所有顶级域名，然后我们可以使用其他服务器来处理下一个级别，然后越来越多的服务器可以参与这个“告诉我这个名称的 IP 地址”的游戏。那很酷。协议中内置了可伸缩性。</p><p id="eed6" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">我们不会谈论 IP 路由是如何工作的。这是同样的基本概念，IP 地址基本上是一个地图，告诉计算机如何从这里到那里。这就是为什么你没有“给某人一个 IP 地址和如何到达那里的地图”这是 IP 地址的一部分。很酷的是，它们都以某种方式工作，使得它们仅在协议级别上可伸缩和可用。</p><p id="8f12" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">克里斯:当然。这几乎是达尔文主义。如果它们不起作用，我们就不会在这里谈论这些事情。事实上，它们确实可以工作，并且可以扩展，它们继续存在，并且仍然以这种方式工作，这也是它如此长寿的原因，如果你仔细想想，这是非常令人惊讶的。当 DNS 第一次被创建时，他们真的认为这个网络上会有数十亿台设备和数百万个主机名吗？也许吧，但可能还是比他们想象的要大很多。</p><p id="8d6e" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">乔恩:是的，我同意。让我们再多谈一点关于 DNS 服务器，它们做什么，它们里面有什么。</p><p id="ba6c" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">克里斯:对。同样，DNS 服务器的存在是为了管理它们所拥有的名称，不管它们是否是的权威来源，它们可以托管多个区域。你可以认为一个区域是不同级别的 URL，所以你可能有一个 api.kelsus.com 的区域文件，然后你可能有另一个凯尔萨斯的另一个域的文件。这是分割你的名字空间的一种方式。</p><p id="7ef8" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">这些 DNS 服务器向其他名称服务器注册，以表明它们是哪些域或哪些区域的权威来源。这是这些请求最终被路由到他们的方式之一，他们知道这是他们需要进行查找以找到该名称的地方。</p><p id="d03b" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">Jon:AWS 内部有一些服务器，它们现在对世界说，“嘿，我有 kelsus.com。我有那个。想知道它通向哪里吗？你问我。我来告诉你。”</p><p id="fe46" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">克里斯:对。对于每个域，都有一些注册，比如说，“是的，我是那个特定域的权威源域服务器，”无论你是使用 AWS Route 53，还是使用 GoDaddy DNS 之类的东西，或者其他什么 DNS，如果你在运行自己的服务器或设置自己的服务器，它们都是一样的。</p><p id="1c68" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">嘿，你好。这是丰富的。请原谅我的突然打断。我们最近通过了一个 30，000 次收听的内部里程碑，我想花点时间感谢你们的支持。我还希望鼓励你去 iTunes 给我们留下评论。积极的反馈和建设性的批评对我们来说都非常重要。告诉我们进展如何，我们将保证每周发布新的剧集。好吧，我们继续吧。</p><p id="5683" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">Chris:对于每个区域，你都会有一个记录列表，有各种不同类型的 DNS 记录。你有常规的 IP 地址，如果你愿意，那么给定一个名字，我能连接的 IP 地址是什么？这是一种记录。那叫创纪录。你也可以有重定向，记录的伪名。你可以给某物起一个友好的名字。有时，您可能有一个不太友好的 DNS 名称，并且您希望将其别名化为更好或更容易记住的名称。你可以把这些记录放在那里。这些是 CNAME 唱片，基本上只是，再一次，其他东西的别名。</p><p id="2eea" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">乔恩:插一句，关于这些的好处是，它们保持了原来的样子。所以，如果你有一个 CNAME，你决定让 api.kelsus.com 指向 12345.aws.amazon.com/something-something-something,大量的官样文章，当 CNAME 被输入浏览器时，浏览器会保留 CNAME。它不会切换到别名。不是透明的。这是 CNAME 的一大特色。</p><p id="3b15" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">克里斯:是的，其他类型的记录是用来抓取邮件的。所以，你有邮件传输记录，NX 记录。这告诉发送邮件的客户端，他们需要路由邮件，说“这封邮件应该发送到哪里？”有记录和域名来处理这些。DNS，非常多样化，非常强大，非常灵活。它真的可以处理互联网上的所有流量。同样，给定一个名称，它需要到达的 IP 地址是什么？它就是这么做的。</p><p id="3df0" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">对我来说，另一件非常重要的事情是，这是经常使用的，无论你何时发出任何类型的网络请求，你可能会进行 DNS 查找，问“给定这个主机名，IP 地址是什么？”—为了提高性能，需要大量缓存。这里的缓存非常好，因为在大多数情况下，这些地址不会经常改变。即使你有一些东西或者你正在使用一些[…]，他们也不会经常改变。缓存开始发挥重要作用。</p><p id="1ba4" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">您可以在这些记录上设置 TTL 记录、生存时间值，这为允许中介缓存该记录的时间提供了指导。因此，TTLs 最终变得非常重要。如果您正在设置 DNS，并且您有一些要添加的主机名等等，那么只需考虑如果它相对稳定并且您不希望经常更改它，那么您可以将其设置为更高的 TTL。但是，如果您可能需要深入了解，比如您正在构建一项服务，并且可能要将它从一个环境更改到另一个环境，请意识到当您更新 DNS 服务器时，更新不会立即传播。它将基于你的 TTL 值。如果你有一个很高的 TTL，假设是一天，你可能会惊讶地发现，由于缓存，在所有人都指向新服务器之前，已经过了一整天。</p><p id="923e" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">Jon:对，关于 TTL，我想的是 TTL 和缓存是为什么 DNS 传播对于不同地方的不同人是不同的。你改变域名，你可能在 GoDaddy 上更新它——如果你不幸使用 go daddy——然后又可能改变，“哦，是的。我看到了。没错。这就是变化，”而你在世界另一端的朋友会说，“我还是没发现。”这可能是因为他们攻击的 DNS 服务器缓存的地址比你正在使用的地址更新。和往常一样，你要假设某个 DNS 服务器刚刚缓存了你要更改的地址，所以你必须等待整个 TTL，然后每个人才能更新。</p><p id="b5c6" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">克里斯:没错，是的。如果你曾经使用过 DNS，制作条目，并修改它们，这肯定是你非常熟悉的事情之一，你会被它咬到。你开始运行这个，“嗯，它对我有效，但对我无效，”或者，“我看到了新页面，”或者，“我没有看到新页面，”之类的东西。这绝对是需要考虑的事情。同样，如果你打算改变什么，确保你把它设置到一个低的 TTL，直到你稳定下来，然后你可以把它提高到一个更高的 TTL。在变更灵活性与性能之间取得适当的平衡，并最大限度地减少查找。</p><p id="3349" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">乔恩:对。这已经变得比我想象的更难描述了，“哦，是 DNS。这很简单，也很快捷，”我们在这里还有很多事情要谈。我想接下来我们要讨论的是，克里斯，你是想更深入地了解旋变器，还是想谈谈流程？就像来自浏览器的请求的一天的故事。</p><p id="8465" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">克里斯:在一天结束时，客户端或解析器，如果你愿意，他们基本上只是，“嘿，我需要与某个名称服务器交谈，”所以有一种方法来配置你的客户端，你的解析器，以知道我们要与什么名称交谈，并发出查询，说，“这是我正在寻找的名称。给我一张唱片回来。”有时，如果服务器确实有它，它就完成了。如果它没有，它会告诉它，你应该去和那个孩子说话，然后去做。所以，从客户的角度来看非常简单。</p><p id="0be8" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">有许多不同类型的客户和解决者。有独立的，有一些真正有用的命令行工具，如 dig 和 nslookup。您的浏览器显然是一半的解析器，其中一些是基于操作系统级代码，一些有自己的自定义解析器。类似 Nginx 这样的服务器端软件也是如此。他们什么都有，几乎所有与 DNS 查找相关的连接都有。</p><p id="5040" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">乔恩:我想有一点几乎是不言而喻的，但我会非常明确地说，当你在你的浏览器中键入<a class="ae lb" href="http://www.google.com" rel="noopener ugc nofollow" target="_blank">www.google.com</a>时，你以前从来没有这样做过——它不会缓存 IP 地址或任何可以使用的东西——它会使用几乎是分布式的微服务来查找那个名称，并返回给你那个名称，它必须在开始加载谷歌页面之前完成整个请求。你做的每一件事都是为了请求，而不仅仅是一个。</p><p id="3b50" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">我认为这很容易忘记，因为你只是，“哦，我要去谷歌，”你只是想象网络流量就像是从我的电脑，到谷歌，到[…]，然后回来。不，不，不。它要去一些 DNS 服务器，然后回来，然后去谷歌，然后回来。我不得不说，真的要明确地说出来，以防我们已经讨论过的内容不清楚。</p><p id="703d" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">克里斯:是的，也许更具体地说，不仅仅是两个请求。那个 DNS […]其实潜在地有很多请求，多个请求。</p><p id="e724" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">乔恩:他们需要多长时间？有时需要 60 毫秒？80 毫秒？</p><p id="9422" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">克里斯:对。这取决于你的网络，取决于域名服务器，以及它们的流量。可能是几毫秒，有时可能是几秒。就像其他任何东西一样，它通过互联网发出网络请求。那里有非常真实的延迟。同样，我认为这里真正的要点是，DNS 的工作有很多方面。当你在你的浏览器栏顶部输入那个地址时，你在封面下面输入 google.com，在那个页面出现在你的浏览器之前，有相当多的步骤发生。</p><p id="9aa1" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">乔恩:对，你提到了工具。我认为对于以前从未这样做过的人来说，这是值得的，如果你有一台 Mac，而你们大多数人都是这样做的——只是猜测——只需在终端上键入 dig +trace domain-name。可能是<a class="ae lb" href="http://www.kelsus.com," rel="noopener ugc nofollow" target="_blank">www.kelsus.com，</a>也可能是 mobycast.fm，也可能是 google.com 或其他什么地方，然后看看会出现什么。它是分步骤出来的，里面有很多信息，值得一查。它开始揭示克里斯所说的复杂性。</p><p id="3fd6" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">Chris:通常，中间的查找对你是隐藏的，所以你只能看到最终的结果。当你输入+trace 时，它实际上向你展示了，解决是如何发生的。它从最顶端开始，一直到互联网的根服务器。从那里，它将被传送到 TLD 的服务器上，无论它在 TLD 做什么[……]。所以，TLD 会说，“是吗。com？是吗？网？。org？”</p><p id="6fce" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">有一整套独立的服务来管理这些内容。从那里，它可以找到，“好的，你要找的这个特定地址的权威服务器是什么？”如果你有+trace 选项，你会看到。它非常、非常清楚地显示了那里发生了什么，有一个 DNS 服务器的层次结构，它遍历这个层次结构，使范围变得更窄，以找到它正在寻找的实际信息。</p><p id="3932" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">Jon:在我职业生涯的初期，当我想到 DNS 的时候，我曾经疑惑的一件事是，如果 A 记录指向一个 IP 地址——IP 地址只是一台机器——而你有一个非常大的服务，就像当时可能是 Yahoo！那台机器如何处理所有的流量？</p><p id="fffb" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">老实说，我不知道什么时候有可能有多个 A 记录答案，我也不确定 20 年前是否可能。但是现在可以肯定这是可能的。可能一直以来你都能说，“哦，有四五个不同的答案。这四五个 IP 地址可以循环使用，它们可以处理所有的流量。这有点像 DNS 风格的负载平衡。但我不知道是不是一直都是这样。你知道吗，克里斯？</p><p id="5d7e" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">克里斯:已经有一段时间了。至少从 20 世纪 90 年代初开始，甚至可能在那之前。拥有这种多答案的 DNS 记录肯定已经有一段时间了。当然，现在我们可以使用负载平衡器之类的东西。现在，你可以拥有一个域名，最终，这个域名可能由数百台机器提供服务。</p><p id="d5cc" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">乔恩:对。我想我们可能需要在这里结束。你知道，我们在这次谈话中忽略了安全问题。有点好笑，有点讽刺的是，这是我们还没有达到的部分。也有一点[…]因为你，我们可爱的观众已经向我们展示了你最喜欢的剧集不是安全的那几集。也许我们会尝试在未来的一集里加入一些安全的内容，但不会做一整集关于 DNS 安全的内容。我不知道这是不是每个人都想要的。值得一提的是，在 DNS 安全性方面有很多很酷的东西，我们完全想在不久的将来讨论一下。</p><p id="b6e6" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">克里斯:对，可能会很无聊或者没那么有趣，但是实际上，这真的很重要。我们讨论过它的功能，比如写邮件。如果你能够欺骗或者做一个中间人，为你的邮件服务器更改某个域的 NX 记录，这意味着有人很容易劫持你的邮件。每当有人给你发邮件，而不是邮件被转发到服务器托管你的邮箱，它去了一些流氓邮箱。你永远不会知道，除了人们会这样，“嘿，你为什么要改变一些电子邮件？我一个都没得到。”</p><p id="e24c" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">Jon:也许这就是我们让人们收听即将播出的 DNS 安全剧集的方法。它将被命名为“如何黑掉域名系统并从亚马逊获得终身免费的东西”。</p><p id="e374" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">克里斯:给你。</p><p id="d6af" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">乔恩:好吧。谢谢大家的聆听，也谢谢克里斯，为我们做了如此精彩的解释。下周我再和你谈。</p><p id="9c09" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">克里斯:好吧。再见。再见。</p><p id="e008" class="pw-post-body-paragraph jp jq hu jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hn dt translated">亲爱的听众，你坚持到了最后。感谢您抽出时间，并邀请您继续与我们在线交流。这一集，以及显示笔记和其他宝贵的资源可在 mobycast.fm/54.如果你有任何问题或额外的见解，我们鼓励你给我们留下评论。谢谢你，我们下周再见。</p></div></div>    
</body>
</html>