<html>
<head>
<title>A Simple Blockchain Application for Data Verification.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一个简单的数据验证的区块链应用。</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/a-simple-blockchain-application-for-data-verification-c288a64e0d24#2019-06-24">https://medium.com/hackernoon/a-simple-blockchain-application-for-data-verification-c288a64e0d24#2019-06-24</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="611f" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">了解如何用几行代码为以太坊编写一个可行的应用程序。</h2></div><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff jj"><img src="../Images/575bd76a771a810c92d9fe823ed17bd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UJpg8VlwyqmSedMqyLoWzQ.jpeg"/></div></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek">Photo from Pixabay</figcaption></figure><blockquote class="jz ka kb"><p id="3293" class="kc kd ke kf b kg kh iv ki kj kk iy kl km kn ko kp kq kr ks kt ku kv kw kx ky hn dt translated">所有伟大的事情都很简单，许多都可以用一个词来表达:自由、正义、荣誉、责任、仁慈、希望。——温斯顿·丘吉尔</p></blockquote><h1 id="6abc" class="kz la hu bd lb lc ld le lf lg lh li lj ja lk jb ll jd lm je ln jg lo jh lp lq dt translated"><strong class="ak">简介</strong></h1><p id="f023" class="pw-post-body-paragraph kc kd hu kf b kg lr iv ki kj ls iy kl lt lu ko kp lv lw ks kt lx ly kw kx ky hn dt translated">在这篇文章中，我将描述我所知道的最简单的区块链应用程序，并给出代码示例。这对于那些从区块链领域起步的人来说很有用，对于更有经验的架构师来说也是一种设计模式。</p><p id="c2ec" class="pw-post-body-paragraph kc kd hu kf b kg kh iv ki kj kk iy kl lt kn ko kp lv kr ks kt lx kv kw kx ky hn dt translated">想象下面的用例。你收到了一份经过几手的文件，你想确定它是真实的。该文档可能是您正在购买的汽车的服务手册，也可能是声明您正在购买的房子确实属于卖方的文档。什么都有可能。</p><p id="5e99" class="pw-post-body-paragraph kc kd hu kf b kg kh iv ki kj kk iy kl lt kn ko kp lv kr ks kt lx kv kw kx ky hn dt translated">数字地<a class="ae lz" href="http://blogs.mdaemon.com/index.php/2018/05/29/encrypting-vs-signing-with-openpgp-whats-the-difference-2/" rel="noopener ugc nofollow" target="_blank">签署文件</a>以确保它们没有被篡改并不是什么新鲜事。您可以获取文档的内容，并用它们生成一个加密签名，该签名与文档一起发送。</p><blockquote class="ma"><p id="3f80" class="mb mc hu bd md me mf mg mh mi mj ky ek translated">在这篇文章中，我将描述我所知道的最简单的区块链应用程序，并给出代码示例。</p></blockquote><p id="e8ea" class="pw-post-body-paragraph kc kd hu kf b kg mk iv ki kj ml iy kl lt mm ko kp lv mn ks kt lx mo kw kx ky hn dt translated">文档的接收者可以再次生成签名，并验证它是否与所提供的签名相匹配。匹配意味着文档没有改变。</p><p id="dd29" class="pw-post-body-paragraph kc kd hu kf b kg kh iv ki kj kk iy kl lt kn ko kp lv kr ks kt lx kv kw kx ky hn dt translated">这是你用<a class="ae lz" href="https://en.wikipedia.org/wiki/MD5" rel="noopener ugc nofollow" target="_blank"> MD5 校验和</a>得到的，使用起来非常方便。它的缺点是需要接收签名来验证文件的真实性。如果有人从中作梗，把文件和签名都改了，你也不会知道。</p><p id="4e04" class="pw-post-body-paragraph kc kd hu kf b kg kh iv ki kj kk iy kl lt kn ko kp lv kr ks kt lx kv kw kx ky hn dt translated">由于从个人那里获取数据并不容易被信任，有时第三方会介入提供记录服务以获取利润。这种利润动机是保持记录者诚实的原因。</p><p id="4dda" class="pw-post-body-paragraph kc kd hu kf b kg kh iv ki kj kk iy kl lt kn ko kp lv kr ks kt lx kv kw kx ky hn dt translated">可行，但不是完美的解决方案。记录保管者会自然地工作到一个权力的位置，在没有竞争的情况下榨取高额租金。更糟糕的是，如果经济激励发生变化，记录者可能会腐败。谁看着守望者？</p><h1 id="7a74" class="kz la hu bd lb lc ld le lf lg lh li lj ja lk jb ll jd lm je ln jg lo jh lp lq dt translated"><strong class="ak">区块链能为你做什么</strong></h1><p id="a1dc" class="pw-post-body-paragraph kc kd hu kf b kg lr iv ki kj ls iy kl lt lu ko kp lv lw ks kt lx ly kw kx ky hn dt translated">区块链数据存储是分散的、健壮的和不可变的。</p><ul class=""><li id="6922" class="mp mq hu kf b kg kh kj kk lt mr lv ms lx mt ky mu mv mw mx dt translated">分散意味着数据存储在几个不同人的硬件上集体运行。</li><li id="5cfc" class="mp mq hu kf b kg my kj mz lt na lv nb lx nc ky mu mv mw mx dt translated">健壮意味着即使一些参与者离开或停止合作，数据存储也将继续运行。</li><li id="d0e6" class="mp mq hu kf b kg my kj mz lt na lv nb lx nc ky mu mv mw mx dt translated">不可变意味着数据一旦存储在区块链中，就不能被更改。</li></ul><p id="9f1c" class="pw-post-body-paragraph kc kd hu kf b kg kh iv ki kj kk iy kl lt kn ko kp lv kr ks kt lx kv kw kx ky hn dt translated">区块链以优雅的方式解决了文档注册问题。一旦我们在区块链注册中心输入签名，我们就不需要担心签名会被篡改以匹配被篡改的文档。要做到这一点，大多数网络参与者将不得不同意这一改变，这使得它很难保密。</p><p id="d8e0" class="pw-post-body-paragraph kc kd hu kf b kg kh iv ki kj kk iy kl lt kn ko kp lv kr ks kt lx kv kw kx ky hn dt translated">与此同时，没有人有权收取运营服务的租金。网络参与者自己提供服务。</p><p id="e932" class="pw-post-body-paragraph kc kd hu kf b kg kh iv ki kj kk iy kl lt kn ko kp lv kr ks kt lx kv kw kx ky hn dt translated">在这种情况下，文档可以是任何数据集。同样的模式将用于证明任何商业交易、物联网数据集或用户身份等的真实性。</p><blockquote class="ma"><p id="24e2" class="mb mc hu bd md me mf mg mh mi mj ky ek translated">区块链以优雅的方式解决了文档注册问题。一旦我们记录了签名，就不能被篡改。</p></blockquote><p id="df0d" class="pw-post-body-paragraph kc kd hu kf b kg mk iv ki kj ml iy kl lt mm ko kp lv mn ks kt lx mo kw kx ky hn dt translated">如果我在 2016 年写这篇文章，我可以实现大约一百行代码，然后是一份 24 页的白皮书，<a class="ae lz" href="https://vinchain.io/" rel="noopener ugc nofollow" target="_blank">在一个 ICO </a>中筹集几百万美元。这种模式的应用是无止境的，很多人抓住了这个机会。</p><p id="92cf" class="pw-post-body-paragraph kc kd hu kf b kg kh iv ki kj kk iy kl lt kn ko kp lv kr ks kt lx kv kw kx ky hn dt translated">如今，知道如何使用这个构建模块来设计更复杂的解决方案是很有用的。所有区块链解决方案都依赖于存储用户生成的数据，这些数据可以不依赖任何人而被信任。</p><h1 id="d108" class="kz la hu bd lb lc ld le lf lg lh li lj ja lk jb ll jd lm je ln jg lo jh lp lq dt translated"><strong class="ak">实施</strong></h1><p id="924c" class="pw-post-body-paragraph kc kd hu kf b kg lr iv ki kj ls iy kl lt lu ko kp lv lw ks kt lx ly kw kx ky hn dt translated">这一次我没有从头开始编写合同代码。我正试图停止重新发明轮子，区块链注册中心已经实现了打。快速的 google 搜索把我带到了 GitHub repo，我将用它来展示这个模式是如何工作的。即使它使用旧版本的 solidity，它也能很好地工作，你可以测试它。)。</p><p id="961a" class="pw-post-body-paragraph kc kd hu kf b kg kh iv ki kj kk iy kl lt kn ko kp lv kr ks kt lx kv kw kx ky hn dt translated"><a class="ae lz" href="https://github.com/nakov/Ethereum-Web3-Document-Registry-Demo/blob/master/DocumentRegistry.sol" rel="noopener ugc nofollow" target="_blank">契约</a>非常简单，只有一个相关的契约变量和两个函数。</p><ul class=""><li id="84f8" class="mp mq hu kf b kg kh kj kk lt mr lv ms lx mt ky mu mv mw mx dt translated">一个<code class="eh nd ne nf ng b">documents</code>映射将为一个文档计算的散列与它被添加到的块链接起来。</li><li id="c158" class="mp mq hu kf b kg my kj mz lt na lv nb lx nc ky mu mv mw mx dt translated">一个<code class="eh nd ne nf ng b">add</code>方法获取一个散列并将其存储在映射中。</li><li id="6403" class="mp mq hu kf b kg my kj mz lt na lv nb lx nc ky mu mv mw mx dt translated">一个<code class="eh nd ne nf ng b">verifiy</code>方法返回散列的时间戳。</li></ul><pre class="jk jl jm jn fq nh ng ni nj aw nk dt"><span id="4d62" class="nl la hu ng b fv nm nn l no np">pragma solidity ^0.4.18;</span><span id="cc44" class="nl la hu ng b fv nq nn l no np">contract DocumentRegistry {<br/>  mapping (string =&gt; uint256) documents;<br/>  address contractOwner = msg.sender;</span><span id="e354" class="nl la hu ng b fv nq nn l no np">  function add(string hash) <br/>    public <br/>    returns (uint256 dateAdded) <br/>  {<br/>    require (msg.sender == contractOwner);<br/>    var timeAdded = block.timestamp;<br/>    documents[hash] = timeAdded;<br/>    return timeAdded;<br/>  }</span><span id="1cc7" class="nl la hu ng b fv nq nn l no np">  function verify(string hash) <br/>    constant <br/>    public <br/>    returns (uint256 dateAdded) <br/>  {<br/>    return documents[hash];<br/>  }<br/>}</span></pre><p id="db12" class="pw-post-body-paragraph kc kd hu kf b kg kh iv ki kj kk iy kl lt kn ko kp lv kr ks kt lx kv kw kx ky hn dt translated">前端允许您用<code class="eh nd ne nf ng b">contract.add</code>上传文件，并计算一个签名作为文件内容的 sha256。</p><pre class="jk jl jm jn fq nh ng ni nj aw nk dt"><span id="3e56" class="nl la hu ng b fv nm nn l no np">async function uploadDocument() {<br/>  …<br/>  let fileReader = new FileReader();<br/>  fileReader.onload = function() {<br/>    let documentHash = sha256(fileReader.result);<br/>    …<br/>    contract.add(documentHash, function(err, result) {…});<br/>    …<br/>  }<br/>}</span></pre><p id="0598" class="pw-post-body-paragraph kc kd hu kf b kg kh iv ki kj kk iy kl lt kn ko kp lv kr ks kt lx kv kw kx ky hn dt translated">前端还允许你上传一个带有<code class="eh nd ne nf ng b">contract.verify</code>的文件，如果它是在之前上传的，它会告诉你大概的时间。</p><pre class="jk jl jm jn fq nh ng ni nj aw nk dt"><span id="b07f" class="nl la hu ng b fv nm nn l no np">function verifyDocument() {<br/>  …<br/>  let fileReader = new FileReader();<br/>  fileReader.onload = function() {<br/>    let documentHash = sha256(fileReader.result);<br/>    …<br/>    contract.verify(documentHash, function(err, result) {<br/>    …<br/>    let contractPublishDate = result.toNumber();<br/>    if (contractPublishDate &gt; 0) {<br/>      let displayDate = new Date(<br/>        contractPublishDate * 1000<br/>      ).toLocaleString();<br/>      showInfo(<br/>        `Document ${documentHash} is &lt;b&gt;valid&lt;b&gt;, <br/>        date published: ${displayDate}`<br/>      );<br/>    }<br/>    else<br/>      return showError(<br/>        `Document ${documentHash} is &lt;b&gt;invalid&lt;/b&gt;: <br/>        not found in the registry.`<br/>      );<br/>    });<br/>  }<br/>  …<br/>}</span></pre><p id="0503" class="pw-post-body-paragraph kc kd hu kf b kg kh iv ki kj kk iy kl lt kn ko kp lv kr ks kt lx kv kw kx ky hn dt translated">这就是实现分散式文档注册中心所需的全部内容，它允许做两件事:</p><ol class=""><li id="2834" class="mp mq hu kf b kg kh kj kk lt mr lv ms lx mt ky nr mv mw mx dt translated">签署文件</li><li id="4b86" class="mp mq hu kf b kg my kj mz lt na lv nb lx nc ky nr mv mw mx dt translated">验证文档自上次记录签名后是否已更改。</li></ol><p id="c289" class="pw-post-body-paragraph kc kd hu kf b kg kh iv ki kj kk iy kl lt kn ko kp lv kr ks kt lx kv kw kx ky hn dt translated">这是可行的，因为两个不同的文档具有相同签名的可能性非常接近于零。如果您获得了时间戳，您就可以确定您提供的文档是在那个时候被引入到注册中心的。</p><p id="d588" class="pw-post-body-paragraph kc kd hu kf b kg kh iv ki kj kk iy kl lt kn ko kp lv kr ks kt lx kv kw kx ky hn dt translated">契约代码当然可以更新和改进，但是这 17 行代码中的核心行为仍然是正确的。</p><h1 id="2fe2" class="kz la hu bd lb lc ld le lf lg lh li lj ja lk jb ll jd lm je ln jg lo jh lp lq dt translated"><strong class="ak">结论</strong></h1><p id="5b72" class="pw-post-body-paragraph kc kd hu kf b kg lr iv ki kj ls iy kl lt lu ko kp lv lw ks kt lx ly kw kx ky hn dt translated">文档注册中心是具有商业价值的区块链应用程序的最简单的实现。在 2016 年，这篇文章中的几行代码足以在 ICO 中筹集数百万美元。今天，它们仍然是相关的构建块之一，您可以在更复杂的解决方案中一次又一次地重用它们。</p><p id="c6eb" class="pw-post-body-paragraph kc kd hu kf b kg kh iv ki kj kk iy kl lt kn ko kp lv kr ks kt lx kv kw kx ky hn dt translated">文档注册中心有效地利用了区块链的分散性和不变性来消除信任任何人所提供的数据是真实的需要。这个想法很简单，但却是革命性的。</p><figure class="jk jl jm jn fq jo"><div class="bz el l di"><div class="ns nt l"/></div></figure></div></div>    
</body>
</html>