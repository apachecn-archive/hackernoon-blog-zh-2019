<html>
<head>
<title>Google Cloud Engine + cPanel: Set Hostname (Workaround)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Google 云引擎+ cPanel:设置主机名(解决方法)</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/google-cloud-engine-cpanel-set-hostname-workaround-f7834ec19c06#2019-06-04">https://medium.com/hackernoon/google-cloud-engine-cpanel-set-hostname-workaround-f7834ec19c06#2019-06-04</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/998f36e4025c74065dfccd6363080274.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*FwalBSWfZQvbLGot"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">Photo by <a class="ae jg" href="https://unsplash.com/@dadaben_?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Benjamin Dada</a> on <a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="6fb5" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">我猜你们中的许多人已经在使用基于云的托管解决方案和 WHM (cPanel)设置来为客户提供虚拟主机解决方案，或者为自己的项目托管网站和应用程序。</p><p id="0459" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在许多情况下，我使用 DigitalOcean 来满足我的主机需求，但我在使用 Google Cloud Engine 时注意到了一个奇怪的问题，这是我在使用 DigitalOcean droplets 时没有发现的(后来发现，这也是少数基于云的主机解决方案的常见问题)。也就是说，在命令行上配置的主机名在重新启动后不会保留。</p><h1 id="869a" class="kf kg hu bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">详细的问题。</h1><p id="39d9" class="pw-post-body-paragraph jh ji hu jj b jk ld jm jn jo le jq jr js lf ju jv jw lg jy jz ka lh kc kd ke hn dt translated">大多数云托管提供商在启动时通过调用<em class="li"> dhclient </em>脚本来配置自动部署，但是这会错误地生成服务器的主机名。为了解决这个问题，大多数主机提供商使用额外的脚本作为解决办法，如谷歌云引擎上的<em class="li">谷歌主机名称</em>。这在很多情况下是可以的，但是当 WHM/cPanel 等一些服务正在使用<em class="li"> dhclient </em>脚本来设置机器的主机名<em class="li"> (WHM &gt; Home &gt;网络设置&gt;更改主机名)时，上述问题就会出现。在某些情况下，这可能会导致“无效”cPanel 许可错误。</em></p><h1 id="33b2" class="kf kg hu bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">解决方案编号:一。</h1><p id="901b" class="pw-post-body-paragraph jh ji hu jj b jk ld jm jn jo le jq jr js lf ju jv jw lg jy jz ka lh kc kd ke hn dt translated">如果您正在使用:</p><pre class="lj lk ll lm fq ln lo lp lq aw lr dt"><span id="6a6d" class="ls kg hu lo b fv lt lu l lv lw">sudo hostname hostname.example.com</span></pre><p id="6d83" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">请改用:</p><pre class="lj lk ll lm fq ln lo lp lq aw lr dt"><span id="aadc" class="ls kg hu lo b fv lt lu l lv lw">sudo hostnamectl set-hostname hostname.example.com</span></pre><p id="d8a8" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">在许多情况下，这将解决问题。但是如果那没有帮助，我已经为你找到另一个解决方法。</p><h1 id="e07c" class="kf kg hu bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc dt translated">解决方案编号:二。</h1><p id="84da" class="pw-post-body-paragraph jh ji hu jj b jk ld jm jn jo le jq jr js lf ju jv jw lg jy jz ka lh kc kd ke hn dt translated">如果第一个选项不适合您，您可以设置一个“退出”钩子脚本，它将在引导时正确设置主机名。<strong class="jj hv">记住</strong>用自己的主机名替换<em class="li">hostname.example.com</em>。</p><pre class="lj lk ll lm fq ln lo lp lq aw lr dt"><span id="df4c" class="ls kg hu lo b fv lt lu l lv lw">mkdir -p /etc/dhcp/dhclient-exit-hooks.d/ &amp;&amp; echo -ne '#!/bin/sh\nhostname hostname.example.com\n/scripts/fixetchosts\n' &gt; /etc/dhcp/dhclient-exit-hooks.d/set-hostname.sh &amp;&amp; chmod +x /etc/dhcp/dhclient-exit-hooks.d/set-hostname.sh</span></pre><p id="fb89" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">该脚本将在<em class="li">/etc/DHCP/DHCP client-exit-hooks . d/</em>目录中创建一个名为<em class="li"> set-hostname.sh </em>的脚本，并具有运行所需的权限。</p></div><div class="ab cl lx ly hc lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="hn ho hp hq hr"><p id="fda4" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated"><em class="li">跟我上:中</em> <a class="me mf gr" href="https://medium.com/u/a11268193e26?source=post_page-----f7834ec19c06--------------------------------" rel="noopener" target="_blank"> <em class="li">米奴万·德沙里雅</em> </a> <em class="li">，推特</em><a class="ae jg" href="https://twitter.com/twitminu" rel="noopener ugc nofollow" target="_blank"><em class="li">@ twit minu</em></a><em class="li">或脸书</em><a class="ae jg" href="https://facebook.com/minuwan" rel="noopener ugc nofollow" target="_blank"><em class="li">@米奴万</em> </a> <em class="li">。</em></p></div></div>    
</body>
</html>