<html>
<head>
<title>How to quickly set up a Gatsby.js JAMstack website with a headless CMS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用无头CMS快速搭建一个Gatsby.js JAMstack网站</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/how-to-quickly-set-up-a-gatsby-js-jamstack-website-with-a-headless-cms-4a3b51d67e5e?source=collection_archive---------10-----------------------#2019-02-02">https://medium.com/hackernoon/how-to-quickly-set-up-a-gatsby-js-jamstack-website-with-a-headless-cms-4a3b51d67e5e?source=collection_archive---------10-----------------------#2019-02-02</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><figure class="ht hu fm fo hv hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff hs"><img src="../Images/b590fa51d3580e8e438246093b913c58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tIQjx-RIZ4WSjyCteUMdeA.jpeg"/></div></div></figure><div class=""/><p id="91b5" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">有一个<a class="ae ka" href="https://www.sanity.io/blog/get-started-with-gatsby-and-structured-content" rel="noopener ugc nofollow" target="_blank">新的源代码</a>插件出来了，它使得使用Sanity作为一个用<a class="ae ka" href="https://www.gatsbyjs.org" rel="noopener ugc nofollow" target="_blank"> Gatsby.js </a>构建的JAMstack网站的无头CMS变得很容易。在<a class="ae ka" href="https://hackernoon.com/tagged/gatsby" rel="noopener ugc nofollow" target="_blank"> Gatsby </a>上安装和集成令人兴奋的项目非常容易。如果你是静态站点生成器的新手，或者想测试一下插件，我们制作了一个完整的公司网站和一个无头CMS示例，包括人员、项目、博客和一些信息页面。在本教程中，我们将展示如何设置它，以及如何在web服务器上以<a class="ae ka" href="https://hackernoon.com/tagged/development" rel="noopener ugc nofollow" target="_blank">开发</a>模式运行Gatsby，以获得内容变化的实时在线预览。</p><figure class="kb kc kd ke fq hw"><div class="bz el l di"><div class="kf kg l"/></div></figure><p id="92bf" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这个例子是一个monorepo，包含了Sanity Studio的配置，您将在这里编辑内容，以及Gatsby构建的网站。它还被配置为直接部署到<a class="ae ka" href="https://netlify.com/" rel="noopener ugc nofollow" target="_blank">网络上</a>或<a class="ae ka" href="https://zeit.co/now" rel="noopener ugc nofollow" target="_blank">现在是</a>。您可以在其中创建一个新的免费的Sanity项目，并在几分钟内启动和运行。JAMstack时代的Web开发真是太棒了！</p><p id="2149" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们感到安全，你可以采取我们公司的网站的例子，并使它成为你自己的。</p><h1 id="d31e" class="kh ki if bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le dt translated">在Github上克隆或派生存储库</h1><p id="7000" class="pw-post-body-paragraph jc jd if je b jf lf jh ji jj lg jl jm jn lh jp jq jr li jt ju jv lj jx jy jz hn dt translated">转到GitHub 上的<a class="ae ka" href="https://github.com/sanity-io/example-company-website-gatsby-sanity-combo" rel="noopener ugc nofollow" target="_blank">示例库并克隆，或者从那里派生。您也可以在您的终端中保存web项目的文件夹中运行此程序(如果您分叉了项目，请用您自己的URL替换):</a></p><pre class="kb kc kd ke fq lk ll lm ln aw lo dt"><span id="c27f" class="lp ki if ll b fv lq lr l ls lt">git clone <a class="ae ka" href="https://github.com/sanity-io/example-company-website-gatsby-sanity-combo.git" rel="noopener ugc nofollow" target="_blank">https://github.com/sanity-io/example-company-website-gatsby-sanity-combo.git</a><br/>cd example-company-website-gatsby-sanity-combo</span></pre><h1 id="4dbb" class="kh ki if bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le dt translated">安装Sanity CLI</h1><p id="0e5f" class="pw-post-body-paragraph jc jd if je b jf lf jh ji jj lg jl jm jn lh jp jq jr li jt ju jv lj jx jy jz hn dt translated">在处理这样的项目时，使用Sanity CLI非常方便，安装时间也不长。在命令行中运行以下npm命令:</p><pre class="kb kc kd ke fq lk ll lm ln aw lo dt"><span id="822d" class="lp ki if ll b fv lq lr l ls lt">npm install --global @sanity/cli</span></pre><h1 id="f475" class="kh ki if bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le dt translated">安装依赖项</h1><p id="936f" class="pw-post-body-paragraph jc jd if je b jf lf jh ji jj lg jl jm jn lh jp jq jr li jt ju jv lj jx jy jz hn dt translated">这个例子使用<a class="ae ka" href="https://npmjs.com/" rel="noopener ugc nofollow" target="_blank">节点包管理器</a> ( <code class="eh lu lv lw ll b">npm</code>)进行依赖，如果您喜欢，您也可以使用yarn:</p><pre class="kb kc kd ke fq lk ll lm ln aw lo dt"><span id="77cc" class="lp ki if ll b fv lq lr l ls lt">~/example-company-website-gatsby-sanity-combo <br/>npm install</span></pre><h1 id="2a54" class="kh ki if bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le dt translated">将Sanity.io设置为无头CMS</h1><pre class="kb kc kd ke fq lk ll lm ln aw lo dt"><span id="e2c8" class="lp ki if ll b fv lq lr l ls lt">~/example-company-website-gatsby-sanity-combo <br/>npm run init</span></pre><p id="bb20" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">安装脚本完成后运行此命令。按照CLI的说明为网站创建一个Sanity.io项目。我们建议将数据集设置为<strong class="je ig"> public </strong>(如果您愿意，可以稍后将其更改为private)。数据集是你存储所有内容的地方，有点像数据库。您可以拥有多个数据集。例如，如果您想要一个用于开发的内容测试平台。</p><p id="bfbd" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><code class="eh lu lv lw ll b">npm run init</code>命令还为您的Sanity项目部署了一个GraphQL API(Sanity同时支持<a class="ae ka" href="https://www.sanity.io/docs/reference/groq" rel="noopener ugc nofollow" target="_blank"> GROQ </a>和graph QL)。Gatsby source plugin for Sanity使用GraphQL模式定义来防止Gatsby的模板API中缺少类型和字段。据我们所知，这是唯一能帮你做到这一点的插件——它非常实用！</p><h1 id="70ea" class="kh ki if bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le dt translated">启动本地开发服务器</h1><p id="2074" class="pw-post-body-paragraph jc jd if je b jf lf jh ji jj lg jl jm jn lh jp jq jr li jt ju jv lj jx jy jz hn dt translated">在你的项目文件夹中，你有两个文件夹:<code class="eh lu lv lw ll b">studio</code>和<code class="eh lu lv lw ll b">web</code>。</p><p id="9b41" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">studio文件夹是您可以找到Sanity Studio的配置文件的地方，这是一个针对您的内容的开源编辑器，使用JavaScript和React构建。它连接到托管的API，并且是实时的，就像你在谷歌文档中一样。你可以在任何可以托管HTML文件的地方托管这个工作室。在<code class="eh lu lv lw ll b">studio/schema</code>文件夹中，您会找到所有类型和字段的配置文件。如果你想的话，你可以在以后调整和改变这些，但是我们现在就让它们保持原样。</p><p id="18d6" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><code class="eh lu lv lw ll b">web</code>文件夹中有一个Gatsby网站，里面有你需要的所有东西，可以让内容得到合理的管理。如果你是盖茨比的新手，我们推荐他们的<a class="ae ka" href="https://www.gatsbyjs.org/docs/" rel="noopener ugc nofollow" target="_blank">综合文档</a>来学习基本思想。</p><p id="a8e2" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">您可以用一个命令启动Studio和Gatsby前端的开发服务器:</p><pre class="kb kc kd ke fq lk ll lm ln aw lo dt"><span id="162e" class="lp ki if ll b fv lq lr l ls lt">~/example-company-website-gatsby-sanity-combo <br/>npm start</span></pre><p id="876c" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">工作室运行于<a class="ae ka" href="http://localhost:3333/" rel="noopener ugc nofollow" target="_blank"> localhost:3333 </a>，网站运行于<a class="ae ka" href="http://locahost:8000/" rel="noopener ugc nofollow" target="_blank"> localhost:8000 </a>。如果你打开网站，你会看到一条错误信息。那是因为它需要一些内容来构建。所以从打开工作室，登录开始。</p><figure class="kb kc kd ke fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff lx"><img src="../Images/5551881c15c16231e030e5110aaf0a5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*iFFVwTNoP5xN0rg8"/></div></div></figure><p id="cbcd" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">进入<a class="ae ka" href="http://localhost:3333/desk/siteSettings" rel="noopener ugc nofollow" target="_blank">站点设置</a>和<a class="ae ka" href="http://localhost:3333/desk/companyInfo" rel="noopener ugc nofollow" target="_blank">公司设置</a>，至少填写名称。写一篇博文(只是一些模仿的内容就可以了)，一个项目，还有一些其他的东西。你应该给你的博客和项目条目都起一个<strong class="je ig">标题</strong>，一个<strong class="je ig">标题</strong>，最好是在日期(过去)发表的<strong class="je ig">。记得发布更改(左下方的蓝色按钮)。尽管所有的更改都会立即与托管的后端同步，但它们不会在没有发布的情况下出现在公共API中。</strong></p><p id="2f4e" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在您可能需要重启开发服务器，让Gatsby使用新的更改进行构建。<code class="eh lu lv lw ll b">ctrl + C</code>将退出当前进程，而<code class="eh lu lv lw ll b">npm start</code>将再次启动它。</p><h1 id="6bfb" class="kh ki if bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le dt translated">尝试盖茨比的手表模式</h1><p id="e8f7" class="pw-post-body-paragraph jc jd if je b jf lf jh ji jj lg jl jm jn lh jp jq jr li jt ju jv lj jx jy jz hn dt translated">如果您查看名为<code class="eh lu lv lw ll b">gatsby-config.js</code>的文件，您会在插件部分看到以下条目:</p><pre class="kb kc kd ke fq lk ll lm ln aw lo dt"><span id="46c2" class="lp ki if ll b fv lq lr l ls lt">{<br/>  resolve: 'gatsby-source-sanity',<br/>  options: {<br/>    projectId,<br/>    dataset,<br/>    <em class="ly">// To enable preview of drafts, copy .env-example into .env,</em><br/>    <em class="ly">// and add a token with read permissions</em><br/>    token: process.env.SANITY_TOKEN,<br/>    watchMode: true,<br/>    <!-- -->overlayDrafts<!-- -->: true<br/>  }<br/>}</span></pre><p id="8948" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们已经启用了<code class="eh lu lv lw ll b">watchMode</code>，这意味着Gatsby可以动态地注入内容变更，而无需您重新加载开发服务器或刷新浏览器。很少有其他源代码插件能做到这一点。更酷的是，其他人可以坐在同一个工作室，编辑内容，这也立即反映在前端开发服务器上。默认情况下，该插件只能访问已发布的修改，但尝试编辑一些东西(可能会在第一篇博文中添加一张图片)，按下<strong class="je ig">发布</strong>，看看它是否会在前端更新。</p><figure class="kb kc kd ke fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff lz"><img src="../Images/c9367a595b495e2995d6730d2275e578.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*emURqIvmMcjGKnzS"/></div></div></figure><h1 id="9ce5" class="kh ki if bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le dt translated">添加令牌以查看所有更改</h1><p id="8461" class="pw-post-body-paragraph jc jd if je b jf lf jh ji jj lg jl jm jn lh jp jq jr li jt ju jv lj jx jy jz hn dt translated">在插件中，你可能注意到了<code class="eh lu lv lw ll b">token: process.env.SANITY_TOKEN</code>和<code class="eh lu lv lw ll b">overlayDrafts: true</code>。有了读特权，你就可以让盖茨比访问未发表的文件，比如草稿。当<code class="eh lu lv lw ll b">overlayDrafts</code>设置为<code class="eh lu lv lw ll b">true</code>时，Gatsby将使用文档的草稿版本，如果它可以访问它的话。您需要在web文件夹中的一个名为<code class="eh lu lv lw ll b">.env</code>的文件中保存一个读取令牌来启用此功能:</p><pre class="kb kc kd ke fq lk ll lm ln aw lo dt"><span id="3ea0" class="lp ki if ll b fv lq lr l ls lt">~/example-company-website-gatsby-sanity-combo/web <br/>cp .env-example .env</span></pre><p id="99c0" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在可以去<a class="ae ka" href="https://manage.sanity.io/projects/" rel="noopener ugc nofollow" target="_blank">https://manage.sanity.io/projects/&lt;YourProjectId&gt;/设置/api </a>(管理- &gt;设置- &gt; API)，然后<strong class="je ig">添加新令牌</strong>。给它一个漂亮的描述性标签，并且只有读取权限。复制它，并将其粘贴到。环境文件:</p><pre class="kb kc kd ke fq lk ll lm ln aw lo dt"><span id="cdc2" class="lp ki if ll b fv lq lr l ls lt">~/example-company-website-gatsby-sanity-combo/web/.env<br/>SANITY_TOKEN="YourToken"</span></pre><p id="588c" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">要将令牌加载到Gatsby中，您需要再次重启本地开发服务器。不过，这是值得的。</p><figure class="kb kc kd ke fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff lz"><img src="../Images/38ec40ece2760ddde18b9f12d268eb40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*E7kvRh3Wtd8pFZHu"/></div></div></figure><h1 id="b364" class="kh ki if bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le dt translated">用Netlify在网上建立你的盖茨比网站</h1><p id="e4ab" class="pw-post-body-paragraph jc jd if je b jf lf jh ji jj lg jl jm jn lh jp jq jr li jt ju jv lj jx jy jz hn dt translated">也许你想调整前端一点，改变CSS，或者做一些调整。在某些时候，你想与世界分享它。我们建议您将项目放在GitHub上。如果你分叉了，提交并推动你的改变。如果你是从我们这里克隆的，<a class="ae ka" href="https://kbroman.org/github_tutorial/pages/init.html" rel="noopener ugc nofollow" target="_blank">遵循这些关于如何在GitHub上获得本地git repo的说明</a>。</p><p id="756a" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">当它在GitHub上时，去Netlify注册或登录。如果您从Git中选择<strong class="je ig"> New site </strong>并找到您刚刚更新的存储库，那么由于项目中的<code class="eh lu lv lw ll b">netlify.toml</code>文件，一切都已经设置好并准备好了。同样，如果您更喜欢现在的<a class="ae ka" href="https://zeit.co/now" rel="noopener ugc nofollow" target="_blank">Zeit</a>(或者想要使用两者以获得最终的冗余)，您可以在项目的根文件夹中运行<code class="eh lu lv lw ll b">npm run now-deploy</code>。</p><figure class="kb kc kd ke fq hw fe ff paragraph-image"><div role="button" tabindex="0" class="hx hy di hz bf ia"><div class="fe ff lx"><img src="../Images/e4021f15e78385805e8b8c7e7133bbdd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*v7jHTmyMvA5xFM-A"/></div></div></figure><p id="bf16" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">要快速部署Sanity studio，运行<code class="eh lu lv lw ll b">studio</code>文件夹中的<code class="eh lu lv lw ll b">sanity deploy</code>并选择一个主机名。现在你可以在永久免费开发者计划中免费邀请另外两个用户。如果你需要更多，在同一个计划中，现收现付的每位用户需要10美元。Gatsby只用了2个API请求就构建了整个网站。一个用于所有内容，一个用于模式。因此，你将获得很大的里程数<a class="ae ka" href="https://www.sanity.io/pricing/dev-2018-08-21" rel="noopener ugc nofollow" target="_blank">与我们的免费计划</a>与盖茨比网站。我们挖它！</p><h1 id="0d08" class="kh ki if bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le dt translated">根据内容变化触发新的网络构建</h1><p id="7d0f" class="pw-post-body-paragraph jc jd if je b jf lf jh ji jj lg jl jm jn lh jp jq jr li jt ju jv lj jx jy jz hn dt translated">当您将提交推送到它监视的分支时，Netlify会触发新的构建。然而，内容并没有提交给Git。幸运的是，还有其他触发构建的方法，其中之一就是使用webhooks。</p><p id="0ecf" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">如果你在Netlify上托管你的站点，你可以进入<strong class="je ig">设置</strong>-&gt;-T14】构建&amp;部署并向下滚动到<strong class="je ig">构建钩子</strong>。选择<strong class="je ig"> Add build hook </strong>，给它一个名字，指向你想要构建的分支。复制URL，并返回到终端:</p><pre class="kb kc kd ke fq lk ll lm ln aw lo dt"><span id="9159" class="lp ki if ll b fv lq lr l ls lt">~/example-company-website-gatsby-sanity-combo<br/>cd studio<br/>sanity hook create<br/>? Hook name: netlify<br/>? Select dataset hook should apply to: &lt;yourDataset&gt;<br/>? Hook URL: https://api.netlify.com/build_hooks/&lt;someId&gt;</span></pre><p id="0960" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在，每当您发布一些新的内容编辑时，Netlify都会触发一个新的站点部署。</p><h1 id="32f9" class="kh ki if bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le dt translated">奖励:Heroku上的在线内容预览</h1><p id="b4e9" class="pw-post-body-paragraph jc jd if je b jf lf jh ji jj lg jl jm jn lh jp jq jr li jt ju jv lj jx jy jz hn dt translated">安德烈亚斯·凯勒写的这本有帮助的教程出现在我们的订阅源中。他想出了一个在Heroku上的开发服务器上运行Gatsby的方法，从而使在网上获得实时预览体验的观看模式成为可能。如果您的编辑器不能在终端中运行本地开发服务器，这是很好的。让我们用Sanity source插件来设置它，以获得无与伦比的预览体验！</p><h1 id="3fcb" class="kh ki if bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le dt translated">安装Heroku CLI</h1><p id="40e6" class="pw-post-body-paragraph jc jd if je b jf lf jh ji jj lg jl jm jn lh jp jq jr li jt ju jv lj jx jy jz hn dt translated">按照这些说明<a class="ae ka" href="https://devcenter.heroku.com/articles/getting-started-with-nodejs#set-up" rel="noopener ugc nofollow" target="_blank">安装Heroku CLI。运行<code class="eh lu lv lw ll b">heroku login</code>并登录或注册。</a></p><h1 id="2550" class="kh ki if bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le dt translated">调整gatsby-config.js</h1><p id="be29" class="pw-post-body-paragraph jc jd if je b jf lf jh ji jj lg jl jm jn lh jp jq jr li jt ju jv lj jx jy jz hn dt translated">为了让Heroku能够很好地使用monorepo(它喜欢在根文件夹中使用它的应用程序)，我们必须在根文件夹中安装gatsby-cli作为开发依赖项:</p><pre class="kb kc kd ke fq lk ll lm ln aw lo dt"><span id="ecaa" class="lp ki if ll b fv lq lr l ls lt">~/example-company-website-gatsby-sanity-combo<br/>npm install gatsby-cli --only=dev</span></pre><p id="5dc6" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">也有其他的<a class="ae ka" href="https://github.com/timanovsky/subdir-heroku-buildpack" rel="noopener ugc nofollow" target="_blank">方法，在</a>中，你推<code class="eh lu lv lw ll b">web</code>文件夹，但是然后你必须在<code class="eh lu lv lw ll b">gatsby-config.js</code>中手动放入<code class="eh lu lv lw ll b">projectId</code>和<code class="eh lu lv lw ll b">dataset</code>，因为这些变量是从<code class="eh lu lv lw ll b">studio</code>文件夹中的<code class="eh lu lv lw ll b">sanity.json</code>导入的。</p><p id="3d5b" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">设置完成后，您应该执行以下操作:</p><pre class="kb kc kd ke fq lk ll lm ln aw lo dt"><span id="43e4" class="lp ki if ll b fv lq lr l ls lt">~/example-company-website-gatsby-sanity-combo<br/># create a new heroku app<br/>heroku create<br/><br/># set node to run in development mode<br/>heroku config:set NODE_ENV=development<br/>heroku config:set NPM_CONFIG_PRODUCTION=false<br/><br/># set the project id and dataset, found in sanity.json<br/>heroku config:set PROJECT_ID=YourProjectId<br/>heroku config:set DATASET=YourDatasetName<br/><br/># add the read token to Heroku’s environment<br/># make sure that the token isn't wrapped in quotation marks<br/>heroku config:set SANITY_TOKEN=$(cat web/.env|grep SANITY_TOKEN)<br/><br/># add the app configuration to run gatsby on heroku’s dyno<br/>echo "web: cd web &amp;&amp; gatsby develop -p $PORT -H 0.0.0.0" &gt; Procfile<br/><br/># add the changes to git<br/>git add Procfile package.json package-lock.json<br/>git commit -m"Add Procfile and deps for Heroku"<br/><br/># push it to heroku<br/>git push heroku master<br/><br/># open the app in the browser<br/>heroku open<br/><br/># check the logs to troubleshoot if things doesn't work<br/>heroku logs --tail</span></pre><p id="b417" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这个应用程序运行在一个免费的dyno上，在一段时间不活动后会休眠，它可能需要几分钟才能再次启动。你当然可以在付费的dyno上运行它，这给了你完整的正常运行时间。我们不能保证它会非常稳定，因为开发服务器并不是为实际托管web上的网站而构建的。如果崩溃了，可以用<code class="eh lu lv lw ll b">heroku restart</code>重启。</p><p id="b492" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">尽管如此，它还是很酷，而且当你想给你的网页编辑一种方法来立即预览他们的改变，而不必等待重建时，它无疑是有用的。</p></div><div class="ab cl ma mb hc mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="hn ho hp hq hr"><p id="aac7" class="pw-post-body-paragraph jc jd if je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated"><em class="ly">最初发布于</em><a class="ae ka" href="https://www.sanity.io/blog/how-to-quickly-set-up-a-gatsby-js-jamstack-website-with-a-headless-cms" rel="noopener ugc nofollow" target="_blank"><em class="ly">www . sanity . io</em></a><em class="ly">。</em></p><figure class="kb kc kd ke fq hw"><div class="bz el l di"><div class="mh kg l"/></div></figure></div></div>    
</body>
</html>