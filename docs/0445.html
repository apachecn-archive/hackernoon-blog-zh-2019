<html>
<head>
<title>What I learned when trying to improve an AI agent in a game using deep learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">当我试图使用深度学习来改善游戏中的人工智能代理时，我学到了什么</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/what-i-learned-when-trying-to-improve-an-ai-agent-in-a-game-using-deep-learning-2727850fc378#2019-01-17">https://medium.com/hackernoon/what-i-learned-when-trying-to-improve-an-ai-agent-in-a-game-using-deep-learning-2727850fc378#2019-01-17</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="6e24" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">2018 年末我参加了 kaggle 的<strong class="it hv">“快，画！涂鸦识别挑战”。</strong>对于那些不知道的人，下面是这个游戏的简短描述:</p><p id="adcd" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><a class="ae jp" href="https://quickdraw.withgoogle.com/" rel="noopener ugc nofollow" target="_blank"> <em class="jq">“快，画！”</em> </a> <em class="jq">作为一款实验游戏发布，以一种好玩的方式教育公众人工智能是如何工作的。该游戏提示用户绘制描述某一类别的图像，例如“香蕉”、“桌子”等。</em></p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="fe ff jr"><img src="../Images/9f16f2d1f86a71ca5fe9c566c13ab4f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ha5GdpPPDfZYwXqPx2jl_A.png"/></div></div></figure><p id="4360" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">作为比赛的一部分，超过 340 幅 1B 作品的子集被发布。竞争者需要改进现有的人工智能<a class="ae jp" href="https://hackernoon.com/tagged/algorithm" rel="noopener ugc nofollow" target="_blank">算法</a>，该算法可以区分用户是否能够正确地画出所要求的内容。对于每张测试图片，需要预测涂鸦最可能属于的三个类别。</p><pre class="js jt ju jv fq kd ke kf kg aw kh dt"><span id="b9d0" class="ki kj hu ke b fv kk kl l km kn">key_id,word<br/>9000003627287624,The_Eiffel_Tower airplane donut<br/>9000010688666847,The_Eiffel_Tower airplane donut</span></pre><p id="60b3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">最佳算法是基于其平均精度@ 3 (MAP@3)选择的。</p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div class="fe ff ko"><img src="../Images/9e1720034c9f7023200c73157d5bf8b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:470/format:webp/1*I85rP6mrAKPkcJjD7w50jg.png"/></div></figure><p id="32a2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">其中,<code class="eh kp kq kr ke b">U</code>是测试数据中被评分的绘图的数量，<code class="eh kp kq kr ke b">P(k)</code>是截止时的精度<code class="eh kp kq kr ke b">k</code>,而<code class="eh kp kq kr ke b">n</code>是每个绘图的预测数量。</p><h1 id="e08a" class="ks kj hu bd kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo dt translated"><strong class="ak">初步深入研究数据</strong></h1><p id="f152" class="pw-post-body-paragraph ir is hu it b iu lp iw ix iy lq ja jb jc lr je jf jg ls ji jj jk lt jm jn jo hn dt translated">这些画被捕捉为带有时间戳的向量，并标有元数据，包括玩家被要求画的内容以及玩家所在的国家。340 个职业中的每一个都有下面格式的 CSV 文件，定义了相应的玩家是如何绘制涂鸦的。</p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="fe ff lu"><img src="../Images/f6c21a57c4b9cf242f451c9cbab48cf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ngUNgWapNHSbvg4JFdCwbA.png"/></div></div><figcaption class="lv lw fg fe ff lx ly bd b be z ek">A sample for doodles with apple as class</figcaption></figure><p id="d5fd" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">使用下面的代码，我们可以将上述文件的绘图列中的每一个笔画转换成相应的图像。</p><pre class="js jt ju jv fq kd ke kf kg aw kh dt"><span id="87b4" class="ki kj hu ke b fv kk kl l km kn">BASE_SIZE = 256<br/><strong class="ke hv">def</strong> draw_cv2(raw_strokes, size=299, lw=4, time_color=<strong class="ke hv">False</strong>):<br/>    img = np.zeros((BASE_SIZE, BASE_SIZE), np.uint8)<br/>    <strong class="ke hv">for</strong> t, stroke <strong class="ke hv">in</strong> enumerate(raw_strokes):<br/>        <strong class="ke hv">for</strong> i <strong class="ke hv">in</strong> range(len(stroke[0]) - 1):<br/>            color = 255 - min(t, 10) * 13 <strong class="ke hv">if</strong> time_color <strong class="ke hv">else</strong> 255<br/>            _ = cv2.line(img, (stroke[0][i], stroke[1][i]),<br/>                         (stroke[0][i + 1], stroke[1][i + 1]), color, lw)<br/>    img = cv2.copyMakeBorder(img,4,4,4,4,cv2.BORDER_CONSTANT)<br/>    <strong class="ke hv">if</strong> size != BASE_SIZE:<br/>        <strong class="ke hv">return</strong> cv2.resize(img, (size, size), interpolation=cv2.INTER_LINEAR)<br/>    <strong class="ke hv">else</strong>:<br/>        <strong class="ke hv">return</strong> img</span></pre><p id="33be" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">例如，这是雪人文件中的一个:</p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div class="fe ff lz"><img src="../Images/5114904ab44b810903a865813241612d.png" data-original-src="https://miro.medium.com/v2/resize:fit:658/format:webp/1*ZUpVgFoHlWubOBKlDsmX5Q.png"/></div><figcaption class="lv lw fg fe ff lx ly bd b be z ek">snowman</figcaption></figure><p id="cbeb" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们将所有的笔画转换成相应的图像，并存储在相应的文件夹中(train &amp; test)。</p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div class="fe ff ma"><img src="../Images/e0a6e4616d95329fdfd33cb04f1e3a90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1090/format:webp/1*Qr-8s-vhiRipJ2P5Nm98dQ.png"/></div><figcaption class="lv lw fg fe ff lx ly bd b be z ek">A batch of images in training data</figcaption></figure><h1 id="6fe7" class="ks kj hu bd kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo dt translated">使用卷积神经网络来识别涂鸦</h1><p id="d3d1" class="pw-post-body-paragraph ir is hu it b iu lp iw ix iy lq ja jb jc lr je jf jg ls ji jj jk lt jm jn jo hn dt translated">理想情况下，有多种方法可以解决这个问题，例如，由于笔画是坐标序列，因此有一个顺序组件，也可以使用递归神经网络。我更喜欢把它作为一个计算机视觉问题来处理，因为通过可视化图像问题的结果来测试和学习比我们正在研究的顺序问题更容易。</p><p id="9f1c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们选择的架构是 Resnets 及其变体(<a class="ae jp" href="https://arxiv.org/abs/1512.03385" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/abs/1512.03385</a>)。我们从 Resnet18 开始，逐步测试问题的性能，甚至跨更大的架构。根据经验，我观察到 Resnet34 比其他任何网络给我们带来了更多的好处。</p><h1 id="a72f" class="ks kj hu bd kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo dt translated"><strong class="ak">我从最初的数据实验中学到了什么</strong></h1><p id="f9e7" class="pw-post-body-paragraph ir is hu it b iu lp iw ix iy lq ja jb jc lr je jf jg ls ji jj jk lt jm jn jo hn dt translated">对数据和后续运行的观察表明，这个问题需要一个简化的网络，它可以放大这些大量的涂鸦。当时需要的是一个能够在有限时间内运行多个时代的简化网络。因此，我甚至没有尝试任何复杂的架构，这最终是一个伟大的决定。</p><p id="9abc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">使用 Resnet34，我可以在 30%的数据量上运行我的实验，它确实表明当你有一个简单但非常多样化(更多标签)的数据集时，<strong class="it hv"> <em class="jq">更多的数据确实有助于泛化能力。</em> </strong></p><h1 id="0867" class="ks kj hu bd kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo dt translated">数据中的噪声</h1><p id="1ee8" class="pw-post-body-paragraph ir is hu it b iu lp iw ix iy lq ja jb jc lr je jf jg ls ji jj jk lt jm jn jo hn dt translated">在进一步的观察中，观察到在训练数据中有许多噪声，即有许多涂鸦被错误地标记。这实际上影响了模型的<a class="ae jp" href="https://hackernoon.com/tagged/learning" rel="noopener ugc nofollow" target="_blank">学习</a>能力，因为你天生就给了它错误的指令。对此，我无法尝试的可能解决方案是开发另一个网络来识别错误标记的图像或手动标记的高损失图像(实际和预测之间差异最大的图像)。</p><h1 id="670c" class="ks kj hu bd kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo dt translated"><strong class="ak">我在哪里着陆</strong></h1><p id="d4aa" class="pw-post-body-paragraph ir is hu it b iu lp iw ix iy lq ja jb jc lr je jf jg ls ji jj jk lt jm jn jo hn dt translated">我得到的最高地图@3 在公共排行榜上是 0.91444，在私人排行榜上是 0.91318。考虑到比赛的获胜者是 0.95480，我是在正确的道路上。如果我花更多的时间改善数据中的噪音，一个可能会有所不同的策略是，但这是下一次的学习。</p><h2 id="6ba1" class="ki kj hu bd kt mb mc md kx me mf mg lb jc mh mi lf jg mj mk lj jk ml mm ln mn dt translated">感谢大家阅读我解决这个非常有趣的问题的经验！对于任何想尝试的人来说，下面是比赛的链接。</h2><div class="mo mp fm fo mq mr"><a href="https://www.kaggle.com/c/quickdraw-doodle-recognition" rel="noopener  ugc nofollow" target="_blank"><div class="ms ab ej"><div class="mt ab mu cl cj mv"><h2 class="bd hv fv z el mw eo ep mx er et ht dt translated">快，画！涂鸦识别挑战</h2><div class="my l"><h3 class="bd b fv z el mw eo ep mx er et ek translated">你能多准确地识别涂鸦？</h3></div><div class="mz l"><p class="bd b gc z el mw eo ep mx er et ek translated">www.kaggle.com</p></div></div><div class="na l"><div class="nb l nc nd ne na nf kb mr"/></div></div></a></div><figure class="js jt ju jv fq jw"><div class="bz el l di"><div class="ng nh l"/></div></figure></div></div>    
</body>
</html>