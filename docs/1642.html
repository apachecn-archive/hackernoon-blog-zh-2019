<html>
<head>
<title>Linear Programming in Python: A Straight Forward Tutorial</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的线性编程:简明教程</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/linear-programming-in-python-a-straight-forward-tutorial-a0d152618121?source=collection_archive---------1-----------------------#2019-03-10">https://medium.com/hackernoon/linear-programming-in-python-a-straight-forward-tutorial-a0d152618121?source=collection_archive---------1-----------------------#2019-03-10</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/729846c5b8365eb6e2d91f760ececc67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vGRp32oF9PkPpNBI"/></div></div></figure><p id="7f13" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">线性规划是最常见的优化技术之一。它的应用范围很广，经常被用于运筹学、工业设计、规划等等。唉，它不像机器学习那样被大肆宣传(这当然是优化本身的一种形式)，但它是可以通过具有线性关系的决策变量来制定的问题的首选方法。这是一个快速实用的教程，我可能会在后面的帖子中介绍单纯形算法和理论。</p><h1 id="7a02" class="ka kb hu bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated"><strong class="ak">问题陈述</strong></h1><p id="9f4b" class="pw-post-body-paragraph jc jd hu je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hn dt translated">为了得到一个概念，我们将解决一个关于生产调度的简单问题。假设你在一家制造电脑的公司工作。电脑是一种相当复杂的产品，有几家工厂组装电脑，公司按每台电脑支付一定的费用。市场上这种电脑型号的成本固定在500美元，不同的工厂组装电脑的速度和成本不同。工厂<strong class="je hv"> f0 </strong>以每单位450美元每天生产2000辆，工厂<strong class="je hv"> f1 </strong>以每单位420美元每天生产1500辆，<strong class="je hv"> f2 </strong>以每单位400美元每天生产1000辆。我们有一个月的时间来装配80 000件产品，但条件是任何工厂的产量都不能超过其他工厂的两倍。问题是，<strong class="je hv">工厂</strong>之间的最优产量分配是什么，使得我们<strong class="je hv">在这些约束条件下最大化</strong> <strong class="je hv">销售计算机所获得的利润</strong>？</p><p id="88e6" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在本教程中，我们将使用Python和线性编程优化包<a class="ae ld" href="https://pythonhosted.org/PuLP/" rel="noopener ugc nofollow" target="_blank"> PuLP </a>，使用pip复制粘贴安装:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="f19e" class="ln kb hu lj b fv lo lp l lq lr">pip install pulp</span></pre><p id="b768" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">现在，为了用线性规划解决计算机生产问题，我们需要以下东西:</p><ol class=""><li id="2e96" class="ls lt hu je b jf jg jj jk jn lu jr lv jv lw jz lx ly lz ma dt translated">决策变量集</li><li id="94d4" class="ls lt hu je b jf mb jj mc jn md jr me jv mf jz lx ly lz ma dt translated">这些变量的线性约束集</li><li id="b2ee" class="ls lt hu je b jf mb jj mc jn md jr me jv mf jz lx ly lz ma dt translated">最大化或最小化的线性目标函数</li></ol><p id="62d3" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">所以，打开你最喜欢的编辑器，让我们开始吧。在定义PuLP中的变量之前，我们需要用下面的代码创建一个问题对象:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="dcb4" class="ln kb hu lj b fv lo lp l lq lr">from pulp import *<br/>problem = LpProblem("problemName", LpMaximize)</span></pre><p id="d817" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">我们将为这个对象添加约束和目标函数。请注意，问题构造函数收到一个问题名称和<strong class="je hv"> LpMaximize </strong>，这意味着我们希望最大化我们的目标函数。在我们的例子中，这是销售一定数量的计算机的利润。此外，我们还定义了从问题陈述中收到的常数:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="1712" class="ln kb hu lj b fv lo lp l lq lr"># factory cost per day<br/>cf0 = 450<br/>cf1 = 420<br/>cf2 = 400</span><span id="3c71" class="ln kb hu lj b fv mg lp l lq lr"># factory throughput per day<br/>f0 = 2000<br/>f1 = 1500<br/>f2 = 1000</span><span id="3a9f" class="ln kb hu lj b fv mg lp l lq lr"># production goal<br/>goal = 80000</span><span id="12a3" class="ln kb hu lj b fv mg lp l lq lr"># time limit<br/>max_num_days = 30</span><span id="48ed" class="ln kb hu lj b fv mg lp l lq lr">num_factories = 3</span></pre><p id="c6b3" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在下一节中，我们将定义决策变量。</p><h1 id="413d" class="ka kb hu bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">决策变量</h1><p id="b639" class="pw-post-body-paragraph jc jd hu je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hn dt translated">在PuLP中，决策变量的定义如下:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="7816" class="ln kb hu lj b fv lo lp l lq lr">variable = LpVariable("variableName")</span></pre><p id="9d2f" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">有时我们需要为变量提供界限(默认情况下是没有界限)，在这种情况下，我们将编写以下代码:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="a84b" class="ln kb hu lj b fv lo lp l lq lr">var = LpVariable("boundedVariableName",lowerBound,upperBound)</span></pre><p id="cb3e" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">还有一种定义纸浆变量的有用方法是使用dicts函数。这在我们需要定义大量相同类型和范围的变量时非常有用，<strong class="je hv"> variableNames </strong>将是字典的键列表:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="906d" class="ln kb hu lj b fv lo lp l lq lr">varDict = LpVariable.dicts("varDict", variableNames, lowBound, upBound)</span></pre><p id="9589" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">因此，根据前面的定义，计算机生产问题的决策变量是我们为每个工厂生产的天数:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="a611" class="ln kb hu lj b fv lo lp l lq lr"># factories<br/>num_factories = 3<br/>factory_days = LpVariable.dicts("factoryDays", list(range(num_factories)), 0, 30, cat="Continuous")</span></pre><h1 id="7e35" class="ka kb hu bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">限制</h1><p id="d198" class="pw-post-body-paragraph jc jd hu je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hn dt translated">既然我们已经定义了我们的决策变量，我们可以转移到定义问题的约束。注意，在线性编程设置中，约束必须是线性的。我们关心的约束条件是装配的单位数量应大于或等于目标数量，以及生产约束条件，即任何工厂的产量都不应超过其他工厂的两倍:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="1deb" class="ln kb hu lj b fv lo lp l lq lr"># goal constraint<br/>c1 = factory_days[0]*f1 + factory_days[1]*f2 + factory_days[2] * f3 &gt;= goal</span><span id="2edf" class="ln kb hu lj b fv mg lp l lq lr"># production constraints<br/>c2 = factory_days[0]*f0 &lt;= 2*factory_days[1]*f1<br/>c3 = factory_days[0]*f0 &lt;= 2*factory_days[2]*f2<br/>c4 = factory_days[1]*f1 &lt;= 2*factory_days[2]*f2<br/>c5 = factory_days[1]*f1 &lt;= 2*factory_days[0]*f0<br/>c6 = factory_days[2]*f2 &lt;= 2*factory_days[1]*f1<br/>c7 = factory_days[2]*f2 &lt;= 2*factory_days[0]*f0</span><span id="127f" class="ln kb hu lj b fv mg lp l lq lr"># adding the constraints to the problem<br/>problem += c1<br/>problem += c2<br/>problem += c3<br/>problem += c4<br/>problem += c5<br/>problem += c6<br/>problem += c7</span></pre><p id="2df2" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">计算机组装问题的目标函数基本上是最小化组装所有这些计算机的成本。这可以简单地写成负成本最大化:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="f9f2" class="ln kb hu lj b fv lo lp l lq lr"># objective function<br/>problem += -factory_days[0]*cf0*f0 - factory_days[1]*cf1*f1 - factory_days[2]*cf2*f2</span></pre><p id="18d7" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">让我们来看一下问题的定义，这可以简单地通过调用:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="4d5c" class="ln kb hu lj b fv lo lp l lq lr">print(problem)</span></pre><p id="144c" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这导致了下面的输出，我认为这是不言自明的，它列出了问题中的目标函数、约束和各种决策变量:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="e639" class="ln kb hu lj b fv lo lp l lq lr">computerAssembly:<br/>MAXIMIZE<br/>-900000*factoryDays_0 + -630000*factoryDays_1 + -400000*factoryDays_2 + 0<br/>SUBJECT TO<br/>_C1: 1500 factoryDays_0 + 1000 factoryDays_1 + 1000 factoryDays_2 &gt;= 80000<br/><br/>_C2: 2000 factoryDays_0 - 3000 factoryDays_1 &lt;= 0<br/><br/>_C3: 2000 factoryDays_0 - 2000 factoryDays_2 &lt;= 0<br/><br/>_C4: 1500 factoryDays_1 - 2000 factoryDays_2 &lt;= 0<br/><br/>_C5: - 4000 factoryDays_0 + 1500 factoryDays_1 &lt;= 0<br/><br/>_C6: - 3000 factoryDays_1 + 1000 factoryDays_2 &lt;= 0<br/><br/>_C7: - 4000 factoryDays_0 + 1000 factoryDays_2 &lt;= 0<br/><br/>VARIABLES<br/>factoryDays_0 &lt;= 30 Continuous<br/>factoryDays_1 &lt;= 30 Continuous<br/>factoryDays_2 &lt;= 30 Continuous</span></pre><h1 id="c010" class="ka kb hu bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">解决</h1><p id="4325" class="pw-post-body-paragraph jc jd hu je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hn dt translated">在我们定义了线性规划问题中的所有必要内容之后，我们可以调用solve方法，如果问题得到解决，则输出1，如果问题不可行，则输出-1，这是一个简单的单行程序:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="0068" class="ln kb hu lj b fv lo lp l lq lr"># solving<br/>problem.solve()</span></pre><p id="33d6" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">问题的解决方案可以通过访问每个变量的varValue属性来获得:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="830a" class="ln kb hu lj b fv lo lp l lq lr">for i in range(3):<br/> print(f"Factory {i}: {factory_days[i].varValue}")</span></pre><p id="8163" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">这会产生以下输出:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="21b5" class="ln kb hu lj b fv lo lp l lq lr">Factory 0: 23.076923<br/>Factory 1: 15.384615<br/>Factory 2: 30.0</span></pre><p id="2262" class="pw-post-body-paragraph jc jd hu je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hn dt translated">在线性规划中，我们假设变量之间的关系是线性的，并且变量本身是连续的。作为本教程的后续，我将介绍混合整数编程，其中变量可以是整数，这将证明是一件非常有用的事情，因为它可以用来模拟布尔逻辑。</p></div></div>    
</body>
</html>