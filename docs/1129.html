<html>
<head>
<title>How to Build a Documentation App With Gatsby and Cosmic JS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Gatsby和Cosmic JS搭建文档App</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/how-to-build-a-documentation-app-with-gatsby-and-cosmic-js-8aed8b0aeaa5?source=collection_archive---------7-----------------------#2019-02-15">https://medium.com/hackernoon/how-to-build-a-documentation-app-with-gatsby-and-cosmic-js-8aed8b0aeaa5?source=collection_archive---------7-----------------------#2019-02-15</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><figure class="ht hu fm fo hv hw fe ff paragraph-image"><div class="fe ff hs"><img src="../Images/7e7267b3bb6c047e885a14665a4e1487.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*eHOT0IlFTpQPEf-Q38I3_w.png"/></div></figure><div class=""/><p id="f4a8" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">文档？…文档。假设你想创造一种方式来轻松地发布和阅读文档，呃…文档。在这篇文章结束时，你将能够做到这一点，所有这些都借助于Gatsby(一个静态站点生成器)和Cosmic JS(一个易于设置和使用的内容管理系统)的力量。喝点咖啡，找把舒服的椅子，让我们做点酷的东西。</p><p id="1090" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><strong class="ja ic"> TL:DR </strong></p><p id="0a3f" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><a class="ae jw" href="https://cosmicjs.com/apps/gatsby-docs" rel="noopener ugc nofollow" target="_blank">盖茨比文档App Demo </a> <br/> <a class="ae jw" href="https://github.com/cosmicjs/gatsby-docs-app" rel="noopener ugc nofollow" target="_blank">查看代码库</a></p><p id="c8b2" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><strong class="ja ic"> 1.0 —简介</strong></p><p id="1ebc" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><strong class="ja ic">什么是</strong> <a class="ae jw" href="https://www.gatsbyjs.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="ja ic">盖茨比</strong> </a>？</p><p id="71e2" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">Gatsby是一个易于使用的生成静态网站文件的框架。它与各种热点捆绑在一起，如用于构建web组件的React JS，以及用于处理组件状态的GraphQL，而无需配置Redux之类的东西来处理外部数据。</p><p id="63f5" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><strong class="ja ic">那</strong> <a class="ae jw" href="https://cosmicjs.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="ja ic">宇宙JS </strong> </a>呢？</p><p id="81ea" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">宇宙JS将处理我们的出版和数据存储。对于这样的应用来说，它很容易设置和实现，而且具有足够的可伸缩性来处理大型团队中更复杂的项目。我们将用它来创建和存储我们的文档内容。这将使我们能够专注于用户如何与我们的应用程序交互，并让Cosmic JS完成所有繁重的工作。</p><p id="870d" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><strong class="ja ic">就这些吗？</strong></p><p id="fe72" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">嗯，不…我们将把我们的文档从markdown转换成html，因为这是网络浏览器喜欢的。为了做到这一点，我们将使用一个名为<a class="ae jw" href="https://play.pokemonshowdown.com/" rel="noopener ugc nofollow" target="_blank">摊牌</a>的包，它可以处理解析和转换markdown与HTML。</p><p id="6c6a" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><strong class="ja ic">有什么要求</strong>？</p><p id="4d9e" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">哦，对了，你需要访问一个终端，一个带有<a class="ae jw" href="https://cosmicjs.com/getting-started" rel="noopener ugc nofollow" target="_blank">桶和文档对象</a>的Cosmic JS帐户，以及一个安装在你机器上的<a class="ae jw" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank">节点JS </a>的最新版本，以便安装必要的软件使这个应用程序工作。我将使用yarn来运行我的构建脚本，但是如果你愿意，你也可以使用npm。只要记住选择一个(npm或yarn)并坚持下去，因为在部署的时候事情会变得有点棘手。</p><p id="3d11" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">我们来建吧！！</p><p id="28a4" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><strong class="ja ic"> 1.1 —建立我们的开发环境</strong></p><p id="8427" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">要开始，我们需要安装Gatsby并安装我们的依赖项。很简单。Gatsby使用方便的命令行界面(CLI)来构建我们的初始项目文件。首先，我们希望通过使用npm全局安装CLI来安装它:</p><p id="7db8" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><code class="eh jx jy jz ka b">$ npm install -g gatsby-cli</code></p><p id="4a95" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">这使我们能够访问“gatsby”命令，并允许我们初始化我们的项目。运行以下脚本，创建一个填充了项目模板的新目录:</p><p id="bd82" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><code class="eh jx jy jz ka b">$ gatsby new gatsby-docs</code></p><p id="d434" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">稍等片刻，让脚本完成，您会注意到创建了一个名为“gatsby-docs”的新目录。让我们通过改变目录来看看里面有什么:</p><p id="c577" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><code class="eh jx jy jz ka b">$ cd gatsby-docs</code></p><p id="5baa" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">您应该会看到类似如下的目录结构:</p><pre class="kb kc kd ke fq kf ka kg kh aw ki dt"><span id="b5da" class="kj kk ib ka b fv kl km l kn ko">. <br/>├── node_modules<br/>├── src<br/>├── .gitignore<br/>├── gatsby-browser.js<br/>├── gatsby-config.js<br/>├── gatsby-node.js<br/>├── gatsby-ssr.js<br/>├── LICENSE<br/>├── package-lock.json<br/>├── package.json<br/>└── README.md</span></pre><p id="667f" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">如果您习惯于创建节点应用程序，您会对其中的大部分内容感到熟悉，但有些内容会有点陌生。通过执行启动脚本，您应该能够启动并运行开发服务器:</p><p id="fbdd" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><code class="eh jx jy jz ka b">$ yarn start</code></p><p id="dd11" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">一秒钟后，您应该会看到一个成功提示，让您知道一切都已正确编译，您的应用程序是活的。</p><p id="5322" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">现在，您可以打开指向“localhost:8000”的浏览器，查看编译后的输出。它应该看起来非常类似于这样:</p><figure class="kb kc kd ke fq hw fe ff paragraph-image"><div class="ab fr cl kp"><img src="../Images/93817bda36cd8cd51e8e94df3c20a04b.png" data-original-src="https://miro.medium.com/v2/format:webp/1*1B3nvdm2tPsiwQbtyGKseg.png"/></div></figure><p id="011b" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">恭喜你。你已经建立了一个工作的盖茨比网站。但是，在我们深入了解幕后发生的事情之前，让我们先安装为我们的应用提供动力的其余依赖项:</p><p id="d52e" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><code class="eh jx jy jz ka b">$ yarn add cosmicjs showdown highlight.js dotenv node-sass gatsby-plugin-sass gatsby-source-graphql</code></p><p id="56a1" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">哇…那是很多新安装的软件包，但是我发誓每个都非常有用。</p><ul class=""><li id="40be" class="kq kr ib ja b jb jc jf jg jj ks jn kt jr ku jv kv kw kx ky dt translated"><code class="eh jx jy jz ka b">cosmicjs</code>将用于向我们的应用程序添加新内容。</li><li id="cd19" class="kq kr ib ja b jb kz jf la jj lb jn lc jr ld jv kv kw kx ky dt translated">是我提到的处理markdown和html转换的文本解析器。</li><li id="b1f4" class="kq kr ib ja b jb kz jf la jj lb jn lc jr ld jv kv kw kx ky dt translated"><code class="eh jx jy jz ka b">highlight.js</code>将在转换后的降价文本中处理语法高亮。</li><li id="ab6a" class="kq kr ib ja b jb kz jf la jj lb jn lc jr ld jv kv kw kx ky dt translated"><code class="eh jx jy jz ka b">dotenv</code>是一个环境变量包，它将确保我们的敏感令牌和/或运行时环境是从`. env '文件配置的</li><li id="d18f" class="kq kr ib ja b jb kz jf la jj lb jn lc jr ld jv kv kw kx ky dt translated"><code class="eh jx jy jz ka b">node-sass</code>和<code class="eh jx jy jz ka b">gatsby-plugin-sass</code>包将允许使用<code class="eh jx jy jz ka b">.scss</code>文件来设计我们的组件。</li><li id="2161" class="kq kr ib ja b jb kz jf la jj lb jn lc jr ld jv kv kw kx ky dt translated"><code class="eh jx jy jz ka b">gatsby-source-graphql</code>将允许我们在外部数据上利用GraphQL查询(即使用Cosmic JS GraphQL api)</li></ul><p id="3f38" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">随着所有这些业务的完成，我们可以查看我们的目录并配置我们的Gatsby源代码以正确运行。</p><p id="b6c7" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><strong class="ja ic"> 2.0 —配置Gatsby </strong></p><p id="6c70" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">现在我们可以深入我们的目录，并确保Gatsby配置正确，可以使用可扩展和合理地支持我们的应用程序的技术。</p><p id="d528" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">我们要查看的第一个文件是<code class="eh jx jy jz ka b">gatsby-config.js</code>。这个文件用于配置高级插件，当我们构建静态文件时，这些插件允许我们编写的任何源代码被正确捆绑。它还包含一些向用户描述我们站点的元数据，可以在我们的React组件中查询。</p><p id="01b3" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">在这里，我们将把新安装的插件添加到你面前的默认配置中。首先，我们只需要将<code class="eh jx jy jz ka b">gatsby-plugin-sass</code>添加到插件列表中，允许我们导入sass文件并利用sass为每个组件编写合理的样式规范。</p><p id="acb6" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">接下来，我们将在<code class="eh jx jy jz ka b">gatsby-source-graphql</code>的插件列表末尾添加一个对象，它将配置我们的外部GraphQL API端点，允许我们从Cosmic JS获取数据。事情应该是这样的:</p><figure class="kb kc kd ke fq hw"><div class="bz el l di"><div class="le lf l"/></div></figure><p id="5652" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">现在我们开始对Cosmic JS GraphQL API进行GraphQL查询！接下来，让我们谈一会儿盖茨比以及事情将如何破裂。</p><p id="9a7a" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><strong class="ja ic"> 2.1用Gatsby构建我们的应用</strong></p><p id="736c" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">我提到过Gatsby是一个静态站点生成器，但是这是什么意思呢？Gatsby采用我们创建的所有花哨代码，并生成使用我们指定的配置文件预先配置的静态文件。通过这样做，我们可以提高站点的性能，这些站点可能有大量的图像、要获取的数据以及其他会降低web应用程序速度的资产。</p><p id="644e" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">现在让我们创建一些源代码。我们的网站将只使用两个“页面”，一个将作为列出我们创建的文档的主页，另一个用于查看文档。但是为了获取我们将要显示的内容，我们将使用我们最近配置的GraphQL。我们需要在我们的<code class="eh jx jy jz ka b">gatsby-node.js</code>文件中添加一些变量，以便让我们的静态文件拥有必要的参数来进行API调用。</p><p id="39fc" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><strong class="ja ic">创建一个. env文件并添加你的Cosmic JS环境变量</strong></p><p id="fba4" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">在你的宇宙JS桶&gt;基本设置菜单中，你会在底部看到一个桶段和读写键。复制所有这三个文件，并将它们添加到一个. env文件中。</p><p id="5c12" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">在项目根目录下，在终端中键入:</p><p id="d7c0" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><code class="eh jx jy jz ka b">$ touch .env</code></p><p id="395e" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">现在创建三行:</p><figure class="kb kc kd ke fq hw"><div class="bz el l di"><div class="le lf l"/></div></figure><p id="be62" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">我们将在dotenv包中使用这些变量，以允许我们的src文件在必要时访问这些变量。</p><p id="9374" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><strong class="ja ic">打开</strong> <code class="eh jx jy jz ka b"><strong class="ja ic">gatsby-node.js</strong></code> <strong class="ja ic">并添加配置变量到页面</strong></p><p id="68ff" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">我们现在将使用Gatsby的内置节点API来为站点中的每个页面提供对我们刚刚创建的环境变量的访问。首先我们将使用dotenv从我们的<code class="eh jx jy jz ka b">.env</code>文件中导入变量，然后我们将在页面的上下文中显式地设置每个变量。您的文件应该如下所示:</p><figure class="kb kc kd ke fq hw"><div class="bz el l di"><div class="le lf l"/></div></figure><p id="5d11" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><strong class="ja ic">创建我们的第一页</strong></p><p id="b0a6" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">现在我们将创建我们的第一个页面，它将获取所有的文档对象，并在我们站点的根目录下显示它们，在<code class="eh jx jy jz ka b">index.js</code>上。首先，让我们通过在组件目录中创建一个名为docs - <code class="eh jx jy jz ka b">/src/components/docs/</code>的文件夹来创建我们的列表，在这个文件夹中，我们将创建一个名为<code class="eh jx jy jz ka b">index.js</code>的文件。</p><p id="2527" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">这将是我们的模块，在获取我们的文档之后，当我们呈现我们的页面<em class="lg">时第一次显示。下面是源代码:</em></p><figure class="kb kc kd ke fq hw"><div class="bz el l di"><div class="le lf l"/></div></figure><p id="612d" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><strong class="ja ic">这里发生了什么:</strong></p><p id="2ee4" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">这个页面基本上在我们的<code class="eh jx jy jz ka b">docs</code>上运行了一个大循环，并返回一些漂亮的jsx。我们通过docs数组进行映射，生成一个来自Gatsby的链接，其中包含标题、日期和一些内容，这些内容使用了对已发布文档的描述。</p><p id="4d11" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">也可以随意将任何<code class="eh jx jy jz ka b">.scss</code>文件添加到这个目录中，以获得适合给定类名的样式。</p><p id="dab2" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><strong class="ja ic">用我们的新组件更新“主页”</strong></p><p id="1938" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">现在我们可以在<code class="eh jx jy jz ka b">/pages/index.js</code>打开我们的主页文件，导入我们刚刚创建的组件，并将它们添加到我们返回的jsx中。</p><figure class="kb kc kd ke fq hw"><div class="bz el l di"><div class="le lf l"/></div><figcaption class="lh li fg fe ff lj lk bd b be z ek">importing our Docs and adding to pages/index.js</figcaption></figure><p id="f9df" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">现在任何在Cosmic JS上创建的<code class="eh jx jy jz ka b">docs</code>，都会出现在这里的主页上！</p><p id="6752" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">请注意文件底部导出的查询。它包含两个字符串类型变量，因为我们在gatsby-node配置中设置了<strong class="ja ic">上下文</strong>对象。</p><p id="cb7c" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">随着我们新创建的主页的工作，让我们创建我们的文档视图，它将显示我们发布的文档的内容。</p><p id="98f7" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><strong class="ja ic">创建我们的单据显示页面</strong></p><p id="a26e" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">我们不是在Gatsby的pages目录中添加一个新文件，而是创建一个“templates”目录，并创建一个我们可以在构建时配置的模板页面，这样每当创建一个文档时，当我们从Cosmic JS获取我们的文档时，就可以创建一个新页面。</p><p id="0795" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">首先在项目根目录下创建一个“templates”目录，然后在其中创建一个<code class="eh jx jy jz ka b">docPage.js</code>文件。</p><pre class="kb kc kd ke fq kf ka kg kh aw ki dt"><span id="fa35" class="kj kk ib ka b fv kl km l kn ko">. ├── _templates <br/>| ├── docPage.js</span></pre><p id="2c1a" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">现在添加带有导出查询的页面模板，该查询将从Cosmic JS获取一个单独的文档。</p><figure class="kb kc kd ke fq hw"><div class="bz el l di"><div class="le lf l"/></div></figure><p id="24e4" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">在我们告诉Gatsby它需要使用这个模板创建一个页面之前，这个模板不会发生任何事情。我们这样做是为了让Gatsby在使用每个GraphQL查询的必要参数在<code class="eh jx jy jz ka b">docPage.js</code>底部构建页面之前，有机会从Cosmic JS获取我们的文档。毕竟我们使用的是静态站点文件。</p><p id="693e" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><strong class="ja ic">更新盖茨比节点建立模板页面</strong></p><p id="e846" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">让我们继续向<code class="eh jx jy jz ka b">gatsby-node.js</code>添加一个导出函数，这样我们就可以从我们的GraphQL数据构建文档页面模板:</p><figure class="kb kc kd ke fq hw"><div class="bz el l di"><div class="le lf l"/></div></figure><p id="b14d" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">现在，当Gatsby创建其页面时，即索引页面将获取我们的文档，并为检索到的每个文档创建一个页面，并将所有必要的参数附加到每个页面的页面内容。通过这种方式，我们的模板组件被呈现，我们的GraphQL查询应该会成功！</p><p id="8877" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><strong class="ja ic"> 3.0部署</strong></p><p id="48e2" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">最后，我们可以谈谈部署和静态站点是如何工作的。部署这个坏男孩可能有点棘手，因为这个站点使用静态构建，在部署服务有机会重建之前，不会有新创建文档的必要页面。</p><p id="1936" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">我的建议是使用<a class="ae jw" href="https://www.netlify.com/" rel="noopener ugc nofollow" target="_blank"> netlify </a>并从GitHub或任何存储代码的地方链接您的源代码。从那里你可以触发buildhooks，以便在特定事件发生时重新构建你的站点。当对象被创建、删除、编辑等时，Cosmic JS将允许在一个端点上触发post请求。所以你可以很容易地将两者联系起来，创造一些奇迹。请记住，如果您希望允许用户在您的UI中创建文档:您将需要手动发出POST请求，以便在成功创建文档时激活buildhook。</p><p id="211a" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated">无论如何，这就是我的全部乡亲！黑客快乐。</p></div><div class="ab cl ll lm hc ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="hn ho hp hq hr"><p id="dc6f" class="pw-post-body-paragraph iy iz ib ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hn dt translated"><em class="lg">最初发表于</em><a class="ae jw" href="https://cosmicjs.com/articles/how-to-build-a-documentation-app-with-gatsby-and-cosmic-js-jrb4den5" rel="noopener ugc nofollow" target="_blank"><em class="lg">cosmicjs.com</em></a><em class="lg">。</em></p></div></div>    
</body>
</html>