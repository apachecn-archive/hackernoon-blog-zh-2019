<html>
<head>
<title>Continuous refactoring — what’s stopping you?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">持续重构——是什么阻止了你？</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/continuous-refactoring-whats-stopping-you-437c71bf94cf#2019-03-06">https://medium.com/hackernoon/continuous-refactoring-whats-stopping-you-437c71bf94cf#2019-03-06</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="251c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在过去的二十年里，我不得不多次处理代码库，这让我的工作变得困难而痛苦。小代码库、大代码库、小公司、大公司、媒体公司、科技公司……它一直跟着我。我们姑且称之为“混乱的代码库”。与其他开发人员谈论这个话题总是会导致人们分享他们自己的经历，就像一种治疗会议。谷歌“坏代码”，你会得到关于这个话题的无尽的结果。所以不仅仅是我。</p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="fe ff jp"><img src="../Images/caacd658ab835349d1b36ab9400a4048.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*67yx2NlYj7zMyT-WILujIA.jpeg"/></div></div><figcaption class="kb kc fg fe ff kd ke bd b be z ek">When your code looks like this, you know you’re in trouble. Photo by <a class="ae kf" href="https://unsplash.com/photos/Kw_zQBAChws?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Ashim D’Silva</a> on <a class="ae kf" href="https://unsplash.com/search/photos/mess?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h2 id="38be" class="kg kh hu bd ki kj kk kl km kn ko kp kq jc kr ks kt jg ku kv kw jk kx ky kz la dt translated">修复代码并不能修复习惯</h2><p id="e755" class="pw-post-body-paragraph ir is hu it b iu lb iw ix iy lc ja jb jc ld je jf jg le ji jj jk lf jm jn jo hn dt translated">Sarah Mei 最近的 Twitter 帖子让我思考为什么混乱的代码库如此普遍。我见过有人通过重写或大规模重构来“修复”代码库。这使得代码库在一段时间内很容易工作，但很快它又开始变得混乱。莎拉将此与<a class="ae kf" href="https://en.wikipedia.org/wiki/Hoarders" rel="noopener ugc nofollow" target="_blank">美国电视节目《囤积者》</a>进行了类比，维基百科称该节目“描述了患有<a class="ae kf" href="https://en.wikipedia.org/wiki/Compulsive_hoarding" rel="noopener ugc nofollow" target="_blank">强迫症</a>的人在现实生活中的挣扎和治疗。”</p><blockquote class="lg lh li"><p id="e918" class="ir is lj it b iu iv iw ix iy iz ja jb lk jd je jf ll jh ji jj lm jl jm jn jo hn dt translated">“你知道为什么《囤积者》不再播出了吗？</p><p id="e16a" class="ir is lj it b iu iv iw ix iy iz ja jb lk jd je jf ll jh ji jj lm jl jm jn jo hn dt translated">事实证明，拖走所有东西和清理房子并不能改变人们囤积居奇的习惯。表演结束后，大多数参与者慢慢回到了一个贮藏屋。</p><p id="e1ef" class="ir is lj it b iu iv iw ix iy iz ja jb lk jd je jf ll jh ji jj lm jl jm jn jo hn dt translated">我们囤积的代码库也是这样工作的。如果你不改变把你带到那一步的习惯和动机，你最终会陷入一片混乱……”</p></blockquote><p id="9779" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">大多数有几年经验的开发人员在看到杂乱的代码库时，能够识别出它们。但是，很难确定公司文化的哪些方面导致代码库通常以混乱告终。莎拉指出了你可以寻找的最明显的迹象:</p><blockquote class="lg lh li"><p id="3bc0" class="ir is lj it b iu iv iw ix iy iz ja jb lk jd je jf ll jh ji jj lm jl jm jn jo hn dt translated">“到目前为止，我所见过的囤积代码库中最常见的“呈现”病理是，开发人员觉得他们没有时间和/或权限来重构代码。”</p></blockquote><p id="25f1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">根据我的经验，我认为这是正确的。我总结一下，公司文化低估了重构的好处。</p><h2 id="595d" class="kg kh hu bd ki kj kk kl km kn ko kp kq jc kr ks kt jg ku kv kw jk kx ky kz la dt translated">为重构提供理由</h2><p id="c0a8" class="pw-post-body-paragraph ir is hu it b iu lb iw ix iy lc ja jb jc ld je jf jg le ji jj jk lf jm jn jo hn dt translated">重构到底有多重要？我会把这个问题留给几个比我聪明得多的人来解释。</p><p id="71b2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">首先出场的，是英国节目“名人”(我的术语)<a class="ae kf" href="https://martinfowler.com/aboutMe.html" rel="noopener ugc nofollow" target="_blank">马丁·福勒</a>。在他关于敏捷和重构的精彩演讲中，他说:</p><blockquote class="lg lh li"><p id="f559" class="ir is lj it b iu iv iw ix iy iz ja jb lk jd je jf ll jh ji jj lm jl jm jn jo hn dt translated">[重构]是整个敏捷思维方式的一个非常核心的技术，因为它符合我们可以以一种容易改变的方式构建软件的整个方式……重构是这一点的核心，因为重构是一种进行改变的有纪律的方式。"</p></blockquote><p id="b8d1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在“<a class="ae kf" href="https://www.amazon.com/Leading-Lean-Software-Development-Results/dp/0321620704" rel="noopener ugc nofollow" target="_blank">领导精益软件开发</a>”中，精益“大师”(可能是我的术语)玛丽和汤姆<a class="ae kf" href="http://www.poppendieck.com/" rel="noopener ugc nofollow" target="_blank">波普迪克</a>不仅仅直言重构的需要，而且直言持续重构<em class="lj">的需要</em>。</p><blockquote class="lg lh li"><p id="bc39" class="ir is lj it b iu iv iw ix iy iz ja jb lk jd je jf ll jh ji jj lm jl jm jn jo hn dt translated">“代码必须保持简单明了，即使开发人员对问题理解得更清楚，问题本身也在发生变化。因此，必须不断地重构代码，以处理通过更深入的理解发现的或由最新变化引入的任何重复或歧义。越来越多的工具可以用来帮助重构，但是工具通常不是这里的问题。重要的是，开发人员必须期望重构成为他们工作的正常部分。像持续测试一样，持续重构也不是可选的。”</p></blockquote><p id="5c6a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">由于敏捷和精益实践，持续测试的概念如今似乎相当普遍。而是连续的<em class="lj">重构</em>？我不太确定。</p><p id="421e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我曾在一些团队中工作过，在这些团队中，重构对开发人员来说是很自然和正常的。我在更多没有这种情况的团队中工作过。回到 Sarah Mei——她谈到“习惯和激励”是重构缺失的原因，这是对什么是文化的一个很好的描述。</p><h2 id="025c" class="kg kh hu bd ki kj kk kl km kn ko kp kq jc kr ks kt jg ku kv kw jk kx ky kz la dt translated">反重构文化</h2><p id="0ca8" class="pw-post-body-paragraph ir is hu it b iu lb iw ix iy lc ja jb jc ld je jf jg le ji jj jk lf jm jn jo hn dt translated">从我个人的经验来看，我已经确定了这种反重构文化的四个不同方面，从最专制的方面开始。</p><ol class=""><li id="4462" class="ln lo hu it b iu iv iy iz jc lp jg lq jk lr jo ls lt lu lv dt translated">明确的预防措施<br/>赶上截止日期或大量生产特性的需要意味着开发人员被告知要请求重构许可，而这很少被准许。重构任务通常被允许为将来的优先化而创建，但是这些任务很少被完成。开发人员可能会到处进行偷偷摸摸的重构，这似乎与他们所做的更改密切相关。</li><li id="792a" class="ln lo hu it b iu lw iy lx jc ly jg lz jk ma jo ls lt lu lv dt translated">在赫曼·乔姆斯基的(新闻)宣传模式中，“高射炮火”被描述为“试图诋毁不同意或怀疑主流假设的组织或个人”。虽然没有人明确地告诉开发人员不要重构，但是完成重构任务需要开发人员付出大量的努力和勇气，因为这违背了文化。开发人员可能会被要求为重构的需要提供过多的理由。重构可能会被挑出来作为延迟的原因，而不是被视为解决方案的重要部分。</li><li id="1f10" class="ln lo hu it b iu lw iy lx jc ly jg lz jk ma jo ls lt lu lv dt translated">分析瘫痪<br/>当一个代码库已经非常混乱时，重构似乎是徒劳的——整理一部分代码会有什么帮助呢？或者，架构如此混乱，以至于在其他地方提高代码质量并不能解决这个巨大的架构问题。也许从哪里开始有太多的选择，所以人们绕着圈子试图找到从哪里开始，而不是仅仅开始。</li><li id="dc3d" class="ln lo hu it b iu lw iy lx jc ly jg lz jk ma jo ls lt lu lv dt translated">缺乏开发者经验<br/>有时候有一种鼓励开发者重构的文化，但是他们就是不去重构，因为他们不能识别混乱的代码。缺乏技术领导力意味着没有人帮助这些开发人员学习如何识别混乱的代码。</li></ol><h2 id="96da" class="kg kh hu bd ki kj kk kl km kn ko kp kq jc kr ks kt jg ku kv kw jk kx ky kz la dt translated">实施文化变革</h2><p id="4092" class="pw-post-body-paragraph ir is hu it b iu lb iw ix iy lc ja jb jc ld je jf jg le ji jj jk lf jm jn jo hn dt translated">我们在这里讨论的是围绕创造持续重构文化的需求和挑战。文化变革往往需要“自上而下”。以下是关于这种情况如何发生的一些想法:</p><ul class=""><li id="ce27" class="ln lo hu it b iu iv iy iz jc lp jg lq jk lr jo mb lt lu lv dt translated">首先，管理层/领导层需要明确重构的需求及其带来的好处，为变革创造愿景。</li><li id="454f" class="ln lo hu it b iu lw iy lx jc ly jg lz jk ma jo mb lt lu lv dt translated">其次，经理/领导层需要给开发人员自主权，让他们根据需要进行重构，而不会因此受到指责。事实上，重构应该得到公开的赞扬，以显示与愿景的一致。</li><li id="32e0" class="ln lo hu it b iu lw iy lx jc ly jg lz jk ma jo mb lt lu lv dt translated">第三，需要给开发者学习和提高技能的机会。他们需要确信自己能够识别混乱的代码，并有关于如何重构代码的策略。</li><li id="3943" class="ln lo hu it b iu lw iy lx jc ly jg lz jk ma jo mb lt lu lv dt translated">最后，一旦愿景清晰并被理解，赞扬是公开的，开发人员拥有自主权和技能— <em class="lj">然后</em>经理需要让开发人员对重构团队的工作质量负责。</li></ul><p id="4b4f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这是一条漫长的道路，但文化变革不会在一夜之间发生。</p><p id="d6eb" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">你觉得你的团队重构得足够了吗？你认同上面的一些或所有反重构的原因吗？听听那些成功扭转了反重构文化的人的观点会很有趣。</p></div></div>    
</body>
</html>