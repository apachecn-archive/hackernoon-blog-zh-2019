<html>
<head>
<title>Computer Vision for Busy Developers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">忙碌开发者的计算机视觉</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/cv-for-busy-developers-convolutions-5c984f216e8c?source=collection_archive---------6-----------------------#2019-06-19">https://medium.com/hackernoon/cv-for-busy-developers-convolutions-5c984f216e8c?source=collection_archive---------6-----------------------#2019-06-19</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="5efe" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">回旋</p><p id="f0c1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jp">本文是向开发者介绍</em> <strong class="it hv"> <em class="jp">计算机视觉</em> </strong> <em class="jp">系列的一部分。查看本系列</em> <a class="ae jq" rel="noopener" href="/@vad710/computer-vision-for-busy-developers-6a7320222da"> <em class="jp">其他文章</em> </a> <em class="jp">。</em></p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="fe ff jr"><img src="../Images/8707559df13e5959e606dba68d7f95c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*yVYBhyMeecug-uPB"/></div></div><figcaption class="kd ke fg fe ff kf kg bd b be z ek">Photo by <a class="ae jq" href="https://unsplash.com/@shawnsfields?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Shawn Fields</a> on <a class="ae jq" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="226c" class="kh ki hu bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le dt translated">卷积和核</h1><p id="5b9d" class="pw-post-body-paragraph ir is hu it b iu lf iw ix iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo hn dt translated">当我们讨论<a class="ae jq" rel="noopener" href="/@vad710/cv-for-busy-developers-image-processing-d93ed4836880">图像处理</a>时，我们一次分析一个像素，并针对一个常量值对其进行操作(乘/减)。然后，我们试图根据一个<a class="ae jq" rel="noopener" href="/@vad710/cv-for-busy-developers-thresholds-and-templates-15d660694c38">模板imag </a> e来寻找对象，这是一个将滑动窗口中的一组像素与模板图像中的一组恒定像素进行比较的过程。我们现在要探索两者之间的空间。我们将着眼于图像区域内相邻像素的关系。我们将基于一个较小的恒定像素组来分析图像。这一小组像素是一个3×3或5×5的小图像，称为由简单矩阵表示的核心。可以将这种方法想象成使用一个非常小的图像模板，大小为3x3或5x5像素，而不是更大的图像模板。例如，我们之前使用的月亮模板是226x213像素大。</p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="fe ff lk"><img src="../Images/4a05a1a460b1e42496b2316faf2f2cfe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jtwjopLCJWljXIFDkRAGtg.png"/></div></div><figcaption class="kd ke fg fe ff kf kg bd b be z ek">Think of a Kernel as a much smaller Template Image that is 3x3 Pixels large (Template Image Source: <a class="ae jq" href="https://www.pexels.com/photo/full-moon-746111/" rel="noopener ugc nofollow" target="_blank">Samer Daboul</a>)</figcaption></figure><p id="0a0a" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们将深入研究一项在计算机视觉中极其重要的技术。这种基本技术被称为卷积。一个<strong class="it hv">卷积</strong>是通过使用滑动窗口将一个像素及其相邻像素的颜色值乘以一个内核来完成的。卷积和内核操作像素不仅基于像素本身的值，还基于特定像素的紧邻像素(有时称为<strong class="it hv">连接像素</strong>或<strong class="it hv">邻居</strong>)。卷积是另一种类型的图像滤波器，在阅读这些主题时，这些术语经常互换使用。</p><h1 id="3f62" class="kh ki hu bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le dt translated">虚化</h1><p id="e625" class="pw-post-body-paragraph ir is hu it b iu lf iw ix iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo hn dt translated">我们将首先看看两个流行的内核卷积模糊图像。<strong class="it hv">框模糊</strong>(有时称为均值或平均模糊)，查看图像的每个像素，并用其周围所有像素的平均值替换其值。在我们的例子中，我们将使用一个简单的3×3矩阵核，其中所有的值都是1。盒子模糊内核:</p><pre class="js jt ju jv fq ll lm ln lo aw lp dt"><span id="f21a" class="lq ki hu lm b fv lr ls l lt lu">[1, 1, 1]<br/>[1, 1, 1]<br/>[1, 1, 1]</span></pre><p id="1675" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">虽然上面的内核非常简单，但它将帮助我们理解卷积是如何工作的。在这个卷积中，因为矩阵值都是1，所以每个窗口的结果是中心像素及其邻居的平均值。因为我们使用的是滑动窗口，所以我们不能在线更新像素值(否则会影响下一次窗口移动)。我们用对应于核中心的位置处的平均值来更新新图像。</p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="fe ff lv"><img src="../Images/19a4c638064529eb11cfd5d997fad1d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*ptkQvYLjOrXXvP7BrKG0lA.gif"/></div></div><figcaption class="kd ke fg fe ff kf kg bd b be z ek">The Box Blur is an example of a convolution. It uses a sliding window the size of the kernel to calculate the average of a neighborhood of pixels.</figcaption></figure><p id="f6f0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">使用滑动窗口，卷积将处理图像中的所有像素。一旦卷积完成，我们的新图像将出现模糊。</p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="fe ff lw"><img src="../Images/0e6d1ec5200c27ac7f3247a046810641.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*PzSEqByMOkM_XfwYPGwrDg.gif"/></div></div><figcaption class="kd ke fg fe ff kf kg bd b be z ek">Convolutions generate a new image once the sliding window is complete</figcaption></figure><p id="3b7e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">在上面的动画中，请注意值为8和9的像素。与图像中的所有其他像素相比，这两个像素尤其是离群值。这些像素从其余像素中脱颖而出。卷积后，这些像素值被替换为109和95，使这些值与邻居更加一致。</p><blockquote class="lx ly lz"><p id="8722" class="ir is jp it b iu iv iw ix iy iz ja jb ma jd je jf mb jh ji jj mc jl jm jn jo hn dt translated">旁注:在动画中还可以看到，最靠近边缘的像素没有在卷积中计算。我见过用三种不同方式处理这些边框像素的例子。这些像素可以被丢弃，可以从原始像素中保留，或者可以计算可用像素的平均值。</p></blockquote><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="fe ff lk"><img src="../Images/ade5c6b853cbfd873fb4a8d1220d95ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DUut28QltnpM2d3MAQQhGw.png"/></div></div><figcaption class="kd ke fg fe ff kf kg bd b be z ek">Original Image Source: <a class="ae jq" href="https://www.pexels.com/photo/man-standing-on-pier-911085/" rel="noopener ugc nofollow" target="_blank">Simon Migaj</a></figcaption></figure><p id="d01c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">正如我们在上面看到的，框模糊的结果是通过使像素更像它们的邻居来“平滑”图像，从而产生模糊的图像。</p><h1 id="3f5c" class="kh ki hu bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le dt translated">高斯模糊</h1><p id="674b" class="pw-post-body-paragraph ir is hu it b iu lf iw ix iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo hn dt translated">另一个值得讨论的模糊核是高斯模糊核。我们给予内核中的每个像素不同的权重，而不是直接平均像素周围的所有值。我们给中心像素最高的优先级，给离中心最远的像素较低的优先级。因此，使用高斯内核的模糊往往看起来不那么“方方正正”。下面是一个简单易读的3×3高斯核的例子:</p><pre class="js jt ju jv fq ll lm ln lo aw lp dt"><span id="ae0c" class="lq ki hu lm b fv lr ls l lt lu">[1, 2, 1]<br/>[2, 4, 2]<br/>[1, 2, 1]</span></pre><p id="4833" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">高斯核的卷积与长方体模糊核相同。把盒子模糊想象成除以内核值的总和，总共是9。在上面说明的高斯内核中，内核值的总和是16。</p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="fe ff lv"><img src="../Images/99888d6c97b979a25d98ecd1121f7a9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*t3FyQ5PyBzc4mWQGvxO1Wg.gif"/></div></div><figcaption class="kd ke fg fe ff kf kg bd b be z ek">The Gaussian convolution is identical to the Box Blur — we just use a different set of kernel values</figcaption></figure><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="fe ff md"><img src="../Images/3116bbe95fa8ba9204fc24ec4a9c1492.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5ELk4MmHhAphpSa_eUBe4A.png"/></div></div><figcaption class="kd ke fg fe ff kf kg bd b be z ek">For comparison, here are the results of both a Box and Gaussian Blur. (Original Image Source: <a class="ae jq" href="https://www.pexels.com/photo/toucan-bird-parrot-17811/" rel="noopener ugc nofollow" target="_blank">Carlos Spitzer</a> )</figcaption></figure><p id="315b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">作为一个快速的可视化练习，让我们也比较一下如果我们在2D图中绘制它们，方框模糊和高斯模糊核看起来会是什么样子。</p><figure class="js jt ju jv fq jw fe ff paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="fe ff lk"><img src="../Images/f29f34af04ba05bc03ca0bb55028d774.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rkGNQ2PKvG2PFI4c1wew5g.png"/></div></div><figcaption class="kd ke fg fe ff kf kg bd b be z ek">The Box Blur and Gaussian Blur Kernel values graphed in 2D — we can see how Box Blur gets its name and how the Gaussian Blur gives priority to the center pixels</figcaption></figure><p id="b1c7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">上面展示的高斯核是一个非常简单的核，包含简单的整数。高斯核的具体权重可以基于核的大小(曲线的宽度)和强度(曲线的高度)来计算。虽然我们如何获得高斯核的大小和值的具体数学方法超出了这些文章的意图，但需要指出的是，高斯核的计算取决于sigma值，sigma值是一个描述高斯曲线平滑度的数字(标准偏差，对于数学书呆子来说)。也就是说，sigma表示内核中心的数字与内核边缘的数字之间的关系。当我们稍后讨论高斯特征检测器的<strong class="it hv">差异时，我们将再次讨论sigma的重要性。现在，考虑sigma将代表高斯核平滑图像的程度。西格玛越大，模糊越强。</strong></p><h1 id="973a" class="kh ki hu bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le dt translated">其他内核</h1><p id="7da1" class="pw-post-body-paragraph ir is hu it b iu lf iw ix iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo hn dt translated">有很多很多不同的核用于卷积。另一个流行的内核是锐化内核，它增加了相邻像素之间的对比度——与我们在本文中看到的模糊正好相反。</p><p id="499c" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当涉及到计算机视觉时，卷积和核出现了很多。在本系列的稍后部分，我们将在讨论卷积神经网络等机器学习技术时再次讨论卷积。在下一篇文章中，我们将使用卷积来寻找图像的边缘。</p><blockquote class="lx ly lz"><p id="0ca8" class="ir is jp it b iu iv iw ix iy iz ja jb ma jd je jf mb jh ji jj mc jl jm jn jo hn dt translated"><strong class="it hv">旁注:</strong>熟悉卷积的读者会注意到我们直接进入了2D卷积。做出这个决定是为了引导读者将内核视为微小的图像，并与我们已经讨论过的其他主题进行比较——比如模板。沿着这条路，希望实现卷积的开发人员绝对应该研究1D卷积。有些情况下，2D卷积可以分解成两个独立的1D卷积，从而优化算法的速度。</p></blockquote><h1 id="59e9" class="kh ki hu bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le dt translated">TLDR</h1><p id="01ac" class="pw-post-body-paragraph ir is hu it b iu lf iw ix iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo hn dt translated">卷积是一个过程，其中我们使用滑动窗口技术基于像素本身及其邻居对像素进行操作。我们使用核来定义卷积中使用的值。盒子和高斯模糊是我们研究的卷积的例子。“方框”和“高斯”模糊使每个像素更像其相邻像素，从而导致像素“平滑”并模糊图像的外观。</p><h1 id="c4cf" class="kh ki hu bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le dt translated">来源和更多信息</h1><ul class=""><li id="0c61" class="me mf hu it b iu lf iy lg jc mg jg mh jk mi jo mj mk ml mm dt translated"><a class="ae jq" href="http://setosa.io/ev/image-kernels/" rel="noopener ugc nofollow" target="_blank">直观解释图像内核</a>—Victor Powerll的文章</li><li id="54be" class="me mf hu it b iu mn iy mo jc mp jg mq jk mr jo mj mk ml mm dt translated"><a class="ae jq" href="http://web.pdx.edu/~jduh/courses/Archive/geog481w07/Students/Ludwig_ImageConvolution.pdf" rel="noopener ugc nofollow" target="_blank">图像卷积</a> —杰米·路丁的演讲</li><li id="21af" class="me mf hu it b iu mn iy mo jc mp jg mq jk mr jo mj mk ml mm dt translated">平滑化——罗伯特·柯林斯的演讲</li><li id="72df" class="me mf hu it b iu mn iy mo jc mp jg mq jk mr jo mj mk ml mm dt translated"><a class="ae jq" href="https://www.youtube.com/watch?v=C_zFhWdM4ic" rel="noopener ugc nofollow" target="_blank">模糊滤镜如何工作&amp;</a>—电脑爱好者视频</li><li id="de14" class="me mf hu it b iu mn iy mo jc mp jg mq jk mr jo mj mk ml mm dt translated"><a class="ae jq" href="https://en.wikipedia.org/wiki/Box_blur" rel="noopener ugc nofollow" target="_blank">框模糊</a> —维基百科</li><li id="a7db" class="me mf hu it b iu mn iy mo jc mp jg mq jk mr jo mj mk ml mm dt translated"><a class="ae jq" href="https://en.wikipedia.org/wiki/Gaussian_blur" rel="noopener ugc nofollow" target="_blank">高斯模糊</a> —维基百科</li></ul><figure class="js jt ju jv fq jw"><div class="bz el l di"><div class="ms mt l"/></div></figure></div></div>    
</body>
</html>