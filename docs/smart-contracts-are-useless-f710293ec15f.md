# 智能合同毫无用处

> 原文：<https://medium.com/hackernoon/smart-contracts-are-useless-f710293ec15f>

![](img/59720be5c5a23761daaef0edf994ef50.png)

Photo by [rawpixel](https://unsplash.com/@rawpixel?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral)

# 智能合约背后的想法已经有二十多年的历史了，但智能合约只是在过去五年里随着以太坊及其 Solidity 编程语言的发布才成为一个主要的话题。

在 2017 年的大部分时间里，你无法为承诺使用智能合同来彻底改变我们交易和做生意的方式的 ICOs 所动，而密码领域仍然充斥着解释即将到来的[智能合同革命](https://blockchainmagazine.net/the-smart-contract-revolution-is-coming/)的文章，智能合同将如何颠覆从[物流](/@credits/how-blockchain-could-help-logistics-c3b2ab60be55)到[房地产](/ethereum-dapp-builder/smart-contracts-and-the-real-estate-59e3dfdb5d2c)的一切，将使各地的[律师失业](https://qz.com/459009/the-technology-behind-bitcoin-could-replace-lawyers-too/)，并使人类合同法几千年的发展过时。

但现在是 2019 年，智能合约给我们带来了什么？无尽的 ERC20 代币和[假猫繁殖](https://www.cryptokitties.co/) …

这对 ico 和 CryptoKitties 来说有点苛刻，它们不可否认地重要，至少作为概念的证明。但是还有什么呢？人们承诺的数十亿美元、扰乱市场的生意在哪里？改变人生的 dApps 在哪里？在迄今为止编写的所有以太坊 dApps 中，[只有 10%在某一天被使用](https://www.longhash.com/news/ten-percent-of-ethereum-dapps-are-used-on-any-given-day)。EOS dApps 的表现稍好一些，[但只有不到 5%的用户拥有超过 2000 的日活跃用户](https://www.longhash.com/news/over-50-of-eos-dapps-are-used-on-any-given-day-compared-to-10-of-eth-dapps)。

事实是，智能合约毫无用处，而且在可预见的未来将继续毫无用处。它们一点也不聪明——它们是能力有限的哑程序，只能访问存储在区块链上的数据，不能与外界对话。气喘吁吁的密码专家声称，所有的合同都只是嵌套的 IF-THEN 语句的花哨链，所以很明显它们可以用机器语言复制，他们还没有理解什么使合同有用，它们如何以及为什么工作，以及为什么会出现问题和争议。

我们是如何走进这条死胡同的，我们应该做些什么呢？

首先，让我们来看看智能合同是如何工作的，然后我会解释为什么他们*不能以任何有意义的方式工作。*

# 智能合约是如何工作的？

智能合约是要求每个区块链节点定期运行的小型计算机程序。节点无法控制智能协定执行的指令，因此不应该信任它对运行该节点的机器的资源的完全访问权。

由于缺乏控制，区块链项目配备了*虚拟机* (VMs)，专注于安全执行智能合同。虚拟机充当*沙箱*，防止智能合约对主机造成严重破坏。每个虚拟机运行一组非常有限的指令，也称为*字节码*，包括每个智能契约(例如算术运算符、区块链事务等)。).自然，这意味着与本机运行的机器代码相比，智能合约的功能非常有限。

智能合约也不能被允许永远运行，无限期地占用主机的资源。智能合约是别人家的客人，最终必须离开。不幸的是，计算理论的[最著名的结果之一](https://en.m.wikipedia.org/wiki/Halting_problem)意味着不可能知道你的普通智能合约是否会停止运行，所以虚拟机求助于计算字节代码并迫使智能合约在某个点停止。这是确保智能合约停止而不进一步限制功能的唯一方法，但这使得它们实际使用起来非常讨厌。

你是一个聪明的合同所有者吗？您是否支付了足够的费用来部署智能合同？没有吗？那么你的合同会在执行过程中终止。即使你很小心，天然气价格一直在波动，所以不可能合理地预算运行合同的成本。

问题不仅限于车主。块获胜者用智能合同执行的结果更新区块链，并得到块奖励和交易费的补偿。但是网络的其余部分必须运行相同的智能契约来检查这些执行结果，而没有任何回报。你是没有争取到块签权的节点运营商吗？不幸的是，您仍然需要浪费计算周期来执行智能合同。不，你不会得到报酬的！

人们经常争论说，许多或大多数现实世界的契约都可以表达为 IF-THEN 语句的集合。*如果*满足某些条件，*则*处理合同的适当条款。*如果*我收到 100BTC，*然后*转让我房子的所有权。*如果*客户没有在约定的日期归还您的租赁汽车，*然后*进行罚款。如果-那么语句是计算机的面包和黄油，区块链让我们在一个不可信的环境中运行这些程序，那么我们为什么要为一个律师每小时支付 200 美元呢？

这听起来很有说服力，但这是卑鄙的花招。律师和公证人以及数千年的法律机构不仅仅是一个笨拙的输入/输出处理系统。验证现实世界的条件是否得到满足，然后就这种验证达成一致，这是一个极其困难的问题，而智能合约恰恰让我们无法解决这个问题。

想象一下:假设你的契约如何解决取决于它执行的时间。这似乎是合理的，对不对？但是区块链没有客观的时间来源。因此，您的智能合约需要访问外部时间服务。调用时间服务返回精确到毫秒的当前时间，然后用于执行约定。该合同执行的结果随后被添加到区块链中。

但是因为结果被添加到区块链中，所以所有节点必须对它们达成一致。这是维护区块链共识的重要组成部分。但是请记住，每个节点都在自己的虚拟机中独立运行这些合同。因此，它们都在稍微不同的时间访问时间服务，并且接收稍微不同的时间戳。因此，当需要验证下一个块时，智能契约执行的结果对于每个节点都是不同的。

(说我们不关心毫秒级的精度是没有用的，让我们直接四舍五入到最近的秒、分、小时等等。随着成千上万的节点在不同的时间访问相同的服务，舍入决策之间的差异不可避免地会下降到毫秒，并且您会回到相同的问题。)

无论你如何摇摆，节点永远不会同意彼此和区块链永远不会达成共识。

# 进入神谕

由于智能合约无法访问外部世界，因此必须将外部世界带入智能合约。一些实体可以将外部世界的数据放到区块链上，使其可用于网络上运行的所有未来智能合约。这些实体被称为*神谕*。

但这并不能真正帮助我们。在我们使用之前，数据需要在链上，但是我们如何知道我们将需要什么数据呢？我们不能把生活中的每个事实都塞进区块链。所有现代区块链都已经饱受通货膨胀之苦。

所以神谕局限于对现实世界非常狭隘的看法。但是问题并没有就此结束。即使我们同意对少数数据源使用 oracles，这些数据也会随着时间的推移而演变。每次这样做时，oracle 都必须向区块链添加更多数据。旧数据经常变得过时，但它仍保留在链上。想想上面提到的时间服务，在保存所有事务历史的区块链上包含时间戳是多么不可思议的浪费。

# 神谕必须支付

先知需要将数据放在区块链上的激励——他们想要得到报酬。但是甲骨文不像区块链验证者，他们因为维护区块链而获得持续的回报:一旦甲骨文把数据放到区块链，任何人都可以访问这些数据。oracle 开发人员无法控制数据将被访问的次数，这可能会将单次支付分散到数千或数百万次智能合约调用中，并将每次访问的支付减少到极小的数量。这降低了先知提供真正有价值信息的动机。

# 神谕必须被信任

智能合约应该是不可信的，但这只适用于它们受到区块链共识不可信本质的束缚。一旦他们离开区块链的沙盒，信任的元素就被引入了。智能合同开发人员和用户必须相信 oracle 能够提供真实准确的信息。缺乏适当的甲骨文激励措施会助长提供垃圾数据的欺诈甲骨文的泛滥。这样的 oracle 希望在智能合同开发人员意识到数据是垃圾并停止使用 oracle 之前，从某人那里至少收取一笔费用。

区块链开发者可以通过在他们的平台中建立一个声誉系统来防止甲骨文欺诈的瘟疫。但是，没有什么能阻止狡猾的 oracle 开发人员在转向提供陈旧或垃圾数据并免费收取费用之前，通过提供一些有价值的答案来建立声誉。社会污名不会转化为机器代码！

你也不能通过从多个先知那里获得答案，并对它们进行交叉检查或平均来回避这个问题。依赖多个神谕来寻找答案增加了安全性，降低了对单个神谕答案的信任需求，但很快就演变成了一个区块链共识问题。把它想象成*甲骨文共识问题*。另外，尚未解决的 oracle 激励问题变得越来越糟糕！

神谕既要因提供正确答案而受到激励，也要因提供错误信息而受到惩罚。需要在不同神谕所提供的答案中就一个真正的答案达成共识，并且这种机制需要对智能契约开发者来说使用起来便宜，否则将不会被使用。如果不引入信任的元素，所有这些事情都是不可能的，如果你准备这么做，那你为什么还要和区块链鬼混呢？我们有许多历史悠久的基于信任的系统，这些系统要便宜得多，使用起来也简单得多。

# 你吃什么就是什么

但或许你对智能合约的雄心并不那么远大。区块链和智能合同被提议作为简化物流的一种方式，通过跟踪货运并沿着供应链全程跟踪原材料和产品。

比方说，自动跟踪橙子从农场到我们的水果盘，似乎是计算机擅长的那种单调乏味的工作。但是，当货物到达时，使用智能合同自动支付也会遇到同样的信任问题。我们仍然需要相信一个人，以确保橙子处于良好状态，并将正确的数据输入系统，该系统将把数据放在区块链上。我们还需要信任一些外部系统来正确验证橙子是否到达。这里当然有一些审计的好处，但是它仍然离人们在 ICO 繁荣时期所向往的自动化天堂有十亿英里远。

# 智能合约没有任何力量

这是 IF-THEN 语句的 IF 部分。那么呢？事实证明那里的情况也没有好转。智能合约没有权力统治外部世界；他们只能对数字资产进行裁决。当然，你可以将你的房子令牌化，在区块链出售，并试图通过智能合同收取抵押贷款付款，但智能合同将无法在不付款的情况下代表你收回房子。智能合同也无法访问政府登记处来更新房屋所有权。所以你仍然需要律师、公证人、政府和法警，以及我们已经使用了几千年的整个杂乱无章的基于信任的机构。

# 死胡同

而这只是理论上的问题。实用性也是一场噩梦。尽管智能合同被定位为纸质合同的简单替代品，但人们在书写和保护它们方面绝对糟糕。由于智能合同中的漏洞和缺陷，数十亿美元已经丢失和被盗。

简而言之，智能合约试图解决错误的问题。他们正在考虑如果-然后决定重要的部分是破折号。

真正聪明的合同是我们已经使用了几个世纪的合法合同。我们不需要电脑来处理这些合同——我们有最好的电脑来翻译它们。我们可以利用法院来裁决这些合同，并利用政府的权力来执行这些合同。

但是抱怨够多了。希望我已经让你相信聪明合约只不过是一条骗人的死胡同。但是我们应该做些什么呢？

# 区块链上的自治代理

智能合约毫无用处，但区块链仍是一项不可思议的创新。分散式分类账方便了[三重分录会计](http://iang.org/papers/triple_entry.html)，也就是众所周知的[过去 500 年里所有人都错过的最重要的发明](https://hackernoon.com/why-everyone-missed-the-most-important-invention-in-the-last-500-years-c90b0151c169)。可以把区块链看作是一个总分类账，所有的交易都输入到这个总分类账中，其它的内部系统也从这个总分类账中更新。

与其试图让区块链号进入外部世界，不如让我们集中精力做相反的事情。与可以直接访问区块链的应用程序相比，智能合约的功能相形见绌。分布式账本和共识是实现 web、移动和其他类型的应用程序的伟大机制，这种应用程序我们已经编写和部署了很长时间。

我们已经非常擅长利用现有硬件的全部能力来构建计算机应用程序。缺少的一环是如何让应用程序以一种各方都可以信任的方式进行秘密和安全的通信，而不必支付一些集中的权力来管理(无疑也是监视)程序。我们真正需要的是一个分散的*消息总线*，这些应用程序可以用它来进行通信。我们正在 Stegos 构建这样一个消息总线，它是我们用于构建隐私应用的[平台的一部分](https://github.com/stegos/stegos)。

隐写术将使未来成为可能，智能自主代理使用区块链进行私下和保密的通信。在以后的文章中，我将解释这是如何工作的，以及为什么它如此重要。与此同时，[请通过 Telegram](https://t.me/stegos4privacy) 加入我们，关注我们的进展！

*原载于 2019 年 2 月 22 日*[*【stegos.com*](https://stegos.com/blog/2019/02/smart-contracts-are-useless/)*。*