<html>
<head>
<title>Improving your unit tests with help from the X-Men</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在x战警的帮助下改进你的单元测试</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/improving-your-unit-tests-with-help-from-the-x-men-a4eef1e50f25?source=collection_archive---------12-----------------------#2019-02-05">https://medium.com/hackernoon/improving-your-unit-tests-with-help-from-the-x-men-a4eef1e50f25?source=collection_archive---------12-----------------------#2019-02-05</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><figure class="fi fk is it iu iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/669470d3be81c5cd251c0adff6ac5650.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*pvWhWopUsDmUqwDL"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">Photo by <a class="ae jg" href="https://unsplash.com/@happilyabstract?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Lena Rose</a> on <a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="bd9e" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">如果我告诉你x战警可以让你成为一名更好的软件测试员，你会怎么想？他们不能，但是他们的超级恶棍威廉·史崔克可以。</p><p id="9161" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">这篇文章是关于如何使用突变测试来改进你的单元测试。有几个突变测试框架，但我将谈论的框架被称为<a class="ae jg" href="https://stryker-mutator.io/" rel="noopener ugc nofollow" target="_blank"> Stryker </a>，这是以x战警中想要杀死所有变种人的超级恶棍命名的。我使用Stryker已经两年多了，在这两年中，我在三个大型企业项目中实施了Stryker，并就该框架做了几次演示。</p><h2 id="94b4" class="kf kg hu bd kh ki kj kk kl km kn ko kp js kq kr ks jw kt ku kv ka kw kx ky kz dt translated">小心！</h2><p id="33c5" class="pw-post-body-paragraph jh ji hu jj b jk la jm jn jo lb jq jr js lc ju jv jw ld jy jz ka le kc kd ke hn dt translated">我想以一个警告开始这篇文章，突变测试不适合心脏虚弱的人。首先，它是乏味的，耗时的，并且经常拖延开发的测试阶段，经常需要开发人员编写更多的单元测试。为什么还要为此烦恼呢？因为这是确保单元测试真正提供价值的万无一失的方法。</p><p id="3da9" class="pw-post-body-paragraph jh ji hu jj b jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke hn dt translated">每个开发人员都见过这样的单元测试，它看起来很棒，但实际上并不测试任何东西，或者只是为了提供代码覆盖率而存在。这些是突变测试暴露的测试。这是单元测试中的佼佼者，命运的选择，任何摇滚明星测试人员都不是真正的摇滚明星，除非他们有突变测试来检查他们的单元测试。既然你已经被警告了，让我们进入细节。</p><figure class="lf lg lh li fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ir"><img src="../Images/7bc999268dd8540c77fc888c212d4f9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*mMa3Yv5Qd4F2wxx5"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">Photo by <a class="ae jg" href="https://unsplash.com/@mayank_dimri?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">MAYANK D</a> on <a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="dcc7" class="lj kg hu bd kh lk ll lm kl ln lo lp kp lq lr ls ks lt lu lv kv lw lx ly ky lz dt translated">什么是突变测试？</h1><p id="0840" class="pw-post-body-paragraph jh ji hu jj b jk la jm jn jo lb jq jr js lc ju jv jw ld jy jz ka le kc kd ke hn dt translated">简单的一句话回答是<em class="ma">突变测试是为你的单元测试</em>而测试。这是什么意思？变异测试是通过一个框架完成的，比如Stryker，它会变异或改变代码的特定部分，并检查这种变异是否会导致单元测试失败。如果突变体导致您现有的一个单元测试失败，那么这个突变体就被认为是“被杀死”了。在突变测试结束时，会生成一个报告，其中包含被杀死和幸存的突变体的完整列表，类似于您在使用Jest或Jasmine的代码覆盖报告中看到的内容。</p><h2 id="d008" class="kf kg hu bd kh ki kj kk kl km kn ko kp js kq kr ks jw kt ku kv ka kw kx ky kz dt translated">简单的例子</h2><p id="e4e9" class="pw-post-body-paragraph jh ji hu jj b jk la jm jn jo lb jq jr js lc ju jv jw ld jy jz ka le kc kd ke hn dt translated">假设您有一些为应用程序生成URL的代码。希望有一个单元测试来检查URL路径并确保它被生成。变异测试框架会进来，把你的端点变异成一个null或空字符串。你的单元测试会发生什么？如果失败了，那很好，这意味着你的测试足够聪明，知道URL应该是什么，变异体将被认为被杀死。如果你的单元测试没有失败，这意味着你的单元测试没有你想象的那么好。框架会将突变体列为存活的，你需要回到绘图板去写一个更好的单元测试。下面是一个字符串突变的例子:</p><pre class="lf lg lh li fq mb mc md me aw mf dt"><span id="ff70" class="kf kg hu mc b fv mg mh l mi mj">String url = "deadpool.com"<br/>goTo(url)</span><span id="9fcf" class="kf kg hu mc b fv mk mh l mi mj">//mutated code<br/>String url = ""<br/>goTo(url)</span></pre><h1 id="3f3e" class="lj kg hu bd kh lk ll lm kl ln lo lp kp lq lr ls ks lt lu lv kv lw lx ly ky lz dt translated">突变测试框架</h1><p id="53a7" class="pw-post-body-paragraph jh ji hu jj b jk la jm jn jo lb jq jr js lc ju jv jw ld jy jz ka le kc kd ke hn dt translated">Stryker 是一个开源突变测试框架，有一个非常活跃的开发社区。两年前我开始使用Stryker时，该框架仅适用于JavaScript，但多年来它一直在不断发展，现在可用于JavaScript、TypeScript、Scala和C#。它有一个CLI工具可用于快速简单的设置，并且可以很好地与Jasmine和Jest等常见测试框架配合使用。我也使用过Java的<a class="ae jg" href="http://pitest.org/" rel="noopener ugc nofollow" target="_blank"> PIT Test </a>，突变测试的概念是一样的，但是框架更加基于控制台。虽然每个突变测试框架可能略有不同，但概念是相同的，重要的是开始使用一个。</p><figure class="lf lg lh li fq iv fe ff paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="fe ff ml"><img src="../Images/cc1d03716ae21a573daf9cdfbb3d7017.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*M-xtcP1gRll-RIUs"/></div></div><figcaption class="jc jd fg fe ff je jf bd b be z ek">Photo by <a class="ae jg" href="https://unsplash.com/@sapegin?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Artem Sapegin</a> on <a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="11db" class="lj kg hu bd kh lk ll lm kl ln lo lp kp lq lr ls ks lt lu lv kv lw lx ly ky lz dt translated">变异测试利弊</h1><p id="c31a" class="pw-post-body-paragraph jh ji hu jj b jk la jm jn jo lb jq jr js lc ju jv jw ld jy jz ka le kc kd ke hn dt translated">当第一次开始使用突变测试的过程将会非常缓慢。杀死某些变种人可能很困难，而且不得不重写单元测试也不是什么有趣的事情。随着时间的推移，好处是值得的，就像生活中的任何事情一样，你练习得越多，这个过程就会变得越快。</p><h2 id="3270" class="kf kg hu bd kh ki kj kk kl km kn ko kp js kq kr ks jw kt ku kv ka kw kx ky kz dt translated">专业的</h2><ul class=""><li id="4942" class="mm mn hu jj b jk la jo lb js mo jw mp ka mq ke mr ms mt mu dt translated">更高质量的单元测试</li><li id="526d" class="mm mn hu jj b jk mv jo mw js mx jw my ka mz ke mr ms mt mu dt translated">不要再编写毫无意义的测试，这些测试只是为了提高一个度量标准(比如代码覆盖率)</li><li id="cfbf" class="mm mn hu jj b jk mv jo mw js mx jw my ka mz ke mr ms mt mu dt translated">对您的应用程序经过全面测试更有信心</li><li id="e11f" class="mm mn hu jj b jk mv jo mw js mx jw my ka mz ke mr ms mt mu dt translated">更少的生产缺陷</li><li id="71af" class="mm mn hu jj b jk mv jo mw js mx jw my ka mz ke mr ms mt mu dt translated">捕捉到更多虫子</li><li id="8852" class="mm mn hu jj b jk mv jo mw js mx jw my ka mz ke mr ms mt mu dt translated">开发人员有机会收到关于他们单元测试质量的即时反馈</li><li id="e31f" class="mm mn hu jj b jk mv jo mw js mx jw my ka mz ke mr ms mt mu dt translated">Stryker并行运行，因此如果资源可用，它可以运行得非常快</li></ul><h2 id="2dc9" class="kf kg hu bd kh ki kj kk kl km kn ko kp js kq kr ks jw kt ku kv ka kw kx ky kz dt translated">骗局</h2><ul class=""><li id="ae45" class="mm mn hu jj b jk la jo lb js mo jw mp ka mq ke mr ms mt mu dt translated">在开发周期中增加一个额外的步骤</li><li id="9015" class="mm mn hu jj b jk mv jo mw js mx jw my ka mz ke mr ms mt mu dt translated">在具有四个或更少内核的机器上运行大型代码库可能需要一个多小时</li><li id="cba8" class="mm mn hu jj b jk mv jo mw js mx jw my ka mz ke mr ms mt mu dt translated">如果CLI生成的配置不适合您的项目，那么配置可能很难确定</li></ul><h1 id="af08" class="lj kg hu bd kh lk ll lm kl ln lo lp kp lq lr ls ks lt lu lv kv lw lx ly ky lz dt translated">结论</h1><p id="8604" class="pw-post-body-paragraph jh ji hu jj b jk la jm jn jo lb jq jr js lc ju jv jw ld jy jz ka le kc kd ke hn dt translated">在开发人员中，突变测试似乎仍然很少见，但希望这篇文章鼓励任何阅读的开发人员尝试一下。设置可能会很慢，杀死第一批变种人可能需要很长时间，但是杀死的变种人越多，这个过程就会变得越快。除了金刚狼提供单元测试辅导之外，Stryker和mutation testing是你能找到的最接近x战警改进单元测试的方法。</p></div></div>    
</body>
</html>