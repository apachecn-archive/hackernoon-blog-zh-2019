<html>
<head>
<title>5 easy wins to refactor even the ugliest code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">重构最丑陋的代码的 5 个简单胜利</h1>
<blockquote>原文：<a href="https://medium.com/hackernoon/5-easy-wins-to-refactor-even-the-ugliest-code-3c7874b2f1b4#2019-07-20">https://medium.com/hackernoon/5-easy-wins-to-refactor-even-the-ugliest-code-3c7874b2f1b4#2019-07-20</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="b104" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当您开始一个新项目时，编写干净的代码可能是一个挑战。尝试在不破坏任何东西的情况下清理现有应用程序中的代码与此类似:</p><figure class="jp jq jr js fq jt"><div class="bz el l di"><div class="ju jv l"/></div></figure><p id="bb91" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我已经做了几年技术主管，在那段时间里，我看到了我必须维护或者扩展的大量代码。通过许多令人沮丧的小时和十几只橡皮鸭，我已经开发了一些提示和技巧来帮助重构甚至是最丑陋的代码库。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div class="fe ff jw"><img src="../Images/d9e04ddd9643280edeedaa9ab4816026.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*7A1YR-iUmQ1Vf3tkVKLgFw.jpeg"/></div><figcaption class="jz ka fg fe ff kb kc bd b be z ek">Me at every code review. Credit to <a class="ae kd" href="http://t.co/2NyO6aPDXs" rel="noopener ugc nofollow" target="_blank">angry-developer.org</a></figcaption></figure><p id="5ade" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我列出了 5 个快速成功的例子，你可以应用于任何代码库，或者当你开始一个新项目时记住它们。</p><p id="a0b3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">每一次胜利都以一个糟糕的代码样本开始，然后是一个好的代码样本，并解释了发生了什么变化。</p><h2 id="76ad" class="ke kf hu bd kg kh ki kj kk kl km kn ko jc kp kq kr jg ks kt ku jk kv kw kx ky dt translated">1)没有不变的方法</h2><p id="11e1" class="pw-post-body-paragraph ir is hu it b iu kz iw ix iy la ja jb jc lb je jf jg lc ji jj jk ld jm jn jo hn dt translated">如果不管传入什么，一个方法总是返回完全相同的东西，那么这个方法可以被认为是无用的。</p><p id="94e2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">正如您在示例<strong class="it hv">中看到的那样，不变方法不良 ts </strong>，<em class="le">获取名称</em>将总是返回完全相同的“未找到名称”消息。</p><p id="38ae" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">我们在<strong class="it hv">不变方法 good.ts </strong>方法中通过简单地返回我们想要的结果来解决这个问题。</p><p id="7444" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">看到这里的要点👉<a class="ae kd" href="https://gist.github.com/mlevkovsky/2c8e972972fed8ac1d908668e5ee0b7f" rel="noopener ugc nofollow" target="_blank">https://gist . github . com/mlevkovsky/2c8e 972972 fed 8 ac1d 908668 E5 ee 0 b 7 f</a></p><figure class="jp jq jr js fq jt"><div class="bz el l di"><div class="lf jv l"/></div></figure><h2 id="46a7" class="ke kf hu bd kg kh ki kj kk kl km kn ko jc kp kq kr jg ks kt ku jk kv kw kx ky dt translated">2)没有神奇的数字或字符串</h2><p id="f37a" class="pw-post-body-paragraph ir is hu it b iu kz iw ix iy la ja jb jc lb je jf jg lc ji jj jk ld jm jn jo hn dt translated">幻数和字符串是硬编码的值，你可以在你的代码中找到它们。如果不小心的话，你将会在你的整个代码库中重复完全相同的值，这将会使你的代码修改、调试和测试成为一场噩梦。</p><p id="1ee2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">正如你在下面的<em class="le"> magic-strings-bad.ts </em>中看到的，我们的方法中有一个硬编码的字符串。在它下面的文件中，<em class="le"> magic-strings-good.ts，</em>我们通过将它重构为私有的只读类变量修复了这个问题。</p><p id="cc34" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">看到这里的要点👉<a class="ae kd" href="https://gist.github.com/mlevkovsky/845f572f7af6b6f71f78e16b124cdb89" rel="noopener ugc nofollow" target="_blank">https://gist . github . com/mlevkovsky/845 f 572 f 7 af 6 b 6 f 71 f 78 e 16 b 124 CDB 89</a></p><figure class="jp jq jr js fq jt"><div class="bz el l di"><div class="lf jv l"/></div></figure><p id="99a0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">关于幻数和字符串，一个很好的问题是“我应该把它们放在哪里？”。下面是我决定把它们放在哪里的方法:</p><ol class=""><li id="0c75" class="lg lh hu it b iu iv iy iz jc li jg lj jk lk jo ll lm ln lo dt translated">值只在一个文件中吗？👉文件顶部的一个常数</li><li id="c5b3" class="lg lh hu it b iu lp iy lq jc lr jg ls jk lt jo ll lm ln lo dt translated">该值是否在多个文件中使用？👉对常数进行逻辑分组的特定枚举类</li><li id="0d37" class="lg lh hu it b iu lp iy lq jc lr jg ls jk lt jo ll lm ln lo dt translated">是应用程序启动时使用的值(例如，api url、超时阈值…)👉属性文件</li></ol><p id="24b0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv"> 3)最后保留默认条款</strong></p><p id="83c1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">switch 语句可以包含一个 default 子句来处理意外值。考虑到您最有可能在一个代码库上协同工作，遵循约定来简化交流是很重要的。</p><p id="8b45" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">考虑到下面的例子，仅仅是将默认条款一直移到底部就已经为你的同行们省去了很多挫败感。</p><p id="fea9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">看到这里的要点👉<a class="ae kd" href="https://gist.github.com/mlevkovsky/4811ec0255783cda2e7fe9cd0c82d9ba" rel="noopener ugc nofollow" target="_blank">https://gist . github . com/mlevkovsky/4811 EC 0255783 CDA 2 e 7 Fe 9 CD 0 c 82 d9 ba</a></p><figure class="jp jq jr js fq jt"><div class="bz el l di"><div class="lf jv l"/></div></figure><p id="cdf6" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv"> 4)清理你多余的变量</strong></p><p id="fa62" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">当你根本不需要实例化一个变量的时候，请保持警惕。冗余变量会占用内存，扰乱代码，增加调试和添加新功能的难度。尽量让你的代码保持整洁。在下面的例子中，很明显我们不需要每次都创建一个 BackgroundImage 的实例，只需为每种情况赋值即可。</p><p id="e95f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">看到这里的要点👉<a class="ae kd" href="https://gist.github.com/mlevkovsky/17a768152f2ca13962fab1c1a05a13b9" rel="noopener ugc nofollow" target="_blank">https://gist . github . com/mlevkovsky/17a 768152 F2 ca 13962 fab 1c 1a 05 a 13 b 9</a></p><figure class="jp jq jr js fq jt"><div class="bz el l di"><div class="lf jv l"/></div></figure><p id="b373" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv"> 5)忘记其他，如果你能回来</strong></p><p id="36bd" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">保持代码整洁的一个重要概念是圈复杂度。圈复杂度基本上就是你在我们的代码中嵌套了多少循环、条件或函数调用。非常高的圈复杂度使得代码几乎无法理解。如果情况失控，你肯定需要一打橡皮鸭。</p><p id="a5fe" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">让我们通过从 switch 语句到一系列整齐的 if 来简化上面的例子。</p><p id="ed2e" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">看到这里的要点👉<a class="ae kd" href="https://gist.github.com/mlevkovsky/7a6ad06b3b18bbd07758a42ca121c23d" rel="noopener ugc nofollow" target="_blank">https://gist . github . com/mlevkovsky/7 a6ad 06 B3 b 18 bbd 07758 a 42 ca 121 c 23d</a></p><figure class="jp jq jr js fq jt"><div class="bz el l di"><div class="lf jv l"/></div></figure><p id="b9b5" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">最后一个例子使逻辑流程非常简单。没有可供选择的流程，你必须绘制出来，一切都非常简单，变得更容易消化。</p><p id="f412" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">这就是你要的，5 个简单的技巧，你可以应用到几乎任何代码库。</p><p id="3cbd" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">如果你想提高你的编码技能，我正在整理一本剧本，包括:</p><p id="93de" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">1.30 多种常见的代码气味&amp;如何解决它们</p><p id="fd56" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">1.15+设计模式实践&amp;如何应用它们</p><p id="aca3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">1.20 多个常见的 JS 错误&amp;如何防止它们</p><p id="8187" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">免费提前获取<a class="ae kd" href="https://javascriptplaybook.com/" rel="noopener ugc nofollow" target="_blank">干净代码行动手册</a>。</p></div></div>    
</body>
</html>